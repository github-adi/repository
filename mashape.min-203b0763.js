(function(){Mashape.Mode=Mashape.CONSTANTS.PRODUCTION_MODE,Mashape.utils.mixin(_.str.exports()),Mashape.Observe=function(e){var t=jQuery({});return jQuery.each({on:0,one:0,off:0,trigger:"emit"},function(n,a){e[a?a:n]=function(){return t[n].apply(t,arguments),e}}),e},Mashape.Events=new function(){Mashape.Observe(this)},Mashape.showLoader=function(e){return $(e).html(Mashape.CONSTANTS.LOADING_FRAGMENT)},$(document).on("click",".dropdown-menu a",function(e){$(".dropdown").removeClass("open")}),$(".dropdown-menu input").add(".dropdown-menu nav a").click(function(e){e.stopPropagation()}),Davis.redirect=function(e,t,n,a){Mashape.Router._callback="function"==typeof a?a:null,Davis.location.replace(new Davis.Request({method:"get",fullPath:e,title:t||"Mashape",redirect:!0}),n)},Davis.removeHooks=function(e,t,n,a){Mashape.Router._callback="function"==typeof a?a:null,Davis.location.replace(new Davis.Request({method:"get",fullPath:e,title:t||"Mashape"}),n)},void 0===jQuery.when.all&&(jQuery.when.all=function(e){var t=new jQuery.Deferred;return $.when.apply(jQuery,e).then(function(){t.resolve(Array.prototype.slice.call(arguments))},function(){t.fail(Array.prototype.slice.call(arguments))}),t})}).call(this),function(){var e,t,n,a,i=function(e){var t={};t.scope=function(e,t,n){i.mapping.push({type:"scope",namespace:e,method:t,priority:n||5})},t.add=function(e,t){i.mapping.push({type:"default",method:e,priority:t||5})},t.priority=function(e){return{add:function(n){return t.add(n,e)},scope:function(n,a){return t.scope(n,a,e)}}},t.priority.high=1,t.priority.normal=5,t.priority.low=10,e.call(t)};i.statusPageCache={},i.mapping=[],i.abort=function(){clearTimeout(n),i.currentRequest.abort(),NProgress.set(.1),NProgress.done()},i.getStatusPage=function(e){function t(){$(".page").html(i.statusPageCache[e])}return i.statusPageCache[e]?t():void jQuery.get("/status/"+e).fail(function(n){i.statusPageCache[e]=$($(n.responseText)[1]).html(),t()})},i.Partial=function(t,n,a){var o;return n?"function"==typeof n&&(a=n,n=t,t=null):n={},t&&t.isForPageLoad?(e=!1,"function"==typeof a?a(!0):void 0):(o=$(i.element||n.element||n.el||"body > .page"),i.currentRequest&&1===i.currentRequest.readyState&&(i.currentRequest.abort(),NProgress.set(.1)),i.currentRequest=Mashape.api.get({url:n.url||t.fullPath,headers:$.extend({contentType:"text/html"},n.headers)}),i.currentRequest.done(function(e){window.analytics&&window.analytics.page(),o.html(e);var n=o.find(".meta.title");return n=n.length?n.data("title"):"Mashape",$("head title").text(n),i.Partial.after(t),Mashape.Router._callback&&(Mashape.Router._callback(),Mashape.Router._callback=null),"function"==typeof a&&a()}),void i.currentRequest.fail(function(e){if("abort"!==e.statusText.toLowerCase()){if(401===e.status)window.location="/logout";else{if(404!==e.status&&403!==e.status)throw new Error({message:"Error loading current request.",xhr:e});i.getStatusPage(n.notFoundView||404)}i.abort()}}))},i.Partial.showLoader=function(){return e?Mashape.log.debug("waiting for partial to load"):(t=!1,Mashape.utils.abortRequests(),i.teardown&&"function"==typeof i.teardown&&i.teardown(),i.teardown=null,$(Mashape.Router.$loading?Mashape.Router.$loading:".content").html(Mashape.CONSTANTS.LOADING_FRAGMENT),NProgress.start(),clearTimeout(n),void(n=setTimeout(function(){return t?clearTimeout(n):void NProgress.set(.5)},1e3)))},i.Partial.before=function(e){var t,n;return a!==e.path||e.raw&&e.raw.redirect||e.queryString?(t=e.path.split("/"),n=-1!==Mashape.CONSTANTS.STATIC_ROUTES.indexOf(t[t.length-1]),!e||e.isForPageLoad||n||i.Partial.showLoader(),void(a=e.path)):!1},i.Partial.after=function(n){e=!1,t=!0,NProgress.done(),details_shim(),Mashape.Router.$loading=null,Mashape.Events.emit("partial.loaded",n)},i.System=function(){function e(e,t){return t.unshift(e),t}function t(t){t.base=function(){t.get.apply(t,e("",Array.prototype.slice.apply(arguments))),t.get.apply(t,e("/",Array.prototype.slice.apply(arguments)))}}function n(e){e.init=Mashape.Section().init}var a=this;this.settings.generateRequestOnPageLoad=!0,this.before(i.Partial.before);for(var o=Mashape.utils.sortBy(i.mapping,function(e){return e.priority}),r=0;r<o.length;r++){var s=o[r];switch(s.type){case"scope":var l=a;t(l),n(l),a.scope.apply(l,[s.namespace,s.method]);break;case"default":s.method.apply(a)}}},Mashape.Router=i}.call(this),function(){var e={init:function(e,t){var a=this;return Mashape.utils.isObject(e)&&(t=e,e=void 0),Mashape.utils.isObject(t)||(t={}),function(i,o){return"string"==typeof e&&(i.params.page=e),t.forceReload&&!i.isForPageLoad?window.location.reload():(Mashape.Router.teardown=a.teardown,void Mashape.Router.Partial(i,{el:t.el||void 0,notFoundView:t.notFoundView},function(){a.elements&&a.elements instanceof n&&a.elements._list&&a.elements.grabElements(),"function"==typeof o&&o(i,o)}))}},_setupRoutes:function(){var t=this;"function"==typeof t.routing&&Mashape.Router(function(){return t.routing.call(this,function(n,a){return e.init.call(t,n,a)})})}},t=function(){var t=arguments[0]||{},n=$.extend({},e,t);return n._setupRoutes(),n},n=function(e){return this._list=e,this};n.prototype.grabElements=function(e){return e?this.add(this._list[e],this._list[e]):this.add(this._list),this},n.prototype.add=function(e,t){for(var n in e)e.hasOwnProperty(n)&&("string"==typeof e[n]?((t?t:this)[n]=e[n],(t?t:this)["$"+n]=$(e[n])):"[object Function]"===Object.prototype.toString.call(e[n])?(t?t:this)[n]=e[n]:"[object Object]"===Object.prototype.toString.call(e[n])&&((t?t:this)[n]={},this.add(e[n],(t?t:this)[n])));return this};var a=function(e){return new n(e)};Mashape.Section=t,Mashape.Elements=a}.call(this),function(){var e=function(e,t){return t=t||{},this.options=$.extend(!0,{},$.fn.MAlert.defaults,t),this.$element=$(e),this.$alert=$('<div class="alert fixed"></div>'),this.options.message&&("string"==typeof this.options.message?this.$alert.html(this.options.message):"object"==typeof this.options.message&&(this.options.message.html?this.$alert.html(this.options.message.html):this.options.message.text&&this.$alert.text(this.options.message.text))),this.options.position&&this.$alert.addClass(this.options.position),this.options.type&&this.$alert.addClass("alert-"+this.options.type),this};e.prototype.onHide=function(){this.visible=!1,this.options.onHide()},e.prototype.onClose=function(){this.visible=!1,this.options.onClose(),$(this.$alert).remove(),this.options.onComplete()},e.prototype.show=function(){""!==this.$alert.text()&&(this.options.fade.enabled&&this.$alert.delay(this.options.fade.delay||3e3).fadeOut(this.options.fade.speed,$.proxy(this.onHide,this)),this.$element.append(this.$alert),this.$alert.alert(),this.visible=!0)},e.prototype.hide=function(){return this.options.fade.enabled?this.$alert.delay(this.options.fade.delay||3e3).fadeOut(this.options.fade.speed,$.proxy(this.onHide,this)):(this.$alert.hide(),void this.onHide())},e.prototype.close=function(){return this.options.fade.enabled?this.$alert.delay(this.options.fade.delay||3e3).fadeOut(this.options.fade.speed,$.proxy(this.onClose,this)):void this.onClose()},$.fn.MAlert=function(t){return new e(this,t)},$.fn.MAlert.defaults={type:"success",position:"top-right",message:null,fade:{enabled:!0,delay:3e3,speed:"slow"},onHide:function(){},onClose:function(){},onComplete:function(){}},Mashape.Alert=e}.call(this),function(){Mashape.Cards||(Mashape.Cards={});var e=505,t=115,n=function(e){var t=this;return e=e||{},t.$el=$(n.wrapper),t.$loader=$(Mashape.CONSTANTS.LOADING_FRAGMENT),Mashape.template(n.template,function(){t.init(e)}),t};n.template="User/Dashboard/api",n.wrapper='<div class="panel panel-default block api overview"></div>',n.link=function(e){return e.account=e.account||e.owner,["/",e.account.slugifiedPrimary||e.account.name,"/",e.slugifiedName||e.slugifiedPrimary||e.name].join("")},n.prototype.init=function(a){var i=this,o=new Ractive({el:i.$el[0],template:Mashape.template(n.template),data:{id:a.id,slugifiedName:a.slugifiedPrimary||"",name:a.name||"",owner:a.owner,"public":"PUBLIC"===a.visibility,logo:a.logo||Mashape.utils.logos.api(a),developers:a.links&&a.links.developers?a.links.developers.total:0,results:[],graphType:"line",graph:{type:"requests",precision:Mashape.Store("dashboard.apis.precision",{defaultValue:Mashape.CONSTANTS.DEFAULT_PRECISION}).get(),environment:Mashape.Store("dashboard.analytics.environment",{cache:"forever",defaultValue:"production"}).get(),width:e,height:t},noResults:function(){return i.ractive.get("results").length>0},"private":function(e){return"private"===e?"icon-lock with-margin":""}}});i.events=a.events||{},i.$el.attr("data-filter","api").attr("data-name",a.name),i.ractive=o,i.watch(),i.graph()},n.prototype.watch=function(){var e=this;Mashape.Events.on("dashboard.graphType.selected",function(t,n){n.selected!==e.ractive.get("graph.type")&&(e.ractive.set("graph.type",n.selected),e.graph())}),Mashape.Events.on("dashboard.filter.selected",function(t,n){("all"===n||"api"===n)&&e.graph(!0)})},n.prototype.graph=function(){var e=this.ractive.get("graph");new Mashape.Graph.Overview(this.$el.find(".graph"),{chart:{width:e.width,height:e.height,events:this.events}}).renderApiGraph({api:this.ractive.get("id"),account:this.ractive.get("owner"),type:e.type,precision:e.precision},function(){Mashape.Events.emit("dashboard.card.ready")})},Mashape.Cards.Api=n}.call(this),function(){Mashape.ApiTerms=function(){var e=Mashape.Elements({form:"form.api-terms",textarea:'form.api-terms [name="terms"]',bannerSuccess:".alert.alert-success",bannerDelete:".alert.alert-danger.terms-remove",templateContainer:"#api-terms .modal-body"}),t={},n=null,a=function(n){return e.grabElements(),t.terms=n.tos,t.noTermsYet="undefined"==typeof n.tos,this.initRactive({apiVersion:n,terms:t.terms}),this};return a.prototype.initRactive=function(a){window.terms=n=new Ractive({el:e.templateContainer,template:$("#api-terms-tpl").html(),data:{deleteModal:!1,api:a.apiVersion.api,isOwner:a.apiVersion.api.isOwner,terms:a.terms,helpers:{markdown:function(e){return marked(e)}}}}),e.grabElements(),n.get("isOwner")&&(new Mashape.FormComponent(e.form).on("submit",function(e,t){this.postOrUpdateTerms(a.apiVersion,e.serialized.terms).always(t)}.bind(this)).on("success",function(a){t.noTermsYet=!1,n.set("terms",a),e.$bannerSuccess.fadeIn(),setTimeout(function(){e.$bannerSuccess.fadeOut()},5e3)}.bind(this)),this.attachHandlers())},a.prototype.postOrUpdateTerms=function(e,n){var a=t.noTermsYet?"post":"patch";return Mashape.api[a]({url:e.links.tos.href,data:{text:n}})},a.prototype.attachHandlers=function(){_.each(a.handlers,function(e,t){"object"==typeof e?n.on(t,function(t,n){"function"==typeof e[n]&&e[n].apply(a,arguments)}):"function"==typeof e&&n.on(t,e)})},a.handlers={deleteModal:{toggle:function(e){n.toggle("deleteModal")}},terms:{"delete":function(t,a){Mashape.api["delete"]({url:t.context.terms.links.self.href}).done(function(t){n.set({"terms.text":void 0,deleteModal:!1}),e.$textarea.val(""),e.$bannerDelete.fadeIn(),setTimeout(function(){e.$bannerDelete.fadeOut()},5e3)})}}},a}()}.call(this),function(){Mashape.Cards||(Mashape.Cards={});var e=495,t=80,n=5,a=function(e){e=e||{};var t=this;return t.$el=$(a.wrapper),t.$loader=$(Mashape.CONSTANTS.LOADING_FRAGMENT),t.graph={},t.options=e,Mashape.template(a.template,function(){t.init(e)}),t};a.template="User/Dashboard/application",a.wrapper='<div class="panel panel-default block app overview" data-driver="div-dashboard-app"></div>',a.link=function(e,t){return e.account=e.account||e.owner||{},t&&(t.account=t.account||t.owner||{}),"/"+(e.account.slugifiedPrimary||e.account.name)+"/applications/"+(e.slugifiedPrimary||e.name)+(t?"/apis/"+t.account+"/"+t.slugifiedPrimary:"")},a.prototype.init=function(t){var n=this;t.account=t.account||t.owner||{};var i=new Ractive({el:n.$el[0],template:Mashape.template(a.template),data:{id:t.id,name:t.name,owner:t.account.name,logo:t.logo||Mashape.utils.logos.app(t,"small"),apis:t.apis&&$.isArray(t.apis.data)?t.apis.data:[],graph:{type:"requests",precision:Mashape.Store("dashboard.apps.precision",{defaultValue:Mashape.CONSTANTS.DEFAULT_PRECISION}).get(),environment:Mashape.Store("dashboard.analytics.environment",{cache:"forever",defaultValue:"all"}).get(),width:e},uptime:function(e){return(100-4*Math.random()).toFixed(2)+"%"},status:function(e){return e=100-5*Math.random(),parseInt(e)>97?"icon-check-sign":"icon-bug"},apiLink:function(e){return"/"+e.account.name+"/"+e.name},apiLogo:function(e){return"/"+e.account.name+"/"+e.name+"/logo"},appLink:function(){return a.link(t)}}});n.$el.attr("data-filter","app").attr("data-name",t.name),n.ractive=i,n.watch(),n.renderApiGraphs()},a.prototype.watch=function(){var e=this;Mashape.Events.on("dashboard.graphType.selected",function(t,n){n.selected!==e.ractive.get("graph.type")&&(e.ractive.set("graph.type",n.selected),e.consumedAPIs())}),Mashape.Events.on("dashboard.apps.precision",function(t,n){e.ractive.set("graph.precision",n.precision),e.consumedAPIs()})},a.prototype.renderApiGraph=function(e){var a=this.$el.find('[data-name="/'+e.account.name+"/"+e.name+'"] .graph'),i=this.ractive.get("graph");new Mashape.Graph.Overview(a,{chart:{width:i.width/2-n,height:t}}).renderApplicationApiGraph({account:this.ractive.get("owner"),application:this.ractive.get("id"),api:e.id,environment:"all",precision:i.precision},function(){Mashape.Events.emit("dashboard.card.ready")})},a.prototype.renderApiGraphs=function(){function e(e){t.renderApiGraph(e.api)}var t=this,n=t.ractive.get("apis");Mashape.utils.each(n,e)},Mashape.Cards.Application=a}.call(this),function(){Mashape.CardForm=function(){var e=".errors",t="hidden",n=function(e){this._init.apply(this,arguments)};return n.prototype._init=function(e){this.formSelector=e,this.events={success:function(){}},this._initHandler(),this._initValidator()},n.prototype._initHandler=function(){var n=this,a=Mashape.client.stripeKeys();a.done(function(e,t,n){Stripe.setPublishableKey(e.key)}),a.fail(function(e,t){console.warn("Failed to load stripe credentials")});var i=new Mashape.FormComponent(this.formSelector,{namespace:".settings"});i.on("submit",function(a,i){var o=a.serialized,r=o.expiry;delete o.expiry,r=$.payment.cardExpiryVal(r),o.exp_month=r.month,o.exp_year=r.year,$(n.formSelector).find(e).addClass(t),Stripe.createToken(o,function(e,t){return t.error?(console.info("Error obtained from Stripe"),n.handleError(t.error.message),i({errors:t.error})):(console.info("Starting billing update to backend.",t),void Mashape.client.updateSettings("billing",t).always(i))})}),i.on("success",function(e,t){return e.errors?void 0:n.events.success.call(n,e)}),i.on("error",function(e,t){n.handleError(e.error.message),console.info("Error obtained from backend.")})},n.prototype._initValidator=function(){$(this.formSelector+' input[name="number"]').payment("formatCardNumber"),$(this.formSelector+' input[name="expiry"]').payment("formatCardExpiry");var n={number:"CardNumber",expiry:"CardExpiry"};$(document).on("keyup.settings",this.formSelector+" input",Mashape.utils.bufferInput(function(a){var i=$(this),o=i.parents(".form-group"),r=i.parents("form"),s=i.serializeObject(),l=Object.keys(s)[0],c=s[l],p="validate"+n[l],u=$(this.formSelector+" button.submit");return o.removeClass("has-error"),r.find(e).addClass(t),"function"==typeof $.payment[p]?"expiry"===l?(c=$.payment.cardExpiryVal(c),void($.payment[p](c.month,c.year)?u.removeAttr("disabled"):(u.attr("disabled","disabled"),o.addClass("has-error")))):void($.payment[p](c)?u.removeAttr("disabled"):(o.addClass("has-error"),u.attr("disabled","disabled"))):void 0},1e3,{ignoreTab:!0}))},n.prototype.on=function(e,t){return this.events[e]=t,this},n.prototype.handleError=function(n){$(this.formSelector).find(e).removeClass(t).text(n)},n}()}.call(this),function(){var e=function(e,t){return this.type=e,this.options=t,this.events={submit:t.submit||function(){}},this.build()};e.prototype.buildTemplate=function(e){var t={confirm:'<div class="modal fade confirm-modal" id='+(this.options.id||"")+' tabindex="-1" role="dialog" aria-hidden="true" data-driver="modal-confirm"><div class="modal-dialog"><div class="modal-content"><form class="confirm-form"><div class="modal-header"><h4 class="modal-title">'+(this.options.title||"Are you sure?")+'</h4></div><div class="modal-body">'+(this.options.message||"")+"<p>Type the name of your "+this.options.confirmEntity+' to confirm this action:</p><input type="text" name="confirm" spellcheck="false" autocomplete="off"></input></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button><button type="submit" class="btn btn-danger btn-confirm" disabled="disabled">'+(this.options.confirm||"Yes")+"</button></div></form></div></div></div>",prompt:'<div class="modal fade prompt-modal" id="prompt-modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">'+(this.options.title||"Are you sure?")+'</h4></div><div class="modal-body"><p>'+this.options.message+'</p></div><div class="modal-footer"><a class="btn btn-success" data-dismiss="modal" data-confirm="true">Yes</a><a class="btn btn-default" data-dismiss="modal" data-confirm="false">No</a></div></div></div></div>',alert:'<div class="modal fade prompt-modal" id="prompt-modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">'+this.options.title+'</h4></div><div class="modal-body"><p>'+this.options.message+'</p></div><div class="modal-footer"><a class="btn btn-primary" data-dismiss="modal" data-confirm="true">Ok</a></div></div></div></div>'};return t[e]},e.prototype.build=function(){var e=this,t=this.buildTemplate(this.type);return $("body").append(t),"confirm"===this.type?(this.$confirmModal=$("#"+this.options.id),new Mashape.FormComponent("#"+this.options.id+" .confirm-form",{handleButtonState:!1}).on("submit",e.events.submit.bind(e)),this.$confirmModal.find('input[name="confirm"]').on("keyup",function(t){e.$confirmModal.find(".btn-confirm").attr("disabled",t.currentTarget.value.toLowerCase()!==e.options.confirmValue.toLowerCase())}),this.$confirmModal.on("shown.bs.modal",function(){e.$confirmModal.find("input").first().focus()}),this.$confirmModal.on("hidden.bs.modal",function(){e.$confirmModal.find(".help-block").html(""),e.$confirmModal.find("input").val("")})):(this.$confirmModal=$("#prompt-modal"),this.$confirmModal.on("click",".btn",function(t){e.events.submit($(t.target).data("confirm"))}),this.$confirmModal.on("hidden.bs.modal",function(){e.destroy()}),this.$confirmModal.modal("show")),this},e.prototype.destroy=function(){var e=this;e.$confirmModal.modal("hide"),setTimeout(function(){e.$confirmModal.remove(0)},100)};var t=function(t){new e("confirm",t)},n=function(t,n){new e("prompt",{message:t,submit:n})},a=function(t,n){new e("alert",{title:t.title,message:t.message,submit:n})};Mashape.alert=a,Mashape.prompt=n,Mashape.confirm=t}.call(this),function(){var e=function(e,t){var n=$(document),a={$parent:$(e.parent),buttonInput:e.buttonInput,$buttonInput:$(e.buttonInput),searchInput:e.searchInput,current:{category:e.currentCategory||"all",search:{by:e.searchFilter||"name",query:""}},callback:t,init:function(){return a.$button=$(a.buttonInput+" .btn"),a.buttons(),a.execute(),a.searchInput&&a.search(),a},categoryFilter:function(e,t){return function(){var n,a=$(this);return a.data("filter")?(n=a.data("filter").toLowerCase(),t?n===e:n!==e):!1}},execute:function(n){var i,o,r=$(e.filterables),s=a.current.search;if(a.$parent.attr("data-filter",a.current.category),s&&s.query){var l=s.query.split(" ");i=$(e.filterables),i=i.filter(function(){return o=$(this),o.data(s.by)?!Mashape.utils.every(l,function(e){return o.data(s.by).toString().match(new RegExp(e,"i"))}):!0})}else i="all"===a.current.category?$(""):r.filter(a.categoryFilter(a.current.category));return $(a.buttonInput+" [data-filter-button]").removeClass("active"),$(a.buttonInput+' [data-filter-button="'+a.current.category+'"]').addClass("active"),r.removeClass("hidden"),i.addClass("hidden"),a.callback&&"function"==typeof a.callback&&t(a.current.category)},buttons:function(){var e;n.on("click",a.buttonInput+" [data-filter-button]",function(t){e=$(this),a.current.category!==e.data("filter-button")&&(e.siblings().removeClass("active"),e.addClass("active"),a.current.category=e.data("filter-button"),a.execute(t))})},search:function(){var e;n.on("keyup",a.searchInput,Mashape.utils.bufferInput(function(t){e=$(t.target).val(),e!==a.current.search.query&&(a.current.search.query=e,a.execute())},100))}};return a.init()};Mashape.Filters=e}.call(this),function(){var e=function(e){var t=query.get("hook"),n=query.get("hook-value"),a=$('form.follow[data-action="'+n+'"]');if(t&&n){var i=n.split("-"),o=i.slice(0,i.length-1).join("-");if("action"===t&&o===e.action){"true"!==a.attr("data-following")&&setTimeout(function(){a.find(".submit:visible").click()},100);var r=query.parse();delete r.hook,delete r["hook-value"],r=query.build(r),Davis.removeHooks(window.location.pathname+r)}t=n=null}};Mashape.handleFollowForm=function(t,n){var a,i,o=new Mashape.FormComponent(t.element,t.settings),r=t.api?"api-":"account-";e(t),o.on("submit",function(e,n){var o=this,r=new Mashape.User;return i=e.form,r.name?(a="true"===i.attr("data-following")?"unfollow":"follow",t.account?Mashape.client[a+"Account"](e.serialized.account).always(n):t.api?Mashape.client[a+"Api"](e.serialized.account,e.serialized.name).always(n):void 0):(Mashape.utils.registerPrompt({action:i.data("action"),redirectUrl:window.location.href}),o.button.enable())}),o.on("success",function(e,i,o,s){var l=r;l+=s.serialized.account,t.api&&(l+="~"+s.serialized.name);var c=$('.counter[data-action="'+l+'"]'),p=0;return p=parseInt(c.html(),10),p=isNaN(p)?0:p,c.html("follow"===a?p+1:p-1),$('[data-action="'+s.form.data("action")+'"]').attr("data-following","follow"===a),"function"==typeof n&&n(a,e)})}}.call(this),function(){var e=function(t,n){this.$el=$(t),this.options=$.extend({},e.defaultOptions,n||{},!0)};e.prototype.options=function(e){this.options=$.extend({},this.options,e,!0)},e.prototype.empty=function(e){return this.$el.html('<p class="no-data">'+(e||"No Data Available")+"</p>")},e.prototype.loading=function(){return Mashape.showLoader(this.$el)},e.prototype.render=function(e){return this.$el.empty(),"function"==typeof e&&(this.options.chart.events||(this.options.chart.events={}),this.options.chart.events.load=e),this.$el.highcharts(this.options)},e.sort=function(e,t){return Mashape.utils.sortBy(e,function(e){return e[t]})},e.isEmpty=function(e){if(Mashape.utils.isObjectEmpty(e))return!0;var t=Mashape.utils.reduce(e,function(e,t){return"object"==typeof t?e+Mashape.utils.reduce(t,function(e,t){return"number"!=typeof t?e:e+t},e):e+t},0);return"number"!=typeof t||isNaN(t)||0===t},e.sortByPrecision=function(t,n){return t&&"months"===t&&(n=e.sort(n,"x")),n},e.determinePercentageOf=function(e,t){var n=parseFloat((100*t/e).toFixed(2));return isNaN(n)?0:n},e.determineAverageOf=function(e,t){var n=parseFloat((t/e).toFixed(2));return isNaN(n)?0:n},e.Tooltip={generatePointHtml:function(){return $('<table class="tooltip-point"></table>')},generateHeaderHtml:function(e){return $('<div class="tooltip-header"></div>').append(e)},generateBulletHtml:function(e){return'<td style="width: 14px"><span class="tooltip-bullet" style="background: '+e+';"></span></td>'},generatePointTitleHtml:function(e){return'<td align="left"><span class="tooltip-point-title">'+e+"</span></td>"},generatePointValueHtml:function(e,t){return'<td align="right"><span class="tooltip-point-data">'+e+(t?" ("+t+")":"")+"</span></td>"}},e.Colors={lightBlue:"hsl(204, 100%, 92%)",red:"hsl(9, 90%, 60%)",redFill:"hsla(9, 90%, 60%, 0.6)",blue:"hsl(204, 95%, 40%)",blueFill:"hsla(204, 95%, 40%, 0.6)",green:"hsl(128, 52%, 62%)",greenFill:"hsla(128, 52%, 62%, 0.6)",yellow:"hsl(46, 96%, 63%)",darkRed:"hsl(9, 54%, 56%)",darkBlue:"hsl(204, 41%, 65%)",darkGreen:"hsl(94, 57%, 48%)"},e.defaultOptions={title:null,subtitle:null,exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},tooltip:{borderColor:"#D1D6DD",borderWidth:2,borderRadius:2,backgroundColor:"#FFF",shadow:!1}},"object"==typeof Mashape&&(Mashape.Graph=e)}.call(this),function(){function e(t,n){this.$el=$(t),this.options=$.extend({},e.defaultOptions,n||{},!0)}e.prototype=Object.create(Mashape.Graph.prototype),e.prototype.constructor=e,e.prototype.parent=Mashape.Graph.prototype,e.defaultOptions=$.extend({},Mashape.Graph.defaultOptions,{chart:{backgroundColor:!1},tooltip:{shared:!0,valueDecimals:2},xAxis:{type:"datetime",title:{text:null},labels:{enabled:!1},lineWidth:1,lineColor:"#FFF",minorTickLength:0,minorTickWidth:0,minorTickInterval:null,tickInterval:null,tickLength:0,tickWidth:0,tickColor:"#FFF"},yAxis:{title:{text:null},labels:{enabled:!1},gridLineWidth:0,minorGridLineWidth:0,minPadding:0,lineWidth:1,lineColor:"#FFF",minorTickColor:"#FFF",minorTickLength:0,minorTickWidth:0,minorTickInterval:null,tickInterval:null,tickLength:0,tickWidth:0,tickColor:"#FFF",minRange:.1},plotOptions:{column:{color:"#2f7ed8",pointPadding:.1,borderWidth:0},area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#2f7ed8"],[1,Highcharts.Color("#2f7ed8").setOpacity(.4).get("rgba")]]},lineWidth:1,marker:{enabled:!1},shadow:!1,states:{hover:{lineWidth:1}},threshold:null},line:{marker:{enabled:!1,fillColor:"#FFF",lineColor:null,radius:2,symbol:"circle",states:{hover:{enabled:!0,lineWidthPlus:2}}},states:{hover:{halo:!1}}},spline:{marker:{enabled:!1,fillColor:"#FFF",lineColor:null,radius:2,symbol:"circle",states:{hover:{enabled:!0,lineWidthPlus:2}}},states:{hover:{halo:!1}}},areaspline:{marker:{enabled:!1,fillColor:!1,lineColor:null,radius:2,symbol:"circle",states:{hover:{enabled:!0,lineWidthPlus:2}}},states:{hover:{halo:!1}}}}}),e.Types={requests:{type:"line",name:"Requests",color:Mashape.Graph.Colors.blue},client_errors:{type:"column",name:"Client Errors: 3xx-4xx",color:Mashape.Graph.Colors.yellow,format:function(e,t){var n=Mashape.Graph.determinePercentageOf(e,t.y);return Mashape.Graph.Tooltip.generatePointTitleHtml(this.name)+Mashape.Graph.Tooltip.generatePointValueHtml(n+"%",Mashape.utils.formatNumber(t.y))}},server_errors:{type:"column",name:"Server Errors: 5xx",color:Mashape.Graph.Colors.darkRed,format:function(e,t){var n=Mashape.Graph.determinePercentageOf(e,t.y);return Mashape.Graph.Tooltip.generatePointTitleHtml(this.name)+Mashape.Graph.Tooltip.generatePointValueHtml(n+"%",Mashape.utils.formatNumber(t.y))}},api_latency:{type:"spline",average:!0,name:"Avg API Latency",color:Mashape.Graph.Colors.blue,format:function(e,t){return Mashape.Graph.Tooltip.generatePointTitleHtml(this.name)+Mashape.Graph.Tooltip.generatePointValueHtml(Mashape.utils.formatNumber(t.y)+"ms")}},mashape_latency:{type:"spline",average:!0,name:"Avg Mashape Latency",color:Mashape.Graph.Colors.green,format:function(e,t){return Mashape.Graph.Tooltip.generatePointTitleHtml(this.name)+Mashape.Graph.Tooltip.generatePointValueHtml(Mashape.utils.formatNumber(t.y)+"ms")}},requestsize:{average:!0,name:"Avg Request Size",format:function(e,t){var n,a;return n=Mashape.Graph.determineAverageOf(e,t.y),n=Mashape.utils.filesize(n),a=Mashape.utils.filesize(t.y),Mashape.Graph.Tooltip.generatePointTitleHtml(this.name)+Mashape.Graph.Tooltip.generatePointValueHtml(n,a)}},responsesize:{average:!0,name:"Avg Response Size",format:function(e,t){var n,a;return n=Mashape.Graph.determineAverageOf(e,t.y),n=Mashape.utils.filesize(n),a=Mashape.utils.filesize(t.y),Mashape.Graph.Tooltip.generatePointTitleHtml(this.name)+Mashape.Graph.Tooltip.generatePointValueHtml(n,a)}}},e.prototype.renderRequestApiGraph=function(t,n,a){var i=this;return this.loading(),this.options.chart.type="line",this.options.yAxis.labels.enabled=!0,this.options.xAxis.labels.enabled=!0,this.options.tooltip={borderColor:"#D1D6DD",borderWidth:2,borderRadius:2,backgroundColor:"#FFF",shadow:!1,shared:!0,useHTML:!0},t.fail(function(e,t){i.empty()}),t.done(function(t,o,r){var s,l,c,p,u={},d=[],h=0;if(Mashape.Graph.isEmpty(t))return i.empty();i.options.tooltip.formatter=function(){var n,a=$('<div class="tooltip"></div>'),i=$("<time></time>").text(moment.utc(this.x).format("MMMM Do YYYY, h:mm:ss a")).css("font-size","10px");a.append(Mashape.Graph.Tooltip.generateHeaderHtml(i));for(n in this.points)if(this.points.hasOwnProperty(n)){var o=Mashape.Graph.Tooltip.generatePointHtml(),r=this.points[n],s=e.Types[r.series.name.toLowerCase()];o.html(Mashape.Graph.Tooltip.generateBulletHtml(r.series.color)),"function"==typeof s.format?o.append(s.format.call(s,t.requests[r.x],r)):o.append(Mashape.Graph.Tooltip.generatePointTitleHtml(s.name||r.series.name)+Mashape.Graph.Tooltip.generatePointValueHtml(Mashape.utils.formatNumber(r.y))),a.append(o)}return a.html()};for(p in t)if(t.hasOwnProperty(p)&&("requests"!==p||"requests"===n.type)){c=t[p],l=e.Types[p.toLowerCase()],u={},u.name=p,u.data=[],l&&(l.color&&(u.color=l.color),l.type&&(u.type=l.type));for(var f in c)s=c[f],l&&l.average&&(s=Mashape.Graph.determineAverageOf(t.requests[f],s)),h+=s,u.data.push({x:parseInt(f,10),y:s});u.data=Mashape.Graph.sortByPrecision(n.precision,u.data),d.push(u)}return"number"==typeof h&&h?i.render(d,a):i.empty()}),t},e.prototype.renderApiGraph=function(e,t){return this.renderRequestApiGraph(Mashape.client.fetchAnalytics("api",e.api,e.type,e.precision),e,t)},e.prototype.renderApplicationApiGraph=function(e,t){return this.renderRequestApiGraph(Mashape.client.fetchAnalytics("application-api",e.application,e.api,e.type,e.environment,e.precision),e,t)},e.prototype.renderDeveloperGraph=function(e,t){return this.renderRequestApiGraph(Mashape.client.fetchAnalytics("developer",e.account,e.api,e.type,e.precision),e,t)},e.prototype.renderApplicationApiQuotaGraph=function(e,t){var n=this;return this.loading(),this.options.chart.type="line",this.options.colors=["#099CD9","#434348","#6EC127","#f7a35c","#8085e9","#f15c80","#e4d354","#8085e8","#8d4653","#91e8e1"],this.options.plotOptions={series:{marker:{enabled:!1,radius:2,lineWidth:1,lineColor:"#FFFFFF"}}},this.options.xAxis={type:"datetime",title:{style:{color:"#AFC6D6",fontWeight:"bold"}}},this.options.yAxis={title:{enabled:!1,text:"Consumed",style:{color:"#AFC6D6",fontWeight:"bold"}},gridLineColor:"#EBEBEB",minPadding:0,maxPadding:0,min:0,minRange:.1},this.options.tooltip={headerFormat:"<b>{series.name}</b><br><br>",pointFormat:"<b>{point.x:%b %d %H:%M:%S}:</b> {point.y:,.0f}"},Mashape.client.fetchApplicationApiQuotaAnalytics(e.account,e.application,e.api,e.precision).fail(function(e,t){n.empty()}).done(function(a,i,o){var r=a,s=[],l=0;return Mashape.utils.each(r,function(t,n){var a={name:t.name,data:[]};for(var i in t.usage)t.usage.hasOwnProperty(i)&&(a.data.push([parseInt(i,10),t.usage[i]]),l+=t.usage[i]);a.data=Mashape.Graph.sortByPrecision(e.precision,a.data),s.push(a)}),0===l?n.empty():void n.render(s,t)})},e.prototype.render=function(e,t){return this.options.series=e,this.loading(),this.parent.render.call(this,t)},"object"==typeof Mashape&&(Mashape.Graph.Generic=e)}.call(this),function(){function e(t,n){this.$el=$(t),this.options=$.extend({},e.defaultOptions,n||{},!0)}e.prototype=Object.create(Mashape.Graph.prototype),e.prototype.constructor=e,e.prototype.parent=Mashape.Graph.prototype,e.types={latency:{type:"areaspline",color:Mashape.Graph.Colors.lightBlue,name:"response time",yAxis:0,zIndex:1,step:1},requests:{type:"line",color:Mashape.Graph.Colors.blue,name:"requests",yAxis:1,zIndex:2,stack:0,step:1},errors:{type:"line",color:Mashape.Graph.Colors.red,name:"errors",yAxis:2,zIndex:3,stack:0,step:1}},e.defaultOptions=$.extend({},Mashape.Graph.defaultOptions,{chart:{margin:[0,10,0,10],spacing:[0,0,0,0],alignTicks:!1},xAxis:{lineWidth:0,tickWidth:0,labels:{enabled:!1}},yAxis:[{min:0,minRange:.1,lineWidth:0,gridLineWidth:0,lineColor:"#FFF",gridLineColor:"#EEE",
title:{text:""},labels:{enabled:!1}},{min:0,minRange:.1,lineWidth:0,gridLineWidth:1,lineColor:"#FFF",gridLineColor:"#EEE",title:{text:""},labels:{enabled:!1},opposite:!0},{min:0,minRange:.1,lineWidth:0,gridLineWidth:1,lineColor:"#FFF",gridLineColor:"#EEE",title:{text:""},labels:{enabled:!1},opposite:!0}],plotOptions:{column:{grouping:!1,groupPadding:.3,spacing:[0,0,0,0],marker:{enabled:!1,fillColor:"#FFF",lineColor:null,radius:2,symbol:"circle",states:{hover:{enabled:!1,lineWidthPlus:2}}},states:{hover:{halo:!1}}},line:{lineWidth:2,marker:{enabled:!1,fillColor:"#FFF",lineColor:null,radius:2,symbol:"circle",states:{hover:{enabled:!0,lineWidthPlus:1}}},states:{hover:{halo:!1}}},areaspline:{lineWidth:0,marker:{enabled:!1,fillColor:"#FFF",lineColor:null,radius:2,symbol:"circle",states:{hover:{enabled:!1,lineWidthPlus:2}}},states:{hover:{halo:!1}}}},tooltip:{borderColor:"#D1D6DD",borderWidth:2,borderRadius:2,backgroundColor:"#FFF",shadow:!1,shared:!0,useHTML:!0,formatter:function(){var e,t,n=$('<div class="tooltip"></div>'),a=$("<time></time>").text(moment.utc(this.x).format("MMMM Do YYYY, h:mm:ss a")).css("font-size","10px");n.append(Mashape.Graph.Tooltip.generateHeaderHtml(a));for(t in this.points)if(this.points.hasOwnProperty(t)){var i,o=Mashape.Graph.Tooltip.generatePointHtml(),r=this.points[t],s=r.series.name,l=r.series.color,c="";switch(c+=Mashape.Graph.Tooltip.generateBulletHtml(l),s){case"requests":e=r.y,c+=Mashape.Graph.Tooltip.generatePointTitleHtml("request"+(e>1?"s":"")),c+=Mashape.Graph.Tooltip.generatePointValueHtml(Mashape.utils.formatNumber(e));break;case"errors":c+=Mashape.Graph.Tooltip.generatePointTitleHtml("error rate"),c+=Mashape.Graph.Tooltip.generatePointValueHtml(r.y+"%",Mashape.utils.formatNumber(r.y?Math.round(e*(r.y/100)):0));break;case"response time":i=r.y,c+=Mashape.Graph.Tooltip.generatePointTitleHtml("avg latency"),c+=Mashape.Graph.Tooltip.generatePointValueHtml(("number"==typeof e?isNaN(i)?0:i:Mashape.utils.formatNumber(parseInt(r.y)))+"ms")}o.html(c),n.append(o)}return n.html()}},series:[]}),e.prototype.generateSeries=function(t){function n(n){if(t[n]){var a,i,o=$.extend(e.types[n],{}),r=t[n];o.data=[];for(i in r)r.hasOwnProperty(i)&&(a=r[i],"latency"===n&&(a=Mashape.Graph.determineAverageOf(t.requests[i],a),a=isNaN(a)?0:a),"errors"===n&&(a=Mashape.Graph.determinePercentageOf(t.requests[i],a),a=isNaN(a)?0:a),i=parseInt(i,10),"number"!=typeof i||isNaN(i)||o.data.push({x:i,y:a}));o.data=Mashape.Graph.sortByPrecision(this.precision,o.data),this.options.series.push(o)}}this.options.series=[],Mashape.utils.each(Object.keys(e.types),$.proxy(n,this))},e.prototype.renderDeveloperGraph=function(e,t){var n=this;this.loading(),this.precision=e.precision||Mashape.CONSTANTS.DEFAULT_PRECISION;var a=Mashape.client.fetchAnalytics("developer",e.account,e.api,"overview",this.precision);a.done(function(e,a,i){n.render(e,t)}),a.fail(function(e){n.empty()})},e.prototype.renderApplicationApiGraph=function(e,t){var n=this;this.loading(),this.precision=e.precision||Mashape.CONSTANTS.DEFAULT_PRECISION,this.environment=e.environment||Mashape.CONSTANTS.DEFAULT_ENVIRONMENT;var a=Mashape.client.fetchAnalytics("application-api",e.application,e.api,"overview",this.environment,this.precision);a.done(function(e,a,i){n.render(e,t)}),a.fail(function(e){n.empty()})},e.prototype.renderApiGraph=function(e,t){var n=this;this.loading(),this.precision=e.precision||Mashape.CONSTANTS.DEFAULT_PRECISION;var a=Mashape.client.fetchAnalytics("api",e.api,"overview",this.precision);a.done(function(e,a,i){n.render(e,t)}),a.fail(function(e){n.empty()})},e.prototype.render=function(e,t){return Mashape.Graph.isEmpty(e)?this.empty():(this.generateSeries(e),this.parent.render.call(this,t))},"object"==typeof Mashape&&(Mashape.Graph.Overview=e)}.call(this),function(){function e(t,n){var a=e.types[t]||e.types.latency,i=(new moment).subtract("days",1),o=[],r=0;for(n=n||{},n.precision=e.precisions[n.precision||"months"];r<n.precision.ticks;r++)i=i.subtract(n.precision.momentUnit,1),o.push({x:i.valueOf(),y:a.generator()});return o.reverse()}e.types={requests:{chance:.1,low:70,high:500,generator:function(){return Math.random()<e.types.requests.chance?Math.random()*e.types.requests.low+1:Math.random()*e.types.requests.high+1}},latency:{chance:.1,low:[30,80],high:[80,200],generator:function(){return Math.random()<e.types.latency.chance?Math.random()*e.types.latency.low[1]+e.types.latency.low[0]:Math.random()*e.types.latency.high[1]+e.types.latency.high[0]}},errors:{chance:.25,generator:function(){return Math.random()<e.types.errors.chance?Math.random():0}}},e.precisions={seconds:{ticks:60,momentUnit:"ms"},daily:{ticks:24,momentUnit:"hours"},week:{ticks:7,momentUnit:"days"},months:{ticks:30,momentUnit:"days"}},"object"==typeof Mashape&&(Mashape.Graph.Simulation=e)}.call(this),function(){function e(t,n){this.$el=$(t),this.options=$.extend({},e.defaultOptions,n||{})}e.prototype=Object.create(Mashape.Graph.Overview.prototype),e.prototype.constructor=e,e.prototype.parent=Mashape.Graph.prototype,e.types={latency:{type:"areaspline",color:"#2E9CEC",name:"response time",axis:0},errors:{type:"column",color:"#CE6455",name:"errors",axis:1}},e.defaultOptions=$.extend({},Mashape.Graph.Overview.defaultOptions,{yAxis:[{gridLineWidth:1,gridlineColor:"#eff4f6",gridLineDashStyle:"Dash",minorGridLineWidth:0,minPadding:0,title:{text:null,style:{color:e.types.latency.color}},labels:{style:{color:e.types.latency.color},enabled:!1},lineColor:null,lineWidth:null,tickColor:null,showEmpty:!1,opposite:!1},{gridLineWidth:1,gridlineColor:"#eff4f6",gridLineDashStyle:"Dash",minorGridLineWidth:0,minPadding:0,title:{text:null,style:{color:e.types.errors.color}},labels:{style:{color:e.types.errors.color},enabled:!1},lineColor:null,lineWidth:null,tickColor:null,showEmpty:!1,opposite:!0}],xAxis:{type:"datetime",gridLineWidth:1,gridlineColor:"#FFF"},plotOptions:{areaspline:{marker:{enabled:!1}}}}),e.prototype.generateSeries=function(t){function n(n,a){t[n]&&this.options.series.push($.extend(e.types[n],{data:t[n].values,name:e.types[n].name,color:e.types[n].color}))}this.options.series=[],Mashape.utils.each(Object.keys(e.types),$.proxy(n,this))},"object"==typeof Mashape&&(Mashape.Graph.Uptime=e)}.call(this),function(){var e=function(e){var t={windowScroll:e.windowScroll,$parent:$(e.parent),$scrollEventer:$(e.windowScroll?window:e.parent),_$loader:$('<li class="loader text-center" style="list-style:none">'+Mashape.CONSTANTS.LOADING_FRAGMENT+"</li>"),_$noMoreResults:$("undefined"!=typeof e.prompt?e.prompt:"please give me a prompt for the end of this infinite scroller!"),_html:e.html,_buffer:100,init:function(n,a,i,o){if(t._namespace=e.namespace||".infinity",t._$noMoreResults.remove(),i||(i="number"==typeof e.currentPage||"string"==typeof e.currentPage?parseInt(e.currentPage)+1:2),t._endpoint=n,t._nextfetch=i,t._nextpage=i,t._halt=!1,t._queue.fifo=[],t._queue.current=null,t._queue.callback=null,t._queue.fetching=!1,t._dataType=t._html?"html":"json",t._cache={length:function(){return Object.keys(this).length-1}},t.setupHandler?Mashape.template(e.template,function(e){t.template=e,t.ractive=t.setupHandler(e),t._attachScrollHandler(),t._preload()}):(t._attachScrollHandler(),t._preload()),(e.showFirstPage||a)&&(t._showLoader(),t._callback=function(){t._showData(null,!0)}),!t.dataHandler)throw"Exception: dataHandler must be defined as a function";return"function"==typeof o&&o(),t},teardown:function(){t._halt=!0,t.$scrollEventer.off(t._namespace)},reset:function(e,n){if(!t._resetting){t._resetting=!0,t._qs=e;var a=-1!==t._endpoint.indexOf("?")?t._endpoint.split("?")[0]+e:t._endpoint+e;t.init(a,t._html,1,function(){t._resetting=!1,t.windowScroll&&$(window).scrollTop(0),"function"==typeof n&&n()})}},setup:function(e){if("function"!=typeof e)throw"Exception: setupHandler must be a function";return t.setupHandler=e,t},data:function(n){if("function"!=typeof n)throw"Exception: dataHandler must be a function";return t.dataHandler=n,t.init(e.endpoint)},_attachScrollHandler:function(){t.$scrollEventer.on("scroll"+t._namespace,Mashape.utils.bufferInput(t._showData.bind(t),100)),setTimeout(function(){t._showData()},300)},checkHeight:function(){t._showData()},_url:function(e){return t._endpoint+(-1===t._endpoint.indexOf("?")?"?":"&"===t._endpoint[t._endpoint.length-1]?"":"&")+"page="+e},_queue:{push:function(e,n){t._queue.fifo.push(t._nextfetch),t._nextfetch++,t._queue.callback=e,n&&t._queue.next()},next:function(e){if(!t._halt&&t._queue.fifo.length&&!t._queue.fetching&&(t._queue.callback=e,"number"==typeof t._queue.fifo[0])){var n=t._qs;return t._load(t._queue.fifo[0],function(e,a,i){t._resetting||t._qs===n&&(t._queue.fetching=!1,e.errors?(console.log("pagination ajax request error"),console.log(e.errors),t._queue.retry()):(t._queue.fifo.shift(),t._cache[i]=e,"function"==typeof t._queue.callback&&t._queue.callback(),t._queue.callback=null,t._callback&&(t._callback(),t._callback=null),t._queue.next()))})}},retry:function(){setTimeout(function(){t._queue.next()},300)}},_preload:function(){if(!t._halt){var e=t._cache.length()+t._queue.fifo.length;if(3>e){for(var n=3-e;n--;)t._queue.push();t._queue.next()}}},_load:function(e,n){if(t._queue.current!==e){t._queue.current=e;var a=Mashape.api.get({url:t._url(e),type:t._dataType});a&&a.always(function(t,a,i){var o="success"===a?i:t;n&&"function"==typeof n&&n(o.getResponse(),o,e)})}},_showLoader:function(){t._$loader.is(":visible")||t._halt||$(t._target||t.$parent).append(t._$loader)},_showData:function(e,n){t._halt||(n||t._nearBottom(e))&&(t._cache[t._nextpage]||""===t._cache[t._nextpage]?t._handleData():t._queue.fifo[0]===t._nextpage?setTimeout(function(){t._queue.next(t._showData)},200):t._queue.fifo.length?(t._queue.fifo.unshift(t._nextpage),t._queue.next(t._showData),t._handleData()):t._queue.push(t._showData,!0))},_handleData:function(e){if(!t._resetting&&!t._handlingData){var n=t._cache[t._nextpage];t._handlingData=!0,delete t._cache[t._nextpage],t._nextpage++,t._halt=t._html?t.dataHandler(n,t._nextpage-1):t.dataHandler(t.ractive,n),t._halt&&t.$parent[t.windowScroll?"after":"append"](t._$noMoreResults),t._$loader.remove(),t._preload(),t._handlingData=!1}},_nearBottom:function(e){return t.windowScroll?$(window).height()>$(document).height()?!0:t._buffer+window.scrollY+window.innerHeight>=document.body.scrollHeight:t.$parent.height()+t._buffer>=t.$parent.innerHeight()+t.$parent.scrollTop()?!0:t._buffer+t.$parent.innerHeight()+t.$parent.scrollTop()>=(e?e.target:t.$parent).scrollHeight}};return t};Mashape.Infinity=e}.call(this),function(){Mashape.initializeLogoUpload=function(e,t){Mashape.client.transload().done(function(n){function a(){m&&s.transloadit("cancel"),r()}function i(){u.button("reset"),f.fadeIn(),h.fadeOut(),p.text("")}function o(){d.fadeOut(),d.find(".progress-bar").css("width",0),d.find(".sr-only").text("")}function r(e){e&&c.modal("hide"),m=!1,o(),i()}var s,l=$(e),c=$("#upload-logo"),p=l.find(".error"),u=l.find("button"),d=l.find(".progress"),h=l.find(".cancel-upload"),f=l.find(".upload-body"),m=!1;c.on("hidden.bs.modal"+(t.namespace||""),a),h.on("click"+(t.namespace||""),a),n.onStart=function(){m=!0,p.text(""),u.button("loading"),f.fadeOut(200),h.removeClass("hidden").fadeIn(),d.removeClass("hidden").fadeIn()},n.onProgress=function(e,t){var n=(e/t*100).toFixed(2)+"%";d.find(".progress-bar").css("width",n),d.find(".sr-only").text(n)},n.onCancel=function(){r()},n.onSuccess=function(e){var n=t.onPatch();n.done(function(){t.onSuccess(e),r(!0),setTimeout(function(){window.location.reload()},200)}),n.fail(function(){r(),p.text("Could not update api logo property, please try again...")})},n.onError=function(e){r(),p.text(e.message)},s=l.transloadit(n)})}}.call(this),function(){var e=$(window);Mashape.Packery=function(e){return this.options=e,this.firstPack=!0,this.pack(),this},Mashape.Packery.prototype.pack=function(t,n){var a=this,i=a.options,o=$(i.container);if("function"==typeof t&&(n=t,t=null),"function"==typeof n){var r=function(){n(),o.packery("off","layoutComplete",r)};o.packery("on","layoutComplete",r)}return a.firstPack&&(a.firstPack=!1,a.packed=o.packery({itemSelector:i.item,gutter:i.gutter,columnWidth:i.columnWidth,isResizeBound:!1,isLayoutInstant:!0,transitionDuration:"0.3s"})),t&&(t=$(t),t.hide(),o.append(t),a.packed.packery("appended",t),t.show()),i.details&&$(i.item).each(function(){var e=$(a).find("details summary");e.on("click",function(){setTimeout(function(){a.packed.packery("layout")},20)})}),i.resize&&a.resizable(i),a.teardown=function(t){i.resize&&a.resizable&&e.off("."+a.namespace),"function"==typeof t&&t()},a},Mashape.Packery.prototype.resizable=function(t){var n=this,a=t.gutter||0,i=t.columnWidth+a,o=function(){if(n.packed.length){var e=getSize(n.packed.parent()[0]).innerWidth,t=Math.floor(e/i)||1;n.packed.width(t*i-a),n.packed.packery()}};return n.namespace&&e.off("."+n.namespace),n.namespace=t.item.replace(/([^a-z]+)/gi,""),e.on("resize."+n.namespace,Mashape.utils.bufferInput(o,t.timeout||100)),o(),{resize:o}}}.call(this),function(){var e=function(e){function t(t){return e.uri+t+"&partial=true"}function n(e){return $.get(t(e))}function a(t,n){var a=$('<div class="loader"><span class="fa fa-spinner fa-spin"></span></div>');return $(e.list+":"+t)[n](a),a}function i(){function t(t){var a,i=$("<div>").html(t).find(e.list);return o.remove(),$(e.list+":first").before(i),a=$(e.list+":first").height(),window.scrollTo(0,$(window).scrollTop()+a),c=c?c-1:c,e.after&&"function"==typeof e.after?e.after(i):void(c?n(c).done(function(e){g[c]=e}):$(".pagination-previous-block").hide())}if(c&&!$(e.list+'[data-page="'+c+'"]').length){var i=g[c],o=a("first","before");m=1,i?(t(i),m=0):n(c).done(function(e){g[c]=e,t(e),m=0})}}function o(){function t(t){var a=$("<div>").html(t).find(e.list);return o.remove(),$(e.list+":last").after(a),p+=1,e.after&&"function"==typeof e.after?e.after(a):void(d>=p&&n(p).done(function(e){g[p]=e}))}if(!(p>d||p&&$(e.list+'[data-page="'+p+'"]').length)){var i=g[p],o=a("last","after");m=1,i?(t(i),m=0):n(p).done(function(e){t(e),m=0})}}function r(e){var t=$(window).scrollTop(),n=$(window).height(),a=$(e).offset().top,i=$(e).height(),o=a+i;return o-.25*i>t&&t+.5*n>a}function s(){var t=$(window),n=$(document);n.ready(function(){t.on("scroll"+e.namespace,function(){var a=t.scrollTop();a>=.9*(n.height()-t.height())&&!m&&o(),a<=.9*(e.headerHeight||0)&&!m&&i(),Math.abs(a-f)>.1*t.height()&&(f=a,$(e.list).each(function(t){if(r(this)){var n=$(this),a=parseInt(n.data("page"),10);return history.replaceState(null,null,e.uri+a),u.find("a").removeClass("active"),u.find('[data-page="'+a+'"]').addClass("active"),0!==a&&u.find(".cursor.prev").attr("href",e.uri+a-1),a!==d&&u.find(".cursor.next").attr("href",e.uri+a+1),!1}}))})})}function l(){u.hide(),h=parseInt(u.find("a.active").data("page"),10),c=h?h-1:h,p=h===d?h:h+1,s(),$(window).height()>$(e.container).height()&&p!==d&&o()}var c,p,u=$(e.element),d=parseInt(u.data("pages"),10),h=e.current||1,f=0,m=0,g=[];l()};Mashape.InfinityScroll=e}.call(this),function(){var e=Mashape.CONSTANTS.CATEGORIES,t=function(e,t){var n=this,a=$(document),i=e.input,o=e.namespace||"";if(this.onEnter=e.onEnter,this.callback=t,this.$input=$(i),this.$parent=this.$input.next(),0!==this.$parent.length||this.$parent.hasClass("suggestions"))this.$suggestions=this.$parent.find("ul");else{var r=$('<div class="suggestions"><div class="suggestion-container"><div class="perfectscroll-container"><ul class="list-unstyled"></ul></div></div></div>');this.$input.parent().append(r),this.$parent=r,this.$suggestions=this.$parent.find("ul")}return this.$scroller=this.$parent.find(".perfectscroll-container"),this.$scroller.perfectScrollbar({wheelSpeed:10}),this.$suggestions.on("click"+o,n.addSuggestion.bind(n)),a.on("keydown"+o,i,n.handleInput.bind(n)),a.on("blur"+o,i,function(){n.hide()}),this.init(e.state)};t.prototype.init=function(e){e||(e={});var t="";"string"==typeof e.tags&&e.tags?t+="#"+e.tags:e.tags&&e.tags.length&&(e.tags=Mashape.utils.filter(e.tags,function(e){return e&&e.length}),t+="#"+e.tags.join(" #")),t.length&&(t+=" "),e.query&&"string"==typeof e.query&&(t+=e.query),this.$input.val(t)},t.prototype.show=function(e){this.$parent.fadeIn(e||200)},t.prototype.hide=function(e){var t=this;this.$parent.fadeOut(e||200,function(){t.$suggestions.html("")})},t.prototype.handleInput=function(e){if(16!==e.which){var t=this;if(13===e.which)t.enterPressed=!0;else if(38===e.which||40===e.which)return e.preventDefault(),t.navigateSuggestions(e);setTimeout(t.determineFocus.bind(t),0),setTimeout(function(){return 13===e.which&&"function"==typeof t.callback&&t.callback(t.parseInput())},0)}},t.prototype.determineFocus=function(){var e=this.focusedTag();if(e!==!1){if(this.enterPressed)return this.tagging=!1,this.enterPressed=null,this.addSuggestion(),void this.hide();this.tagging=!0,this.currentTag=e,this.suggestionIndex=0,this.showSuggestions()}else e===!1&&this.tagging&&(this.tagging=!1,this.hide())},t.prototype.focusedTag=function(){for(var e=this.$input.val(),t=this.$input.getCursorPosition();"#"!==e[t];)if(t--,!e[t]||" "===e[t])return!1;return this.afterHashTag(t+1)},t.prototype.afterHashTag=function(e){for(var t=this.$input.val(),n="";t[e]&&" "!==t[e];)n+=t[e++];return n},t.prototype.parseInput=function(){function e(e){return e[0].slice(1)}var t,n,a,i=this,o=[],r=/(#\w+)/g;return n=i.$input.val(),t=Mashape.utils.map(Mashape.utils.groups(n,r),e),t=t.length?t:void 0,o=Mashape.utils.filter(n.split(" "),function(e){return-1===e.indexOf("#")}).join(" "),a=Mashape.utils.map(n.split(/#|\s/),function(e){var n=t&&-1!==t.indexOf(e)?"tag":"query";return'<li class="'+n+'">'+e+"</li>"}),{tags:t,query:o}},t.prototype.getSuggestions=function(t,n){"function"==typeof n&&n(e)},t.prototype.addSuggestion=function(e){var t,n=this.$input.val(),a="",i=this.$input.getCursorPosition(),o=i;if(e){if(!e.target||!e.target.innerText)return;t=e.target.innerText}else t=this.suggestions[this.suggestionIndex];if(-1!==n.indexOf("#")){for(;"#"!==n[i];)i--;for(;n[o]&&" "!==n[o];)o++}else a="#";this.tagging=!1,this.$input.val(n.slice(0,i+1)+a+t+n.slice(o,n.length)),this.$suggestions.html(""),this.parseInput()},t.prototype.showSuggestions=function(){var e=this;e.getSuggestions(e.currentTag,function(t){e.suggestions=t,e.$suggestions.html(Mashape.utils.map(t,function(e){return"<li>"+e+"</li>"}).join("")),e.show()}),e.highlightSuggestion()},t.prototype.highlightSuggestion=function(){this.$suggestions.children().removeClass("active"),this.$suggestions.children(":nth-child("+(this.suggestionIndex+1)+")").addClass("active")},t.prototype.navigateSuggestions=function(e){this.suggestions&&(38===e.which?this.suggestionIndex-=1:40===e.which&&(this.suggestionIndex+=1),this.suggestionIndex<0?this.suggestionIndex=0:this.suggestionIndex>this.suggestions.length-1&&(this.suggestionIndex=this.suggestions.length-1),this.highlightSuggestion())},Mashape.SearchInput=t}.call(this),function(){var e=$(document),t=function(t,n){var a=t.selected,i=$(t.selectors),o=function(e){e&&e.preventDefault();var o=$(this);return t.noneAllowed&&o.data("name")===a?(a="none",o.removeClass("active")):(i.removeClass("active"),o.addClass("active"),a=o.data("name")),a&&n&&"function"==typeof n&&n.call(o,a,e),!1};return e.on("click"+(t.namespace||""),t.selectors,Mashape.utils.bufferInput(o)),o.call($(t.selectors+'[data-name="'+t.selected+'"]'))},n=function(t,n){var a,i=t.selectors,o=$(i+" .btn span"),r=t.selected,s=function(e){return a=$(this),o.text(a.text()),r=a.data("filter-button"),n&&"function"==typeof n&&n.call(a,r,e)};return r&&o.text($(i+" [data-filter-button="+r+"]").text()),e.on("click"+(t.namespace||""),i+" [data-filter-button]",Mashape.utils.bufferInput(s)),this};Mashape.selector=function(e){var t,n=$(e.element),a=n.selectpicker(e.showTick?{iconBase:"fa",tickIcon:"fa-check",width:e.width,hideDisabled:!0}:{width:e.width,hideDisabled:!0});return e.selected&&(n.selectpicker("val",e.selected),n.selectpicker("render")),t=n.selectpicker("val"),a.on("change"+(e.namespace||""),function(a){return e.add&&this.value===e.add?(a.preventDefault(),a.stopPropagation(),n.selectpicker("val",t),"function"==typeof e.on.add&&e.on.add.call(this,a),void n.selectpicker("render")):"function"==typeof e.on.change&&t!==this.value?(t=this.value,e.on.change.call(this,a)):void 0}),a},Mashape.selector.horizontal=t,Mashape.selector.vertical=n}.call(this),function(){var e="undefined"==typeof e||"[object Object]"!==Object.prototype.toString.call(e)?{}:e;e.keypath=function(t,n,a,i,o){if(t&&!n&&!a&&!i)return{get:function(n,a){return e.keypath(t,n,null,null,a)},set:function(n,a){return e.keypath(t,n,a)},remove:function(n){return e.keypath(t,n,null,!0)}};var r,s,l={};if(n="string"==typeof n?n.split("."):n,r=n.shift(),r&&n.length){if("[]"===r&&"[object Array]"===Object.prototype.toString.call(t)){a||i||(s=[]);for(var c=0;c<t.length;c++)!a&&i?e.keypath(t[c],n.slice(0),a,i):a?t[c]=e.keypath(t[c],n.slice(0),a,i,o):(l=e.keypath(t[c],n.slice(0),a,i,o))&&s.push(l);return a?t:i?void 0:s}if(!t[r]){if(!a)return;t[r]={}}if(!a)return e.keypath(t[r],n,a,i,o);t[r]=e.keypath(t[r],n,a,i,o)}else{if(a)return"object"!=typeof t&&(t={}),l[r]=t[r]=a,t;if(!i)return o?t:"undefined"!=typeof t?t[r]:void 0;delete t[r]}},e.keypath.get=function(t,n,a){return e.keypath(t,n,null,null,a)},e.keypath.set=function(t,n,a){return e.keypath(t,n,a)},e.keypath.remove=function(t,n){return e.keypath(t,n,null,!0)},function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(e,t):n[e]=t()}("storage",function(){var e=localStorage;return function(t){var n;return t=t||{},"session"===t.expires&&(e=sessionStorage),"undefined"==typeof e?!1:("expires"in t&&"number"==typeof t.expires&&t.expires>0&&(n=!0),{set:function(a,i){var o={"nasa:store":i};return n&&(o["nasa:expires"]=+new Date+t.expires),e.setItem(a,JSON.stringify(o)),this},get:function(t){function n(e){if(null===e)return null;if("nasa:store"in e){if(!("nasa:expires"in e&&l>=e["nasa:expires"]))return o["nasa:store"];r.remove(t)}return null}var a,i,o,r=this,s=!1,l=+new Date;try{if("[object Array]"===Object.prototype.toString.call(t)){for(i={},a=0;a<t.length;a++)o=JSON.parse(e.getItem(t[a])),null!==o&&(s||(s=!0),i[t[a]]=n(o));i=s?i:null}else o=JSON.parse(e.getItem(t)),i=n(o)}catch(c){console.log(c.message)}return i},"import":function(e){var t;for(t in e)e.hasOwnProperty(t)&&this.set(t,e[t]);return this},remove:function(t){if("[object Array]"===Object.prototype.toString.call(t))for(var n=0;n<t.length;n++)e.removeItem(t[n]);else e.removeItem(t);return this},empty:function(){return e.clear(),this}})}},e),Mashape.Store=function(t,n){var a,i;if(n=n||{},"object"==typeof t&&(n=t,t=n.key),!t||"string"!=typeof t)return"Error, key must be a string";if(Mashape.Store[t]&&!n.cache&&!n.data)return Mashape.Store[t]._options=$.extend(Mashape.Store[t]._options,n),Mashape.Store[t];var o=n.cache?{}:null;return n.cache&&(o.expires="number"===n.cache?60*n.cache*1e3:n.cache),a=!0,i=Mashape.Store[t]={data:n.data||void 0,_storage:e.storage(o),_cacheTime:n.cache,_options:n,clear:function(){return i._storage.remove(t),Mashape.Store[t]=null,i},get:function(n,a){return i.data=i._storage.get(t)||i.data||i._options.defaultValue,n&&"object"==typeof i.data?e.keypath.get(i.data,n,a):i.data},set:function(e){return i.data=e,i._storage.set(t,i.data||n.defaultValue),Mashape.Events.emit(t+".updated",e),i},subscribe:function(e,t){Mashape.Events.on(e,function(e,n){return t(n,e)})},appendPrependAllowed:function(){return i.data||(i.data=[]),$.isArray(i.data)},finishAppendPrepend:function(e){i._cacheTime&&i._storage.set(t,i.data),Mashape.Events.emit(t+".updated",e)},append:function(e){return i.appendPrependAllowed()?($.isArray(e)?i.data=i.data.concat(e):i.data.push(e),i.finishAppendPrepend(e),i):console.warn("[Mashape Store]","Cannot append to non-array object")},prepend:function(e){return i.appendPrependAllowed()?($.isArray(e)?i.data=e.concat(i.data):i.data.unshift(e),i.finishAppendPrepend(e),i):console.warn("[Mashape Store]","Cannot append to non-array object")},each:function(e,t){if(a)return a=!1,setTimeout(function(){i.each(e,t)},100);if(!e||"function"!=typeof e)return console.warn("[Mashape Store]","Iterator must be a function.");if(i._fetching)return i._callback=function(){i.each(e,t)};if(!i.get())return t&&"function"==typeof t&&t();for(var n=i.get(),o=0,r=n.length;r>o;o++)e(n[o],o);return t&&"function"==typeof t&&t()}},n.defaultValue&&!i.get()&&i.set(n.defaultValue),n.data&&i.set(n.data),i}}.call(this),function(){Mashape.template=function(e,t){if("function"==typeof t){if(Mashape.template[e]&&Mashape.template[e].fetching)return Mashape.Events.one("retrieved.template."+e,function(){Mashape.template(e,t)});if(Mashape.template[e])return t(Mashape.template[e]);var n={url:"/templates/"+e,type:"html",method:"GET"};Mashape.template[e]={fetching:!0};var a=Mashape.utils.ajax(n);a.done(function(n,a,i){return Mashape.template[e]=n,Mashape.Events.emit("retrieved.template."+e),t(Mashape.template[e])}),a.fail(function(n,a){return t(Mashape.template[e])})}return Mashape.template[e]},Mashape.template.loading=function(){$(".modal-backdrop").remove(0),$("body > .page").append('<div class="modal-backdrop fade in" style="color:white; text-align: center"><i class="fa fa-spinner fa-spin fa-3x" ></i><h1>Loading...</h1></div>')},Mashape.template.layout=function(e,t,n){return"string"==typeof t?t='<div id="'+t+'" class="'+t+'"></div>':"function"==typeof t?(n=t,t=""):t="",Mashape.template("Layout/"+e,function(e){t&&(e=$(e),e.find(".content").append(t)),$("body > .page").html(e),n&&"function"==typeof n&&n(e)}),Mashape.template}}.call(this),function(){var e=function(t){this.options=$.extend({},$.fn.tldrModal.defaults,t),this.$element=$(this),this.text=this.$element.text(),this.text.length<this.options.length||(this.$modal=e.modal({id:this.options.id,title:this.options.name,body:this.text}),this.position=this.text.substr(0,this.options.length).lastIndexOf(" "),this.trimmed=this.text.trim().substring(0,this.position||this.options.length).split(" ").slice(0,-1).join(" "),this.$container=$('<span class="more-contaner">'+this.trimmed+"</span>"),this.$link=$('<span> </span><a data-toggle="modal" data-target="#'+this.options.id+'">'+this.options.more+"</a>"),this.$element.html(this.$container).append(this.$link),$("body").find("#"+this.options.id).remove().end().append(this.$modal))};e.defaults={more:"&hellip;",length:160},e.modal=function(e){return $('<div class="modal fade" id="'+e.id+'"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">'+e.title+'</h4></div><div class="modal-body"><p>'+e.body+"</p></div></div></div></div>")},$.fn.tldrModal=e}.call(this),function(){var e={VIEW:{LISTING:1,DETAILS:2},PAGE_SIZE:10,MAX_PAGINATION_BUTTONS:5,DEFAULT_FEE:20,ractive:null,init:function(t){var n=$(".loading-container.hidden");n.length&&n.removeClass("hidden"),t=t||{},e.ractive=null,Mashape.log.debug("Transactions:","Request parameters",t.request.params),e.params=t.request.params,e.transportType=t.request.params.api?"getApi":"getAccount",e.view=t.request.params.transaction?e.VIEW.DETAILS:e.VIEW.LISTING,Mashape.log.debug("Transactions:","View type is (",e.view,")"),async.parallel({template:function(e){return t.template?e(null,t.template):void Mashape.utils.ajax({method:"GET",url:t.templateUrl,dataType:"text"}).always(Mashape.utils.asyncAlways(e))},transactions:function(t){return e.view===e.VIEW.LISTING?(Mashape.log.debug("Transactions:","Fetching listing data"),e.transport[e.transportType+"Transactions"]({account:e.params.account,api:e.params.apiId,sort:"periodstart"}).always(Mashape.utils.asyncAlways(t))):void t()},transaction:function(t){return e.view===e.VIEW.DETAILS?(Mashape.log.debug("Transactions:","Fetching details data"),e.transport[e.transportType+"Transaction"]({account:e.params.account,api:e.params.apiId,transaction:e.params.transaction,sort:"periodstart"}).always(Mashape.utils.asyncAlways(t))):void t()}},function(t,a){return t?(Mashape.log.debug("Transactions:","Obtained error",t),e.helpers.alertError(t)):(n.length&&(Mashape.log.debug("Transactions:","Removing loader"),n.remove()),void e.initRactive({results:a}))})},initRactive:function(t){var n=t.results,a=!1;Mashape.log.debug("Transactions:","Checking breakdown result"),n.transaction&&(a=n.transaction.periodstart>14095296e5&&0!=n.transaction.quotaUsageSum&&new Date(n.transaction.subscription.creationDate).toUTCString()!==new Date(n.transaction.periodstart).toUTCString()),Mashape.log.debug("Transactions:","Initializing ractive",t.results),e.ractive=new Ractive({el:"div.transactions",template:t.results.template,data:{VIEW:e.VIEW,DEFAULT_FEE:e.DEFAULT_FEE,view:e.view,loading:!1,helpers:e.ractiveHelpers,transactions:n.transactions?n.transactions.data:[],transaction:n.transaction?n.transaction:!1,breakdown:a,query:{filter:"all",sort:"periodstart",order:"desc"}},complete:function(){e.paginate(n.transactions||{total:0}),e.setupRactive(),e.initDropdowns(),e.initTooltips(),Mashape.log.debug("Transactions:","Initialization complete")}})},setupRactive:function(){_.each(e.eventHandlers,function(t,n){"object"==typeof t?e.ractive.on(n,function(n,a){"function"==typeof t[a]?t[a].apply(e.ractive,arguments):Mashape.log.warn("Transactions:","Event was called, but no handler was found.")}):"function"==typeof t&&e.ractive.on(n,t)})},initTooltips:function(){$('.transactions [data-toggle="tooltip"]').each(function(){$(this).tooltip("destroy").tooltip()})},initDropdowns:function(){Mashape.selector({showTick:!0,selected:"",element:".filters-bar-action .filter-by",width:125,on:{change:function(){var t=$(this).val();event.original=event,e.ractive.set("query.filter",t),e.eventHandlers.fetchTransactions(event,{account:e.params.account,api:e.params.apiId,filter:t,sort:("asc"===e.ractive.get("query.order")?"-":"")+e.ractive.get("query.sort")})}}}),Mashape.selector({showTick:!0,selected:e.ractive.get("query.sort"),element:".filters-bar-action .sort-by",width:115,on:{change:function(t){var n=$(this).val();t.original=t,e.ractive.set("query.sort",n),e.eventHandlers.fetchTransactions(t,{account:e.params.account,api:e.params.apiId,sort:("asc"===e.ractive.get("query.order")?"-":"")+n})}}}),Mashape.selector({showTick:!0,selected:e.ractive.get("query.order"),element:".filters-bar-action .order-by",width:95,on:{change:function(t){t.original=t;var n=$(this).val();e.ractive.set("query.order",n),e.eventHandlers.fetchTransactions(t,{account:e.params.account,api:e.params.apiId,sort:("asc"===e.ractive.get("query.order")?"-":"")+e.ractive.get("query.sort")})}}})},load:function(t){var n=Mashape.utils.ajax(t);return e.ractive&&(e.ractive.set("loading",!0),n.always(function(){e.ractive.set("loading",!1)})),n},paginate:function(t){if(e.ractive){var n,a,i,o=e.ractive.get("query.page")||1,r=e.PAGE_SIZE,s=e.MAX_PAGINATION_BUTTONS,l=t.total,c=Math.ceil(l/r);a=o-s>0?o-s:0,i=c>o+s?o+s:c,i=2*s>i&&c>2*s?2*s:i,n=_.range(a+1,i+1),e.ractive.set("currentPage",o),e.ractive.set("lastPage",c),e.ractive.set("pages",n)}},transport:{getApiTransactions:function(t){"use strict";return e.load({method:"GET",url:"/api/internal/"+t.account+"/"+t.api+"/transactions",data:e.helpers.getQuery(t)})},getApiTransaction:function(t){"use strict";return e.load({method:"GET",url:"/api/internal/"+t.account+"/"+t.api+"/transactions/"+t.transaction,data:e.helpers.getQuery(t)})},getAccountTransactions:function(t){"use strict";return e.load({method:"GET",url:"/api/internal/settings/transactions",data:e.helpers.getQuery(t)})},getAccountTransaction:function(t){"use strict";return e.load({method:"GET",url:"/api/internal/settings/transactions/"+t.transaction,data:e.helpers.getQuery(t)})}},ractiveHelpers:{transactionDate:function(e){return moment.utc(e).format("MM/DD/YYYY")},usageDate:function(e){return moment.utc(parseInt(e)).format("MMMM DD")},determineFee:function(t,n){return t&&0!==t?(n=n||e.DEFAULT_FEE,n/=100,
n=t*n):0},determineTotal:function(t,n){return t&&0!==t?t-e.ractiveHelpers.determineFee(t,n):0},formatNumber:function(e,t){return _.numberFormat(e,t||0,".",",")},money:function(e){return _.numberFormat(e,2,".",",")},apiLink:function(e){return Mashape.Cards.Api.link(e)}},eventHandlers:{selectPage:function(t,n){t.original.preventDefault(),e.eventHandlers.fetchTransactions(t,{account:e.params.account,api:e.params.apiId,page:n.page}).done(function(t){e.ractive.set("currentPage",n.page)})},fetchTransactions:function(t,n){t.original.preventDefault();var a=e.transport[e.transportType+"Transactions"](n);return a.done(function(t){e.ractive.set("query.page",n.page||1),e.ractive.set("transactions",t.data),e.paginate(t),e.initTooltips()}),a}},helpers:{getQuery:function(t){"use strict";var n={};return e.ractive&&(n=e.ractive.get("query"),n.page=1),$.extend({},n,t)},alertError:function(e){Mashape.log.error(e),new Mashape.Alert("body",{type:"danger",message:e}).show()}}};Mashape.Transactions=e}.call(this),function(){Mashape.Router(function(){this.priority(7).scope("/logout",function(){this.base(function(e){localStorage.clear(),window.location.pathname="/logout"})}),this.priority(10).scope("/:account",function(){this.base(Mashape.Profile.page(void 0,{headers:{accept:"text/html"},notFoundView:"user-not-found"})),this.get("/apis/consumed",Mashape.Profile.page("apis/consumed")),this.get("/apis/following",Mashape.Profile.page("apis/following")),this.get("/accounts/following",Mashape.Profile.page("accounts/following")),this.get("/accounts/followers",Mashape.Profile.page("accounts/followers")),this.get("/activity",Mashape.Profile.page("activities"))}),this.scope("/settings",function(){this.base(Mashape.Settings.loadPartial),this.get("/:page",Mashape.Settings.loadPartial),this.get("/transactions/:transaction",Mashape.Settings.loadPage("transactions"))})})}.call(this),function(){var e=$(document),t=$(window),n={ScrollViews:[],namespace:".profile",feed:{selector:".feed.blocks",data:{"apis/consumed":{selector:".feed .consumed",prompt:'<div class="empty"><span class="fa fa-exclamation-circle"></span><p><b><%= name %></b> is currently not consuming any APIs.</p></div>'},"apis/published":{selector:".feed .published",prompt:'<div class="empty"><span class="fa fa-exclamation-circle"></span><p><b><%= name %></b> does not currently have any published APIs.</p></div>'},"apis/following":{selector:".feed .apis.following",prompt:'<div class="empty"><span class="fa fa-exclamation-circle"></span><p><b><%= name %></b> is currently not following any APIs.</p></div>'},activities:{selector:".feed .profile-activity",prompt:"<p>This is the end of this user's activity feed.</p>"}}},page:function(e,t){return function(a){a.params.page=e,Mashape.Router.Partial(a,t||{},function(){n.initialize(a)})}},initialize:function(e){Mashape.Router.$loading=".profile .feed",Mashape.Router.teardown=n.teardown,e.params.page=e.params.page||"apis/published",n.account=Mashape.Store("profile.account"),n.page=e.params.page,n.helpers.setupFollowingTabs(),n.helpers.setupWindowEvents(),n.actions.view()},teardown:function(){e.off(n.namespace);for(var t in n.ScrollViews)n.ScrollViews[t].teardown();n.ScrollViews=[]},helpers:{setupWindowEvents:function(){var a,i,o,r=$(".biography"),s=$(".profile .tabs"),l=$(n.feed.selector),c=$(".footer"),p=$(".profile .side"),u=$(".profile .head").outerHeight(),d="fixed";e.on("click"+n.namespace,".api.block, .api.block div, .api.block img",function(e){var t,n=$(this);n.attr("href")||(n.hasClass("api")&&n.hasClass("block")||(n=$(n.parents(".api")[0])),e.preventDefault(),e.stopPropagation(),$(e.target).hasClass("follow")||(t=n.find(".name a").attr("href"),e.ctrlKey||e.metaKey?window.open(t,"_blank"):Davis.redirect(t)))}),r.tldrModal({id:"biography",name:n.account.get("name")+" Biography",length:260,more:"... Read more"}),s.find("a").on("click"+n.namespace,function(e){var t=window.history,a={title:window.title,path:this.getAttribute("href"),page:this.getAttribute("data-page")};e.preventDefault(),e.stopPropagation(),t.pushState(null,null,a.path),n.page=a.page,n.actions.view(a.page)});var h=function(){i=t.scrollTop(),i>=u&&a>=u||u>i&&u>a||t.innerHeight()<$(n.feedSelector).innerHeight()+u||(i>=u?(s.addClass(d),p.addClass(d),l.addClass(d)):(s.removeClass(d),p.removeClass(d),l.removeClass(d)),a=i)},f=function(){return o=t.height(),o>800?c.addClass(d):c.removeClass(d)};t.on("resize"+n.namespace,f),t.on("scroll"+n.namespace,h),f()},setupViewFeed:function(){var e=$(n.feed.selector+" > div"),t=n.feed.data[n.page],a=$(t.selector);e.hide();for(var i in n.ScrollViews)n.ScrollViews[i]._$noMoreResults&&n.ScrollViews[i]._$noMoreResults.hide();if(!n.ScrollViews[n.page]){var o=new Mashape.Infinity({namespace:n.namespace,endpoint:"/api/partial/"+n.account.get("id")+"/"+n.page,parent:a,windowScroll:!0,currentPage:0,showFirstPage:!0,html:!0,force:!0,prompt:""});o.pages_loaded=0,o.data(function(e){return e&&"string"==typeof e&&e.length?(o.pages_loaded++,void a.append(e)):(0===o.pages_loaded&&a.append(Mashape.utils.template(t.prompt,{name:n.account.get("name")})),!0)}),n.ScrollViews[n.page]=o}return a.show()},setupFollowingTabs:function(){Mashape.utils.each(["following","followers"],function(t){var a=$(".modal-body >."+t),i=$("#"+t);n.ScrollViews[t]=new Mashape.Infinity({namespace:n.namespace,endpoint:"/api/internal/"+n.account.get("id")+"/accounts/"+t,parent:a,currentPage:0,html:!0,prompt:"  "}).data(function(e){return e&&"string"==typeof e?void a.append(e):!0}),e.on("click",".modal-body > ."+t+" a.name",function(){i.modal("hide")})}),Mashape.handleFollowForm({account:!0,action:"follow-account",element:".follow.account",settings:{namespace:n.namespace}}),Mashape.handleFollowForm({api:!0,action:"follow-api",element:".follow.api",settings:{namespace:n.namespace}})}},actions:{view:function(){var e,t;e=$(".feeds li"),e.removeClass("active"),t=$('a[data-page="'+n.page+'"]'),t.parents("li").addClass("active"),n.helpers.setupViewFeed()}}};Mashape.Profile=n}.call(this),function(){Mashape.Settings=function(e){var t=$(document),n="hidden",a=".errors",i={loadPartial:function(t){e.Router.teardown=i.teardown,t.params.page||(t.params.page="profile"),e.Router.Partial(t,{el:"body > .page"},function(){$(e.CONSTANTS.SIDEBAR_ID+" ul li a").removeClass("active").filter("."+t.params.page).addClass("active"),"function"==typeof i[t.params.page]&&i[t.params.page](t)})},loadPage:function(e){return function(t){return t.params.page=e,i.loadPartial(t)}},teardown:function(){t.off(".settings"),t.off(".password-name-change"),t.off(".change-password"),i.RenameForm&&(i.RenameForm.detach(),i.RenameModalForm.detach()),i.ChangePasswordForm&&(i.ChangePasswordForm.detach(),i.ChangePasswordModal.detach()),i.ProfileForm&&i.ProfileForm.detach(),i.BillingForm&&i.BillingForm.detach()},transactions:function(t){e.Transactions.init({request:t,templateUrl:"/templates/User/Settings/transaction_template"})},account:function(){i.attachAccountRenameHandlers(),i.attachPasswordChangeHandlers()},attachAccountRenameHandlers:function(){var t=$("#password-name-change");i.RenameForm=new e.FormComponent(".change-name").on("submit",function(e,n){var a=this,i=e.serialized.name;t.find('input[name="name"]').val(i),t.find(".rename").text(i),t.on("hidden.bs.modal",function(){a.button.enable()})}),i.RenameModalForm=new e.FormComponent(".password-name-change").on("submit",function(t,n){e.client.rename(t.serialized).always(n)}).on("success",function(e,t){window.location.reload()})},attachPasswordChangeHandlers:function(){var t,n=$("#password-change"),a={};i.ChangePasswordForm=new e.FormComponent(".change-password").on("submit",function(i,o){var r,s=this;return n.on("hidden.bs.modal",function(){s.processing=!1,s.button.enable()}),n.on("shown.bs.modal",function(){n.find('input[type="password"]').focus()}),!i.serialized.password||e.utils.isBlank(i.serialized.password)?r={password:"Please enter a new password first."}:!i.serialized.confirmPassword||e.utils.isBlank(i.serialized.confirmPassword)?r={confirmPassword:"Please confirm the new password."}:i.serialized.password!==i.serialized.confirmPassword&&(r={password:"Fields do not match, check to see if capslock is turned on."}),r?(n.modal("hide"),o({getResponse:function(){return r}})):(a.password=i.serialized.password,a.confirmPassword=i.serialized.confirmPassword,t=o,void n.modal("show"))}),i.ChangePasswordModal=new e.FormComponent(".password-change").on("submit",function(i,o){a.currentPassword=i.serialized.currentPassword,e.client.updatePassword(a).done(o).fail(function(e,a){return e.responseJSON.password?(n.modal("hide"),i.button.enable(),t(e)):o(e)})}).on("success",function(t,a){n.modal("hide"),new e.Notification(".change-password").success("You have successfully updated your password."),setTimeout(function(){window.location.reload()},1500)})},billing:function(n){var a=$(".saved"),i=$(".add.card");t.on("click.settings",".update",function(e){a.fadeOut(function(){a.addClass("hidden"),i.removeClass("hidden").hide().fadeIn()})}),t.on("click.settings",".cancel",function(e){i.fadeOut(function(){i.addClass("hidden"),a.removeClass("hidden").hide().fadeIn()})}),new e.CardForm("form.billing").on("success",function(){var t=$(".billing button.submit");t.attr("disabled","disabled"),new e.Notification(".billing").success("Credit Card Successfully Added"),setTimeout(function(){window.location.reload(!0)},1500)})},payout:function(i){var o=$(".saved"),r=$(".prompt"),s=e.client.stripeKeys();s.done(function(e,t,n){Stripe.setPublishableKey(e.key)}),s.fail(function(e,t){console.warn("Failed to load stripe credentials")}),t.on("click.settings",".saved .update",function(e){return o.fadeOut(function(){o.addClass("hidden"),r.removeClass("hidden").hide().fadeIn()})}),t.on("click.settings",".cancel",function(e){return r.fadeOut(function(){r.addClass("hidden"),o.removeClass("hidden").hide().fadeIn()})});var l=new e.FormComponent(".ach.payout",{namespace:".settings"});l.on("submit",function(t,i){return Stripe.bankAccount.createToken(t.serialized,function(o,r){var s=$(t.form);return r.error?(s.find(a).removeClass(n).text(r.error.message),s.find(".btn").prop("disabled",!1),i({errors:!0,body:t.serialized})):(s.find(a).addClass(n),r.form=t.serialized,void e.client.updateSettings("payout/ach",r).always(i))})}),l.on("success",function(t,n){new e.Notification(".ach.payout").success("Payout details successfully updated."),setTimeout(function(){window.location.reload(!0)},1500)});var c=new e.FormComponent(".paypal.payout",{namespace:".settings"});c.on("submit",function(t,n){e.client.updateSettings("payout/paypal",t.serialized).always(n)}),c.on("success",function(t,n){new e.Notification(".paypal.payout").success("Payout details successfully updated."),setTimeout(function(){window.location.reload(!0)},1500)}),c.on("error",function(){new e.Notification(".paypal.payout").warn("Failed to add paypal as your payout option.")})},notifications:function(t){var n=new e.FormComponent(".notifications",{namespace:".settings",autosave:!0});n.on("submit",function(t,n){e.client.updateSettings("notifications",t.serialized).always(n)})},profile:function(t){i.ProfileForm=new e.FormComponent(".profile",{namespace:".settings",autosave:!0}),i.ProfileForm.on("submit",function(t,n){for(var a in t.serialized)t.serialized[a]||delete t.serialized[a];e.client.updateSettings("profile",t.serialized).always(n)})},emails:function(t){function n(){return a.modal("hide"),!1}var a=$("#email-verification-sent"),i=!1;a.find(".btn").on("click",n),$(".email-list").on("click",".email-make-primary",function(t){function n(){$(".email-list .primary").removeClass("primary"),r.parents(".email-row").addClass("primary")}function a(t){var n=t.responseJSON.address||"Error making email primary";new e.Notification(".email-list").error(n)}function i(){r.removeClass("loading")}var o=$(this).parents(".email-row").data("emails-href"),r=$(this);r.addClass("loading"),e.client.makeEmailPrimary(o).done(n).fail(a).always(i)}).on("click",".email-remove",function(t){function n(){r.parents(".row").remove()}function a(t){var n=t.responseJSON.address||"Error deleting email";new e.Notification(".email-list").error(n)}function i(){r.removeClass("loading")}var o=$(this).parents(".email-row").data("emails-href"),r=$(this);r.addClass("loading"),e.client.removeEmail(o).done(n).fail(a).always(i)}).on("click",".email-resend-activation",function(t){function n(){a.modal("show"),c.show().addClass("active")}function o(t){var n=t.responseJSON.address||"Error resending verification email";new e.Notification(".email-list").error(n)}function r(){i=!1,s.find(".email-resending").hide(),setTimeout(function(){c.removeClass("active")},4e3)}var s=$(this).parents(".email-row"),l=s.data("email"),c=s.find(".email-sent");return i||(i=!0,s.find(".email-resending").show(),e.client.resendEmailVerification(l).done(n).fail(o).always(r)),!1});var o=new e.FormComponent(".emails",{namespace:".settings",autosave:!1});o.on("submit",function(t,n){function i(e){var t=$(".email-row:last").parents(".row").clone();t.find(".email-row").addClass("unverified").removeClass("primary").attr("data-emails-href",e.links.self.href).data("emails-href",e.links.self.href).attr("data-email",e.address).data("email",e.address).find(".email-address").text(e.address).end().end().appendTo(".email-list"),$("#email-add").val(""),a.modal("show")}function o(t){var n=t.responseJSON.address||"Error adding email";new e.Notification(".email-list").error(n)}return $("#email-add").val()?void e.client.addEmail(t.action,t.serialized).done(i).fail(o).always(n):(new e.Notification(".add-email-error").error("Email address must not be blank."),n())})}};return i}(Mashape)}.call(this),function(){var e=$(document),t=Mashape.Section({ScrollViews:[],namespace:".add-new-api",elements:Mashape.Elements({form:".create-api-form",toggleForm:".add-new-api .toggle-form",fieldsets:".add-new-api fieldset",formAction:'.add-new-api input[name="action"]',fileFormatDropdown:"#file-format",toggleImportBtn:".btn-import-docs",shownOnImport:'.add-new-api .form-group[for="file"]',hiddenOnImport:'.add-new-api .form-group[for="address"], .or'}),routing:function(e){this.scope("/api/new",function(){this.base(e(),t.page())})},page:function(e){return function(n){n.params.page=e,Mashape.Router.Partial(n,{},function(){t.initialize(n)})}},initialize:function(){Mashape.Router.$loading=".add-new-api",Mashape.Router.teardown=t.teardown,t.helpers.setupForm(),t.actions.view()},teardown:function(){e.off(t.namespace);for(var n in t.ScrollViews)t.ScrollViews[n].teardown();t.ScrollViews=[]},helpers:{setupForm:function(){var e=new Mashape.FormComponent(t.elements.form,{handleButtonState:!1}).on("submit",function(e,t){e.button.disable(e.original.currentTarget.name),Mashape.user?Mashape.client.createApi(Mashape.user.slug,e.form.get(0)).always(t):Mashape.client.registerApi(e.serialized,e.form.get(0)).always(t)}).on("error",function(t,n,a){a.button.enable(a.original.currentTarget.name),e.handleErrors(t,n,null)}).on("success",function(e){window.location=e.url}),n=query.parse();"undefined"!=typeof n&&(window.history.replaceState&&window.history.replaceState(null,null,window.location.href.split("?")[0]),e.handleErrors(n,{isError:function(){return!0}}),"undefined"!=typeof n.file&&t.actions.toggleImport())}},actions:{view:function(){Mashape.selector({element:t.elements.fileFormatDropdown,showTick:!0,on:{change:function(){}}}),$(t.elements.toggleImportBtn).on("click",function(e){e.preventDefault(),e.stopPropagation(),t.actions.toggleImport()}),$(t.elements.toggleForm).on("click",function(e){e.preventDefault();var n=$(this).attr("href");$(t.elements.toggleForm).removeClass("active").filter(this).addClass("active"),$(t.elements.fieldsets).attr("disabled",!0).filter(n).removeAttr("disabled"),$(t.elements.formAction).val(n.substring(1))})},toggleImport:function(){$(t.elements.toggleImportBtn).toggleClass("active"),$(t.elements.form).find('.form-group[for="apiName"] label span').toggleClass("hide"),$(t.elements.shownOnImport).slideToggle(150),$(t.elements.hiddenOnImport).slideToggle(150)}}})}.call(this),function(){Mashape.Router(function(){this.scope("/:account/applications/:application",function(){var e=new Mashape.Application,t=e.loadPartial.bind(e);this.base(t),this.get("/charts",t),this.get("/charts/",t),this.get("/charts/:chart",t),this.get("/apis/:account/:api",t),this.get("/:page",t),this.get("/:settings/:page",t)})}),Mashape.Application=function(e){var t=$(document),n="analytics",a={OVERVIEW:"overview",QUOTAS:"quotas",REQUEST_SIZE:"request_size",RESPONSE_SIZE:"response_size",ERRORS:"errors",CLIENT_ERRORS:"client_errors",SERVER_ERRORS:"server_errors",LATENCY:"latency",API_LATENCY:"api_latency",REQUESTS:"requests",BANDWIDTH:"bandwidth"},i={container:".page-content",subscriptions:".row .subscriptions",apis:".app .apis.consumed",search:".application .search input",noApis:".no-apis[data-template]",loader:".loader-page",switcher:{environment:".environment-toggle select",timeframe:".date-range select",environmentKey:".key-block .key-environment select",type:".chart-type select"},logo:{form:".upload-logo form",none:" .logo-wrapper .upload-icon",image:" .logo-wrapper .image-upload"},graphs:{overview:".graph",bar:".graph.bar"},keyModal:{keyInput:".key-block .key input",footer:".key-footer",older:".key-footer .show-older",copy:".key-block .clipboard-tool"},quotas:'.subscriptions [data-name="{{api}}"][data-owner="{{account}}"] .panel-footer .quotas'},o=function(){return this};return o.prototype.loadPartial=function(t){function a(){i.initialize(t)}var i=this;t.params.page||(t.params.page=n),e.Router.Partial(t,{},a)},o.prototype.initialize=function(t){var n=t.params,i=this;o.active=!0,e.Router.teardown=i.teardown;var r=e.client.fetchApplication(n.account,n.application);r.done(function(o){i.data=o,i.findEnvironmentNameById(e.Store(i.data.id+".analytics.environment").get())||e.Store(i.data.id+".analytics.environment",{cache:"forever",data:e.CONSTANTS.DEFAULT_ENVIRONMENT}),i.data.graph={type:n.chart||a.OVERVIEW,precision:e.Store(i.data.id+".precision",{cache:"forever",defaultValue:e.CONSTANTS.DEFAULT_PRECISION}).get(),environment:e.Store(i.data.id+".analytics.environment",{cache:"forever",defaultValue:e.CONSTANTS.DEFAULT_ENVIRONMENT}).get()},i.initializeFormHandlers(),i.initializeEnvironmentKeystore(),i.pageSpecific(t)}),r.fail(function(e){console.error("Unable to load application data")})},o.prototype.teardown=function(){t.off(".application"),o.active=!1},o.prototype.pageSpecific=function(e){var t=e.params.page;if(this.highlightSidebarLink(e),e.params.api)return this.drillDownAnalytics(e);switch(t){case"analytics":this.overviewAnalytics(t);break;case"settings":this.settings(t);break;default:this.overviewAnalytics(t)}},o.prototype.overviewAnalytics=function(){var n=$(i.subscriptions),a=$(i.loader),o=this;new e.Filters({parent:".subscriptions",filterables:".consumed.api",searchInput:i.search,searchFilter:"search",buttonInput:".filters.availability"},function(){}),e.utils.each(this.data.apis,function(e){n.prepend(o.createApiBlock(e))}),this.initAnalyticsEnvironment(function(){o.initializeGraphing()}),this.initDatePicker(function(){o.initializeGraphing()}),this.initializeGraphing(),a.fadeOut(function(){a.remove()}),t.on("click.application",".consumed.api",function(e){e.preventDefault(),e.stopPropagation();var t=$(e.target).attr("href")?$(e.target).attr("href"):$(this).find("a.name").attr("href");e.ctrlKey||e.metaKey?window.open(t,"_blank"):window.location=t}),$("a[data-chart]").on("click.application",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).data("chart");o.data.graph.type=t,o.initializeGraphing(),o.highlightSidebarLink({params:{page:"analytics",chart:t}})})},o.prototype.setupEnvironmentOptions=function(){function e(e){if(e.length)for(var t in a.data.environments)e.append('<option value="'+t+'">'+t+"</option>")}var t=$(i.switcher.environment),n=$(i.switcher.environmentKey),a=this;e(t),e(n)},o.prototype.createApiBlock=function(t){var n=$(".api[data-template]").clone();return n.attr("data-filter",(t.api.up,"currently-up")),n.attr("data-name",t.api.name),n.attr("data-owner",t.api.account.name),n.attr("data-search",t.api.account.name+" / "+t.api.name),n.find(".status").text((t.api.up,"")),n.find(".logo img").attr("src",e.Cards.Api.link(t.api)+"/logo"),n.find(".meta .drilldown").attr("href",e.Cards.Application.link(t,t.api)),n.find(".meta .name").attr("href",e.Cards.Api.link(t.api)),n.find(".meta .name h1").text(t.api.name),n.find(".meta .account-name").attr("href","/"+t.api.account.slugifiedPrimary||t.api.account.name),n.find(".meta .account-name h4").text(t.api.account.name),n.removeAttr("data-template"),n},o.prototype.settings=function(){var t,n,a=new e.FormComponent(".basic"),i=this;a.on("submit",function(a,o){t=a.serialized,n=new e.client.updateApplication(i.data.account.name,i.data.name,a.serialized),n.always(o)}),a.on("success",function(e,n){if(t.name!==i.data.name){var a="/"+i.data.account.name+"/applications/";$(".apps.dropdown").find('[data-id="'+i.data.id+'"] a').text(t.name).attr("href",a+t.name),i.data.name=t.name,$("#delete-modal").find(".delete-app-name").text(i.data.name),Davis.redirect(a+e.name+"/settings")}}),e.confirm({id:"delete-modal",confirmEntity:"application",confirmValue:i.data.name,confirm:"Yes, delete this Application",message:'<p>This action <strong>CANNOT</strong> be undone. This will permanently delete the  <strong class="delete-app-name">'+i.data.name+"</strong> application.</p>",submit:function(t,n){function a(){t.button.enable()}function o(){window.location="/dashboard"}t.button.disable(),e.client.deleteApplication(i.data.account.name,i.data.name).fail(a).done(o).always(n)}})},o.prototype.initializeFormHandlers=function(){var t=this,n=$(e.CONSTANTS.SIDEBAR_ID+i.logo.image),a=$(e.CONSTANTS.SIDEBAR_ID+i.logo.none);e.initializeLogoUpload(i.logo.form,{namespace:".application",onPatch:function(){return e.api.patch({url:t.data.links.self.href,data:{haslogo:!0}})},onSuccess:function(e){t.data.haslogo=!0,a.length&&!a.hasClass("hidden")&&(a.addClass("hidden"),n.removeClass("hidden")),n.find("img").attr("src",e.results.medium[0].ssl_url)}})},o.prototype.highlightSidebarLink=function(t){var n,a=$(e.CONSTANTS.SIDEBAR_ID+' li a[href^="/"]').removeClass("active"),i=t.params.chart||"overview";n=t.params.api?a.filter('[data-name="'+t.params.api+'"][data-account="'+t.params.account+'"]'):"analytics"!==t.params.page?a.filter("."+t.params.page):a.filter('[data-chart="'+i+'"]'),n.addClass("active")},o.prototype.renderQuotaProgressBars=function(t){var n,a,o,r=this.data.graph;o={application:this.data.id,account:this.data.account.name,api:t.api.id,precision:r.precision,environment:r.environment},a=$(e.utils.format(i.quotas,{api:t.api.name,account:t.api.account.name})).empty(),n=e.client.fetchAnalytics("application-api",o.application,o.api,"overview",o.environment,o.precision),n.done(function(e,t,n){for(var i=0;i<e.length;i++){var o=$('[data-template="quota"]').clone(),r=e[i];o.removeClass(".template").removeAttr("data-template"),o.attr("data-quota-id",r.id),o.find(".progress-label").text(r.name),a.append(o)}}),n.fail(function(e,t){})},o.prototype.renderGenericGraphs=function(t){var n=this.data;new e.Graph.Generic(t.el,{chart:{height:150}}).renderApplicationApiGraph({application:n.id,api:t.api,type:t.type,environment:t.environment,precision:n.graph.precision})},o.prototype.renderQuotaGraphs=function(t){var n=this.data;new e.Graph.Generic(t.el,{chart:{height:150}}).renderApplicationApiQuotaGraph({account:n.account.id,application:n.id,api:t.api,precision:n.graph.precision})},o.prototype.renderOverviewGraphs=function(t){var n=this.data;new e.Graph.Overview(t.el,{chart:{height:150}}).renderApplicationApiGraph({account:n.account.name,application:n.id,api:t.api,environment:n.graph.environment,precision:n.graph.precision})},o.prototype.initializeGraphing=function(){function t(e,t){var i,o=e.api;switch(i=['.subscriptions [data-name="',o.name,'"][data-owner="',o.account.name,'"] .panel-body .graph'].join(""),n.data.graph.type.toLowerCase()){case a.QUOTAS:n.renderQuotaGraphs({api:e.api.id,el:i});break;case a.REQUESTS:case a.ERRORS:case a.LATENCY:case a.REQUEST_SIZE:case a.RESPONSE_SIZE:case a.API_LATENCY:case a.BANDWIDTH:n.renderGenericGraphs({api:e.api.id,type:n.data.graph.type,environment:"all",el:i});break;case a.OVERVIEW:n.renderOverviewGraphs({api:e.api.id,el:i})}}var n=this;return n.data&&n.data.graph&&n.data.apis&&n.data.apis.length?e.utils.each(n.data.apis,t):void $(".consumed .graph").each(function(t,n){new e.Graph(this).empty()})},o.prototype.initializeEnvironmentKeystore=function(){function t(t,n){var a,i,r=$(".key-footer .footer-notes p"),s=$(".key-footer .old-keys");s.empty(),r.find(".expiring-key-count").text(n.length),r.find(".environment").text(t),n=e.utils.sortBy(n,"resetdate"),n.reverse();for(var l=0;l<n.length;l++)a=$('[data-template="old-keys"]').clone(),i=n[l],a.removeClass("template"),a.removeAttr("data-template"),a.addClass("older-key"),a.attr("data-key",i.key),a.attr("data-environment",t),a.find("time").text(moment(i.resetdate).format("lll")),a.find("input").val(i.key),a.find(".btn").on("click",o),a.appendTo(s)}function n(e){if(!e)return!1;var n,a,o=r.data.environments[e],s=$(i.keyModal.keyInput),l=$(i.keyModal.footer),c=$(i.keyModal.older),p=$(i.keyModal.copy);return p.attr("data-clipboard-text",o.key),s.attr("data-environment",e),s.val(o.key),c.off("click"),a=p.text(),n=new ZeroClipboard(p),n.on("ready",function(){n.on("aftercopy",function(e){p.text("Copied!"),setTimeout(function(){p.text(a)},500)})}),o.oldKeys.length<1?l.fadeOut():(l.fadeIn(),c.on("click",function(e){var t=$(".key-footer .old-keys");t.toggle()}),t(e,o.oldKeys)),s}function a(t){var a=$(this),o=$(".regeneration .dropdown-toggle"),s=$(".key-block .fa-spinner"),l=$(i.keyModal.keyInput),c=a.data("option"),p=l.val();l.val(""),s.fadeIn(),o.attr("disabled","disabled"),o.find(".text").text("Generating");var u=e.client.regenerateApplicationKey(r.data.account.name,r.data.name,p,{method:c});u.done(function(e,t,a){var i=r.data.environments[e.name];"regenerate-and-block"!==c&&r.data.environments[e.name].oldKeys.push({id:i.id,key:i.key,resetdate:Date.now()}),r.data.environments[e.name].id=e.id,r.data.environments[e.name].key=e.key,n(e.name),s.fadeOut(function(){o.removeAttr("disabled"),o.find(".text").text("Regenerate")})}),u.fail(function(e,t){})}function o(t){t.preventDefault(),t.stopPropagation();var a=$(this),i=a.parent(".older-key"),o=i.data("environment"),s=i.data("key");a.attr("disabled","disabled"),a.find(".text").text(""),a.find(".fa-spinner").fadeIn();var l=e.client.blockApplicationKey(r.data.account.name,r.data.name,s);l.done(function(e,t,a){for(var i,l=r.data.environments[o],c=0;c<l.oldKeys.length;c++)if(i=l.oldKeys[c],i&&i.key===s){r.data.environments[o].oldKeys.splice(c,1);break}n(o)}),l.fail(function(e,t){})}var r=this,s=r.data.environments,l=r.data.graph.environment===e.CONSTANTS.DEFAULT_ENVIRONMENT?Object.keys(s)[0]:r.findEnvironmentNameById(r.data.graph.environment);l=l||Object.keys(s)[0],r.setupEnvironmentOptions(),n(l),$(document).on("click",".regeneration .dropdown-menu a",a),e.selector({element:i.switcher.environmentKey,selected:l,on:{change:function(){n(this.value)}}})},o.prototype.initAnalyticsEnvironment=function(t){var n=this;e.selector({add:"create-environment",element:i.switcher.environment,selected:n.data.graph.environment,showTick:!0,on:{add:function(){console.log("attempted to add new environment!")},change:function(){var a=n.data.environments[this.value];a&&a.key&&(n.data.graph.environment=a.key,$(i.switcher.environmentKey).selectpicker("val",this.value),$(i.switcher.environmentKey).selectpicker("render"),e.Store(n.data.id+".analytics.environment",{cache:"forever",data:n.data.graph.environment}),"function"==typeof t&&t.call(this))}}})},o.prototype.initDatePicker=function(t){var n=this;e.selector({element:i.switcher.timeframe,selected:n.data.graph.precision,showTick:!0,width:140,on:{change:function(){n.data.graph.precision=this.value||e.CONSTANTS.DEFAULT_PRECISION,e.Store(n.data.id+".precision",{cache:"forever",data:n.data.graph.precision}),"function"==typeof t&&t.call(this)}}})},o.prototype.findEnvironmentNameById=function(e){for(var t in this.data.environments){var n=this.data.environments[t];if(n.id===e)return t}return!1},o}(Mashape)}.call(this),function(){var e=$(window),t=$(document),n=Mashape.Section({CacheLength:.3,routing:function(e){this.scope("/dashboard",function(){this.base(Mashape.Dashboard.loadPartial()),this.get("/subscriptions",e("subscriptions",{forceReload:!0}),Mashape.Dashboard.initialize),this.get("/:page",e(),Mashape.Dashboard.initialize),this.get("/following/:subject",Mashape.Dashboard.loadPartial("following"))})},loadPartial:function(e){return function(t){function a(){n.initialize(t)}t.params.page=e||t.params.page,Mashape.Router.Partial(t,{},a)}},initialize:function(e){var t,a;a=e.params.page||"applications",Mashape.Router.teardown=n.teardown,"function"==typeof n.routes[a]&&(t=n.routes[a])(e)},helpers:{getDefaultDashboardTab:function(){var e=Mashape.Store("dashboard.defaultTab");return e?e.get():null},setDefaultDashboardTab:function(e){Mashape.Store("dashboard.defaultTab",{cache:n.CacheLength}).set(e)},getPrecision:function(e){return Mashape.Store("dashboard."+e+".precision",{cache:"forever",defaultValue:Mashape.CONSTANTS.DEFAULT_PRECISION}).get()},setPrecision:function(e,t){return Mashape.Store("dashboard."+e+".precision",{cache:"forever"}).set(t||Mashape.CONSTANTS.DEFAULT_PRECISION)},getBlockElements:function(e){var t=$(".blocks ."+e);return{base:t,loader:$(".blocks ."+e+" > .loader"),container:t.find(".inner-container")}},sortApis:function(e){return e},sortApplications:function(e){return e.sort(function(e,t){var n=e.apis&&e.apis.data?e.apis.data.length:0,a=t.apis&&t.apis.data?t.apis.data.length:0;return n>a})},fetchBlockData:function(e,t){var n="apps"===e?"fetchApplications":"fetchApis",a=Mashape.user;return Mashape.client[n](a.name).done(function(e,n,a){t(e.data)})},appendBlocks:function(e,t){function a(e){return t(e,r)}var i,o=n.helpers.getBlockElements(e),r=[],s=function(e,t){return function(n){var a;return e.events&&(n.events=e.events),a=new Mashape.Cards[e.type](n),r.push(a),o.container.prepend(a.$el),"function"==typeof t?t():void 0}},l=function(){n.helpers.fetchBlockData(e,c)},c=function(t){var i,o={type:"apps"===e?"Application":"Api"};return t&&t.length?("apps"===e?t=n.helpers.sortApplications(t):(t=n.helpers.sortApis(t),o.events={click:function(e){var t=$($(e.toElement).parents(".panel.api")[0]),n=t.find('[data-link="true"]').attr("href")+"/admin";e.ctrlKey||e.metaKey?window.open(n,"_blank"):window.location=n}}),i=Mashape.utils.after(t.length,function(){return a(t)}),Mashape.utils.each(t,s(o,i))):a()};o.container.hide(),o.loader.show(),i=Mashape.Cards["apps"===e?"Application":"Api"],Mashape.template(i.template,l)},setupBlockContainer:function(e){n.helpers.appendBlocks(e,function(t,a){var i,o=n.helpers.getPrecision(e),r=n.helpers.getBlockElements(e);if(n.type!==e)return r.container.hide();var s={gutter:10,columnWidth:10,isLayoutInstant:!0,itemSelector:".block"};$("div.stats > span").popover(),$('[data-toggle="tooltip"]').tooltip(),r.loader.hide(),i=r.container,i.show(),i.find(".add-container").show(),Mashape.Dashboard.Packery=i.packery(s),Mashape.selector({element:".date-range select",selected:o,showTick:!0,width:130,on:{change:function(){var t=this.value||Mashape.CONSTANTS.DEFAULT_PRECISION;Mashape.log.info(t,a),n.helpers.setPrecision(e,t),a&&a.length&&Mashape.utils.each(a,function(e,n){e.ractive.set("graph.precision",t),"function"==typeof e.renderApiGraphs?e.renderApiGraphs():"function"==typeof e.graph&&e.graph()})}}})}),$(document).on("click.dashboard",".blocks .block.panel",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).find('[data-link="true"]').attr("href");e.ctrlKey||e.metaKey?window.open(t,"_blank"):window.location=t})}},routes:{
follow:function(e){},apis:function(e){n.type="apis",n.helpers.setupBlockContainer(n.type)},applications:function(e){n.type="apps",n.helpers.setupBlockContainer(n.type)},subscriptions:function(e){$("#subscriptions").dataTable({processing:!0,serverSide:!1,bLengthChange:!1,pageLength:20,bFilter:!1,lengthMenu:[],pagingType:"simple",ajax:{url:"/api/internal/subscriptions"},columns:[{data:{_:"api",filter:"api.name"},render:function(e,t,n){return['<a href="',e.accountLink,'">',e.account,'</a> / <a href="',e.apiLink,'">',e.name,"</a>"].join("")}},{data:"name"},{data:{_:"api",filter:"name"},render:function(e,t,n){return'<a href="'+e.apiLink+'/pricing" class="btn btn-success">View Pricing</a>'}}]})}},teardown:function(){n.active=!1,n.Packery&&(n.Packery.packery("destroy"),n.Packery=null),t.off(".dashboard"),e.off(".dashboard"),$("[data-filter-button]").removeClass("active"),$(".dashboard").empty()}});Mashape.Dashboard=n}.call(this),function(){var e=$(document),t=$(window),n=Mashape.Section({routing:function(e){this.priority(this.priority.low).scope("/:account/:api/admin",function(){this.base(e(),n.init()),this.get("/invite",e(),n.init()),this.get("/general",e(),n.init("general")),this.get("/network",e(),n.init("network")),this.get("/transformations",e(),n.init("transformations")),this.get("/payments",e(),n.init("payments")),this.get("/payments/:transaction",e(),n.init("payments")),this.get("/embed",e(),n.init("embed"))})},elements:Mashape.Elements({header:".header",container:{sidebar:".admin .sidebar",content:".admin .inner-content"},profile:{header:".profile .head",tabs:".profile .tabs"},overview:{graph:".analytics-chart .graph-container"},developers:{selectors:{sortBy:".filter.bar .sort-by select",orderBy:".filter.bar .order-by select"},type:".type",block:".block-developer",unblock:".unblock-developer"},network:{notification:".network-settings .alert",form:".network-settings",selector:".domain-container select",domainSelector:".public-dns .bootstrap-select",domainInputGroup:".public-dns .input-group",domainInputGroupCancel:".public-dns .cancel-button",documentationButtons:".panel-footer .buttons",steps:{container:".steps",one:".steps > .one",two:".steps > .two",three:".steps > .three"}},embed:{container:".api-share-content",settings:{logoType:"#badge-logo-type",colorScheme:"#badge-color-scheme"},preview:".api-share-preview-block",template:"#api-share-preview-template",code:".api-share-code",toggleBg:".api-share .toggle-background",textarea:{badge:".api-share-badge-code",docs:".api-share-docs-code"},copy:".api-share-copy"}}),init:function(e){return e=e||"overview",function(t){return n.autofix(),Mashape.Documentation.setupEvents(),n.data={account:new Mashape.User,api:Mashape.Store("api").get(),version:Mashape.Store("api.version").get()},n.elements.container.$sidebar.find(".active").removeClass("active"),n.elements.container.$sidebar.find('[data-tab="'+e+'"]').addClass("active"),-1!==t.path.indexOf("/invite")&&$("#invite").modal("show"),n[e[0].toUpperCase()+e.substring(1,e.length)+"Route"].call(n,t)}},OverviewRoute:function(){this.initializeViewHandler(),this.initializeTimeframeHandler(),this.initializeBlockEvents(),this.renderOverviewGraph(),this.renderDeveloperGraphs(".developer-list .developer")},NetworkRoute:function(){this.initializeDomainSelector(),this.initializeNetworkFormHandler(),$(".firewall-ip-link").click(function(e){e.preventDefault(),e.stopPropagation(),window.open($(this).attr("href"),"_blank")})},GeneralRoute:function(){function e(e){return e.name}var t=Mashape.Store("api.version").get(),a=Mashape.Store("api.categories").get(),i=[],o=".general-settings",r=$("#visibility"),s=n.elements.profile.$header.find(".details");for(var l in t.tags.data){var c=t.tags.data[l].tag;i.push({id:c.id,name:c.name})}$('.settings [name="tags"]').select2({data:{results:a,text:"name"},maximumSelectionSize:2,multiple:!0,placeholder:"Select up to two categories describing your API",initSelection:function(e,t){t(i)},formatSelection:e,formatResult:e}).select2("val",[]),new Mashape.FormComponent(".visibility",{namespace:".documentation-admin",autosave:!0}).on("submit",function(e,n){function a(){Mashape.api.patch({url:t.api.links.self.href,data:{visibility:m},eventName:"Set visibility: "+m,apiName:t.api.name,apiSlugified:t.api.slugifiedPrimary,apiAccount:t.api.account.name}).done(function(t){"public"===t.visibility.toLowerCase()&&h.modal("show"),s.toggleClass("private",!e.serialized.visibility).toggleClass("public",e.serialized.visibility).find("h1").attr("title","This API is "+(e.serialized.visibility?"public":"private")),Mashape.utils.setupHeaderApisDropdown()}).fail(function(){i()}).always(function(){o(),n()})}function i(){var t=r.prop("checked");r.prop("checked",!t),e.indicator.success.remove(),e.indicator.error.remove(),e.indicator.spinner.remove()}function o(){v.off("click"),g.off("click")}var l={logo:"undefined"!=typeof t.haslogo,targeturl:"undefined"!=typeof t.astronode.targeturl,description:"undefined"!=typeof t.description,documentation:t.links&&t.links.endpoints?t.links.endpoints.total>0:!0},c=!0,p=$("#change-api-visibility"),u=$("#change-api-visibility-private"),d=$("#cannot-change-api-visibility"),h=$("#share-public-api");d.find(".missing .help-block").addClass("hidden"),_.each(l,function(e,t){e||(d.find('[data-missing="'+t+'"]').removeClass("hidden"),c=!1)});var f=e.serialized.visibility?p:u;e.serialized.visibility&&!c&&(f=d);var m=e.serialized.visibility?Mashape.CONSTANTS.STATE_PUBLISHED:Mashape.CONSTANTS.STATE_DRAFT,g=f.find(".cancel"),v=f.find(".submit");h.on("shown.bs.modal",function(){twttr.widgets.load()}),f.modal("show");var y=!1;f.find(".submit").on("click.documentation-admin",function(){y=!0,a(),f.modal("hide")}),f.find(".cancel").on("click.documentation-admin",function(){f.modal("hide")}),f.off("hidden.bs.modal").on("hidden.bs.modal",function(){o(),y||i(),y=!1})}),n.GeneralSettings=new Mashape.FormComponent(o,{namespace:".documentation-admin"}).on("submit",function(e,n){function a(a){async.parallel({updateName:function(n){return a?void Mashape.api.patch({url:t.api.links.self.href,data:{name:e.serialized.name}}).done(function(){Mashape.Store("apis").clear(),$("#delete-modal").find(".delete-api-name").text(e.serialized.name),s=["",t.api.account.name,e.serialized.name,"admin/general"].join("/")}).always(Mashape.utils.asyncAlways(n)):n()},updateVersion:function(n){return t.description===e.serialized.description&&t.website===e.serialized.website?n():void Mashape.api.patch({url:t.links.self.href,data:{website:e.serialized.website,description:e.serialized.description}}).done(function(e){t.website=e.website,t.description=e.description}).always(Mashape.utils.asyncAlways(n))},updateTags:function(e){async.series({deleteTags:function(e){async.each(t.tags.data,function(e,t){Mashape.api["delete"]({url:e.links.self.href}).always(Mashape.utils.asyncAlways(t))},function(n){return n?e(n):(t.tags.data=[],e())})},createTags:function(e){async.each(r,function(e,n){Mashape.api.post({url:t.links.tags.href,data:{tag:e}}).done(function(e){t.tags.data.push(e)}).always(Mashape.utils.asyncAlways(n))},e)}},e)}},function(e,t){return e||new Mashape.Notification(o).success("Successfully updated settings"),!e&&s?window.location=s:n(e,t)})}var i,r=""!==e.serialized.tags?e.serialized.tags.split(","):[],s=!1;return this.clearErrors(),e.serialized.website&&(/^https?:\/\//.test(e.serialized.website)||(i={website:"URL should begin with http:// or https://"}),/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,24}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/i.test(e.serialized.website)||(i={website:"URL is invalid"})),i?n({getResponse:function(){return i}}):"PUBLIC"===t.api.visibility&&""===e.serialized.description?(e.button.enable(),Mashape.alert({title:"Your API is public.",message:"Public APIs must have a description. To remove it, first make your API private."})):t.api.name!==e.serialized.name?Mashape.prompt("Are you sure you want to change the name of your api to "+e.serialized.name+"?</p><p>By doing so, you should update any existing links to your API.",function(e){return e?void a(!0):n()}):void a(!1)}).on("error",function(e){new Mashape.Notification(o).error(e.message||"Failed to update settings")}),Mashape.confirm({id:"transfer-modal",confirmEntity:"API",confirmValue:t.api.name,confirm:"Yes, transfer this API",message:'<div class="has-error"><p class="help-block"></p></div><p>Type the username of the account you want to transfer this API to:</p><div class="form-group"><input type="text" name="account" spellcheck="false" autocomplete="off"></input></div>',submit:function(e){var n=this;e.button.disable(),async.waterfall([function(t){Mashape.client.fetchAccount(e.serialized.account).fail(function(t){var a=n.$confirmModal.find(".help-block");e.button.enable(),404===t.status&&a.html("No user found for this username.")}).done(function(e){return t(null,e.id)})},function(a,i){Mashape.api.patch({url:t.api.links.self.href,data:{account:a}}).fail(function(t){var a=n.$confirmModal.find(".help-block");e.button.enable(),409===t.status&&a.html("User already has an api with that name.")}).done(Mashape.utils.asyncAlways(i))}],function(t){return t?(e.button.enable(),console.error(t)):void(window.location="/")})}}),Mashape.confirm({id:"delete-modal",confirmEntity:"API",confirmValue:t.api.name,confirm:"Yes, delete this API",message:'<p>This action <strong>CANNOT</strong> be undone. This will permanently delete the  <strong class="delete-api-name">'+n.data.api.name+'</strong> API.</p><p>You will permanently lose:</p><ul class="text-danger"><li>Your API users & customers</li><li>Your API data & analytics</li><li>Your API documentation</li></ul> ',submit:function(e,n){e.button.disable(),Mashape.utils.ajax({method:"DELETE",url:t.api.links.self.href}).fail(function(){e.button.enable()}).done(function(){Mashape.Store("apis").clear(),window.location="/dashboard"}).always(n)}})},TransformationsRoute:function(t){function n(e){return function(t,n){var a=t.form,o=a.find(".form-group");o.each(function(){var t,n,a,o,r=$(this),s=r.find('[name="key"]'),l=r.find('[name="value"]'),c=r.data("id"),p=s.val(),u=l.val(),d="none"===r.css("display");return r.find(".has-error").removeClass("has-error"),d?c?Mashape.api["delete"]({url:i[e].href+c}).done(function(){r.remove()}).fail(function(){console.error("Could not remove",e,c)}):r.remove():void((p||u)&&(c?(n=i[e].href+c,t="patch"):(n=i[e].href,t="post"),a=Mashape.api[t]({url:n,data:{name:p,value:u}}),a.done(function(e){c||r.data("id",e.id)}),a.fail(function(e){var t=e.responseJSON;t&&(o=!0,t.name&&s.parent().addClass("has-error"),t.value&&l.parent().addClass("has-error"))})))}),new Mashape.Notification(".panel-notifications").success("Successfully updated settings"),this.button.enable()}}var a=Mashape.Store("api.version").get(),i=a.node.links,o=function(){return $(".customForm .template .form-group").clone()[0]};e.on("click.documentation-admin",".btn.add.field",function(e){var t;t=$(this),t.parents(".customForm").find("form ul").append(o()),setTimeout(function(){t.parents(".transforms.api").css("max-height",t.parents(".transforms.api").height()+100)},20)}),e.on("click.documentation-admin","form span.remove",function(){$(this).parent().hide()}),$(".headers ul").append(o());var r=new Mashape.FormComponent(".headers",{namespace:".documentation-admin",data:!0});r.on("submit",n("headers")),$(".parameters ul").append(o());var s=new Mashape.FormComponent(".parameters",{namespace:".documentation-admin"});s.on("submit",n("parameters"))},PaymentsRoute:function(e){"use strict";var t=$('[data-template="history-table-template"]');e.params.apiId=n.data.api.id,Mashape.Transactions.init({request:e,template:t.html()})},EmbedRoute:function(){new ZeroClipboard($(n.elements.embed.copy)).on("copy",function(e){var t=$(e.target).data("copy");switch(t){case"badge":return this.setText($(n.elements.embed.textarea.badge).val());case"docs":return this.setText($(n.elements.embed.textarea.docs).val())}}),$(n.elements.embed.copy).on("mouseover",function(){$(this).tooltip("show")}).on("mouseleave",function(){$(this).tooltip("hide")}).tooltip({trigger:"manual",container:"body"});var e=new Ractive({el:n.elements.embed.preview,template:n.elements.embed.template,data:{logoType:"icon",colorScheme:"light",width:143}}),t=function a(){return $(n.elements.embed.textarea.badge).html($(n.elements.embed.preview).html()),a}();$(n.elements.embed.code).on("click",function(){$(this).select()}),$(n.elements.embed.toggleBg).on("click",function(){$(n.elements.embed.container).toggleClass("dark")}),Mashape.selector({showTick:!0,element:n.elements.embed.settings.logoType,width:"100%",on:{change:function(){e.set({width:"text"===this.value?200:143,logoType:this.value}),t()}}}),Mashape.selector({showTick:!0,element:n.elements.embed.settings.colorScheme,width:"100%",on:{change:function(){e.set("colorScheme",this.value),t()}}})},autofix:function(){function e(){a=t.scrollTop(),o=c.outerHeight(),i=s.outerHeight(),r=p.outerHeight(),a>=i?(l.css("top",o+r),p.addClass(d).css("top",o).css("left",0).css("right",0),u.css("margin-top",o)):(l.css("top",i+o+r-Math.max(a,0)),p.removeClass(d).css("top",0),u.css("margin-top",0))}var a,i,o,r,s=n.elements.profile.$header,l=n.elements.container.$sidebar,c=n.elements.$header,p=n.elements.profile.$tabs,u=n.elements.container.$content,d="fixed";return t.on("scroll.profile-admin",e),e()},initializeBlockEvents:function(){var e=n.data.api.owner.name,t=n.data.api.name;$(".developer-list").on("click",".block-developer a, .unblock-developer a",function(a){var i=$(this),o=i.parent(),r=o.data("block"),s=$(i.parents(".developer")[0]),l=s.data(),c=Mashape.client.updateApiDeveloper(e,t,l.id,{blocked:r});c.fail(function(){}),c.done(function(){var e=s.find(n.elements.developers.type),t=s.find(n.elements.developers.block),a=s.find(n.elements.developers.unblock);return e.toggleClass("blocked",r),r?(t.hide(),a.show(),e.data("type",e.text()),void e.text("Blocked")):(t.show(),a.hide(),void e.text(e.data("type")))})})},initializeTimeframeHandler:function(){n.data.precision=Mashape.Store(n.data.api.id+".precision",{cache:"forever",defaultValue:"hours"}).get(),$(".timeframe select").each(function(){Mashape.selector({showTick:!0,selected:n.data.precision,element:this,width:165,on:{change:function(e){var t=$(e.target).data();switch(t.store&&(n.data.precision=this.value,Mashape.Store(n.data.api.id+".precision",{cache:"forever",data:this.value})),t.target){case"overview":n.renderOverviewGraph(),n.resetDeveloperTimeframe(".developer-list .developer",this.value);break;case"developer":n.renderDeveloperGraphs(".developer-list .developer[data-id="+t.id+"]")}}}})})},initializeViewHandler:function(){n.data.view=Mashape.Store(n.data.api.id+".view",{cache:"forever",defaultValue:"overview"}).get(),$(".analytics-view select").each(function(){Mashape.selector({showTick:!0,selected:n.data.view,element:this,width:165,on:{change:function(e){var t=$(e.target).data();switch(t.store&&(n.data.view=this.value,Mashape.Store(n.data.api.id+".view",{cache:"forever",data:this.value})),t.target){case"overview":n.renderOverviewGraph(),n.resetDeveloperView(".developer-list .developer",this.value);break;case"developer":n.renderDeveloperGraphs(".developer-list .developer[data-id="+t.id+"]")}}}})})},initializeDomainSelector:function(){var e=n.elements.network.$selector;Mashape.selector({add:"create-public-dns",element:e,selected:n.data.precision,showTick:!0,on:{add:function(){var e=n.elements.network.$domainInputGroup,t=$(n.elements.network.domainSelector),a=n.elements.network.$domainInputGroupCancel;e.find("input").val(""),e.show(),t.hide(),a.removeClass("hidden"),a.on("click.documentation-admin",function(){a.off("click"),a.addClass("hidden"),e.hide(),t.show()})},change:function(){}}})},initializeNetworkFormHandler:function(){var e=n.elements.network.$domainInputGroupCancel,t=n.elements.network.$documentationButtons,a={messages:{one:"Pinging Target URL",two:"Reading Response Body",three:"Resolving Domain Settings"}};a.one=new Mashape.NetworkStep(n.elements.network.steps.one,a.messages.one),a.two=new Mashape.NetworkStep(n.elements.network.steps.two,a.messages.two),a.three=new Mashape.NetworkStep(n.elements.network.steps.three,a.messages.three),a.message=function(e,t){var i=n.elements.network.$notification;a.timeout&&(clearTimeout(a.timeout),a.timeout=void 0,i.hide()),i.attr("class","alert").addClass("alert-"+e),i.html("<span>"+t+"</span>"),i.fadeIn(),a.timeout=setTimeout(function(){i.fadeOut(),a.timeout=void 0},2500)},a.show=function(){return a.clear(),n.elements.network.steps.$container.fadeIn()},a.hide=function(){return n.elements.network.steps.$container.fadeOut()},a.clear=function(){a.one.clear(),a.two.clear(),a.three.clear()};var i=new Mashape.FormComponent(n.elements.network.form,{namespace:".documentation-admin"});i.on("submit",function(i,o){function r(e,t){return a[e].error(),s.button.enable(),setTimeout(function(){a.hide()},2500),a.message("danger",t)}var s=this,l=n.data.api,c=n.data.version,p=i.serialized,u={};if(t.removeClass("done"),p.targeturl||(u.error={message:"Target Base URL is required."}),p.dnsDropdown||p.dns||(u.error={message:"DNS cannot be empty."}),!p.dnsDropdown||e.hasClass("hidden")||p.dns||(u.error={message:"DNS is required when adding a new DNS."}),(-1===p.targeturl.indexOf("http")||-1===p.targeturl.indexOf("://"))&&(u.error={message:"Target Base URL is invalid."}),u.error)return a.message("danger",u.error.message),s.button.enable();a.show(),a.one.loading();var d=Mashape.client.checkVersionTargeturl(l.owner.name,l.name,c.name,p.targeturl);d.done(function(e){return e.error?r("one","Could not ping the target base url."):(a.one.success(),a.two.loading(),void setTimeout(function(){a.two.success(),a.three.loading();var e=Mashape.client.updateVersionTargeturl(l.owner.name,l.name,c.name,{targeturl:p.targeturl}),i=function(){return r("three","Unable to save public dns, try again.")},o=function(){return a.three.success(),t.addClass("done"),s.button.enable()};e.fail(i),e.done(function(){if(p.dns){var e=Mashape.client.createVersionDomain(l.owner.name,l.name,c.name,{address:p.dns,custom:!1,current:!0});return e.fail(i),void e.done(function(e,t,i){var r;return n.elements.network.$domainInputGroup.hide(),n.elements.network.$domainInputGroupCancel.hasClass("hidden")||(n.elements.network.$domainInputGroupCancel.addClass("hidden"),n.elements.network.$domainInputGroupCancel.off("click")),n.elements.network.$selector.prepend('<option value="'+e.address+'">'+e.address+"</option>"),n.elements.network.$selector.selectpicker("refresh"),n.elements.network.$selector.selectpicker("val",e.address),n.elements.network.$selector.selectpicker("render"),r=$(n.elements.network.domainSelector),r.show(),r.parent().show(),setTimeout(function(){a.hide()},1e3),o(e,t,i)})}var t=Mashape.client.updateVersionDomain(l.owner.name,l.name,c.name,p.dnsDropdown,{current:!0});t.fail(i),t.done(o)})},1500))})}),a.hide()},renderDeveloperGraphs:function(e){$(e).each(function(){var e=$(this),t=e.data(),a=e.find(".graph-container"),i=e.find(".analytics-view select").val(),o=e.find(".timeframe select").val();"overview"===i?new Mashape.Graph.Overview(a,{chart:{height:150}}).renderDeveloperGraph({account:t.id,api:n.data.api.id,precision:o}):"quotas"===i||new Mashape.Graph.Generic(a,{chart:{height:150}}).renderDeveloperGraph({account:t.id,api:n.data.api.id,precision:o,type:i})})},resetDeveloperTimeframe:function(e,t){t=t||n.data.precision,$(e).each(function(){$(this).find(".timeframe select").selectpicker("val",t)})},resetDeveloperView:function(e,t){t=t||n.data.view,$(e).each(function(){$(this).find(".analytics-view select").selectpicker("val",t)})},renderOverviewGraph:function(e){e=e||n.data.view,"overview"===e?new Mashape.Graph.Overview(n.elements.overview.graph,{chart:{height:150}}).renderApiGraph({api:n.data.api.id,precision:n.data.precision}):"quotas"===e||new Mashape.Graph.Generic(n.elements.overview.graph,{chart:{height:150}}).renderApiGraph({type:e,api:n.data.api.id,precision:n.data.precision})},teardown:function(t){n.data=null,e.off(".documentation-admin")}});Mashape.Admin=n}.call(this),function(){var e=$(document),t=$(window),n={AllAnnouncements:!0,Announcement:!0,NewAnnouncement:!1,EditAnnouncement:!1},a="update",i="create",o="delete",r="active",s=".announcements-wrapper",l=Mashape.Section({routing:function(e){this.scope("/:account/:api/announcements",function(){this.base(e(),l.init()),this.get("/new",e({el:s}),l.init("NewAnnouncement")),this.get("/:announcement",e(),l.init("Announcement")),this.get("/:announcement/edit",e({el:s}),l.init("EditAnnouncement"))})},elements:Mashape.Elements({sidebarPageContainer:".side-container",sidebarScrollableArea:".perfectscroll-container",sidebarWrapper:".side-announcements",mainWrapper:s,bottomFooter:".bottom-footer",newForm:"form.new-announcement",formTitle:"#announcement-title",formText:"#announcement-text",sidebarAnnouncements_li:".side-announcement",sidebarAnnouncements:".side-announcement-box",ScrollSpyTarget:".announcements-sidebar",mainAnnouncement:function(e){return"#ann-"+e},sideAnnouncement:function(e){return'.side-announcement[data-index="'+e+'"]'}}),init:function(e){return e=e||"AllAnnouncements",function(t){return Mashape.Documentation.setupEvents(),l.helpers.autofix.call(l),l.data={api:Mashape.Store("api").get(),announcementURL:l.elements.$newForm.data("announcement-url"),baseURL:["",t.params.account,t.params.api,"announcements"].join("/")},l.helpers.useSidebarLinksAsScrollers.call(l,n[e]),l.helpers.enableScrollSpy.call(l,n[e]),l[e+"Page"].call(l,t)}},teardown:function(t){e.off(".documentation")},AllAnnouncementsPage:function(e){this.helpers.initAllAnnouncementsPage.call(l)},AnnouncementPage:function(e){this.helpers.initAllAnnouncementsPage.call(l),this.helpers.scrollToAnnouncement.call(l,e.params.announcement)},NewAnnouncementPage:function(e){this.helpers.initEditor.call(l,e,i)},EditAnnouncementPage:function(e){this.helpers.highlightAnnouncement.call(l,e.params.announcement),this.helpers.initEditor.call(l,e,a)},helpers:{autofix:function(){function e(){this.elements.$sidebarPageContainer.height(t.height()-this.elements.$sidebarPageContainer.offset().top-this.elements.$bottomFooter.height())}this.elements.$sidebarAnnouncements.off("click"),this.elements.$sidebarScrollableArea.perfectScrollbar({wheelSpeed:10}),e.call(l),t.load(e.bind(l)),t.resize(e.bind(l)),this.elements.$mainWrapper.scrollTop(0)},initEditor:function(e,t){var n=this;new Mashape.FormComponent(this.elements.newForm).on("submit",function(a,i){var r=$(a.original.currentTarget).attr("data-action");r===o&&(t=o),n.helpers.handleAction(t,e,{title:n.elements.$formTitle.val(),text:n.elements.$formText.val(),visibility:r}).always(i)}).on("success",function(e){var n=l.data.baseURL;t!==o&&(n+="/"+e.index),window.location=n})},handleAction:function(e,t,n){var r;return e===i?r=Mashape.api.post({url:l.data.api.links.announcements.href,data:n}):e===a?r=Mashape.api.patch({url:l.data.announcementURL,data:n}):e===o&&(r=Mashape.api["delete"]({url:l.data.announcementURL})),r},initAllAnnouncementsPage:function(e){this.elements.$sidebarAnnouncements.click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("data-index");l.helpers.scrollToAnnouncement.call(l,t)})},useSidebarLinksAsScrollers:function(e){this.elements.$sidebarAnnouncements.each(function(t,n){var a=$(this),i=a.attr("data-index");e?a.attr("href","#ann-"+i):a.attr("href",l.data.baseURL+"/"+i)})},scrollToAnnouncement:function(e){var t=$(this.elements.mainAnnouncement(e));this.elements.$mainWrapper.animate({scrollTop:t.position().top+10})},highlightAnnouncement:function(e){var t=$(this.elements.sideAnnouncement(e));this.elements.$sidebarAnnouncements_li.removeClass(r),t.addClass(r)},enableScrollSpy:function(e){this.elements.$mainWrapper.scrollspy({target:e?this.elements.ScrollSpyTarget:""}),this.elements.$mainWrapper.scrollspy("refresh"),this.elements.$sidebarAnnouncements_li.removeClass(r)}}});Mashape.Announcements=l}.call(this),function(){function e(e){var t=$(e.target);return t.hasClass("pricing-dropdown")?!0:t.parents(".pricing-dropdown").length}function t(t,n,a){function i(e){"boolean"==typeof e&&o.data("onClose")(e),s.find(".close").off("click.billing-editor"),o.removeAttr("data-open"),o.off("scroll"),s.fadeOut()}var o=$(t),r=$(t),s=r.find(".pricing-dropdown"),l=$(".pricing-dropdown:visible"),c=l.parent().find("span.fa"),p=l.find(".close");if(!e(n)||$(n.target).hasClass("close")){if(a=a||{},l.length){if(l.is(s))return void i();l.fadeOut(),c.removeAttr("data-open"),p.off("click.billing-editor");var u=c.data("onClose");"function"==typeof u&&(u(),c.data("onClose",null))}o.attr("data-open",!0),s.fadeIn();var d=s.find("input,textarea,select").filter(":visible:first");return d&&d.length&&d.focus(),a.attachClose&&s.find(".close").on("click.billing-editor",function(){i()}),{$this:o,$parent:r,$dropdown:s,$visible:l,$visibleIcon:c,close:i}}}function n(e){this.path=e,this.pieces=e.split(".")}function a(e){return new n(e)}Mashape.Billing={},Mashape.Billing.Dropdown=t,n.references={plan:1,"plan.version":3,"plan.version.object":5},n.addReference=function(e,t){n.references[e]=t},n.prototype.get=function(e){return this.pieces["string"==typeof e?n.references[e]:e]},Mashape.Billing.Keypath=a;var i=Mashape.CONSTANTS,o={describe:function(e,t){function n(e){return e=e||void 0,e&&t.deserialize?t.deserialize(e):e}function a(e){return function(a,i){return o.editor.update(e,t.collection,{meta:a,payload:n(i)})}}o[e]=function(){var e,n=Array.prototype.slice.call(arguments);return n[0]=n[0]||{},e=t.serialize?t.serialize.apply(null,n):n[0],e._original=JSON.parse(JSON.stringify(e)),e},o[e].create=a("post"),o[e].update=a("patch"),o[e].remove=a("delete")}};o.describe("feature",{collection:"feature",serialize:function(e){return{_name:e.name||"",id:e.id,name:e.name||"",description:e.description||""}},deserialize:function(e){return{name:e.name,description:e.description}}}),o.describe("quota",{collection:"object",serialize:function(e,t){for(var n={_name:e.name||"",id:e.id,name:e.name||"",description:e.description||"",endpoints:e.endpoints||{},header:e.header||""},a=0;a<t.length;a++){var i=t[a];n.endpoints[i.id]||(n.endpoints[i.id]={name:i.name,enabled:!1,bulk:!1})}return n},deserialize:function(e){return{name:e.name,description:e.description,headervalue:e.header}}}),o.describe("quotaEndpoint",{collection:"object-endpoint",deserialize:function(e){var t={};return e.endpoint&&(t.endpoint=e.endpoint),"undefined"!=typeof e.bulk&&(t.bulk=!!e.bulk),t}}),o.describe("plan",{collection:"plan",serialize:function(e){return{name:e.name,hidden:e.hidden||!1}},deserialize:function(e){var t={};return e.name&&(t.name=e.name),"undefined"!=typeof e.recommended&&(t.recommended=!!e.recommended),"undefined"!=typeof e.published&&(t.visibility=e.published?i.STATE_PUBLISHED:i.STATE_DRAFT),"undefined"!=typeof e.hidden&&(t.hidden=!!e.hidden),t}}),o.describe("version",{collection:"plan-version",serialize:function(e){return{name:e.name||"",current:e.current||!1,published:e.published?!0:!1,create:e.create||!1,price:e.price||0,period:e.period||"MONTHLY",pricing:e.pricing||"PAYPERUSE",features:e.features||[],quotas:e.quotas||[],versionSubscribed:e.versionSubscribed||!1,actionText:e.actionText||"Subscribe",action:e.action||"SUBSCRIBE",developers:e.developers||[],links:e.links||{},hidden:e.hidden||!1}},deserialize:function(e){var t={};return"undefined"!=typeof e.name&&(t.name=e.name),"undefined"!=typeof e.current&&(t.current=e.current),"undefined"!=typeof e.published&&(t.visibility=e.published?i.STATE_PUBLISHED:i.STATE_DRAFT),"undefined"!=typeof e.price&&(t.price=e.price),"undefined"!=typeof e.period&&(t.period=e.period),t}}),o.describe("planQuota",{collection:"plan-version-limit",serialize:function(e){return{id:e.id,name:e.name,amount:e.amount||0,overages:e.overages||0,unlimited:e.unlimited||!1,period:e.period||"DAILY"}},deserialize:function(e){return{amount:e.amount,overageprice:e.overages,unlimited:e.unlimited,period:e.period}}}),o.describe("planFeature",{collection:"plan-version-feature",serialize:function(e){return{id:e.id,name:e.name,enabled:e.enabled}},deserialize:function(e){var t={};return"undefined"!=typeof e.feature&&(t.feature=e.feature),"undefined"!=typeof e.enabled&&(t.enabled="true"===e.enabled),t}}),Mashape.Billing.Structures=o;var o=Mashape.Billing.Structures,t=Mashape.Billing.Dropdown,a=Mashape.Billing.Keypath,r=Mashape.utils,s=function(){this.init.apply(this,arguments)};s.prototype.init=function(e){return this.options=e,this.custom=this.options.custom,this.user=this.options.user,this.api=this.options.api,this.template=this.options.template,this.element=this.options.element,this.setupData(),this.setupRactive(),this},s.prototype.setupData=function(){return this.data=this.options.data,this.data.custom=this.custom,this.data.user=this.user,this.data.admin="undefined"!=typeof this.data.admin?this.data.admin:!0,this.data.NewFeature=o.feature(),this.data.NewQuota=o.quota({},this.data.Endpoints||[]),this.data._formatAmount=function(e){return _.numberFormat(e,2,".",",")},this.data._getLastItem=function(e){return r.last(e)},this.data._selectedEndpoints=function(e){var t=r.filter(e,"enabled").length;return t?t:"All"},this.setupStructures(),this},s.prototype.setupStructures=function(){function e(e,t){var n=-1!==e.name.indexOf("old")?e.name.split("-")[1]:e.name,a=-1!==t.name.indexOf("old")?t.name.split("-")[1]:t.name;return parseInt(n,10)<parseInt(a,10)?-1:1}function t(e){r.each(s,function(e,t){c.setQuota(t,o.quota(e,a))})}function n(e){r.each(i,function(e,t){c.setFeature(t,o.feature(e))})}var a=this.data.Endpoints,i=this.data.Features,s=this.data.Quotas,l=this.data.Plans,c=this;o.editor=this,s&&s.length&&t(),i&&i.length&&n(),l&&Object.keys(l).length&&r.each(l,function(t,n){var a=t.versions;a=a.sort(e),r.each(a,function(e,t){c.setPlanVersion(n,t,o.version(e)),r.each(e.quotas,function(e,t){e.name||(e.name=t),e=o.planQuota(e)}),r.each(e.features,function(e,t){e.name||(e.name=t),e.enabled||(e.enabled="false"),e=o.planFeature(e)})})})},s.prototype.setupRactive=function(){return this.ractive=new Ractive({el:this.element,template:this.template,data:this.data,magic:!0}),this.setupObservers(),this.setupEvents(),Mashape.Documentation.setupPricingAutofix(),this},s.prototype.setupObservers=function(){var e=this;return this.ractive.observe("Plans.*.versions.*.quotas.*.amount",function(t,n,a){var i=parseFloat(t),o=Mashape.CONSTANTS.BILLING_PLAN_LIMITS_MAXIMUM,r=Mashape.CONSTANTS.BILLING_PLAN_LIMITS_MINIMUM;isNaN(i)||null===i||i===1/0||0===i?i=0:(r>i&&(i=r),i>o&&(i=o)),e.ractive.set(a,i)}),this.ractive.observe("Plans.*.selected",function(t,n,a){var i=a.split(".")[1],o=e.getVersions(i),s=r.find(o,{name:t});"undefined"!=typeof s&&(s.current=!0);var l=r.find(o,{name:n});"undefined"!=typeof l&&(l.current=!1),e.data.Plans[i].versions=o,e.save()}),$('[data-toggle="tooltip"]').tooltip({container:"body"}),this},s.prototype.setupEvents=function(){var e=this,n={},i=function(e){return function(t,n){t.keypath=a(t.keypath);var i=e.call(this,t,n);return i&&i[n]?i[n]():void 0}};return n.toggleOldSubscription=function(t,n){e.data.tempPlans?(e.data.Plans=e.clone(e.data.tempPlans),delete e.data.tempPlans):(e.data.tempPlans=e.clone(e.data.Plans),e.data.Plans=e.data.oldSubscription.plan.Plans),e.save()},n.swapmode=function(t,n){e.ractive.set("editing",!e.data.editing),e.data.editing===!1?(e.subscriptionFlow=new Mashape.Subscribe({user:e.user,api:e.api}).on("ready",function(){$(Mashape.Documentation.elements.pricing.subscribeButton).attr("disabled",!1)}),$('[data-toggle="tooltip"]').tooltip()):e.subscriptionFlow.destroy()},n.back=function(t,n){e.data.plan=null,e.data.loading="listing",e.save(),e.loadPrivatePlanList()},n.loadPage=function(t){var n=$(t.node),a=n.data("page")?parseInt(n.data("page"),10):0;e.data.plan=null,e.data.loading="listing",e.save(),e.loadPrivatePlanList(a)},n.open=function(n,a){var i;e.data._loading||(i=t(n.node,n.original),
i&&(i.$this.data("onClose",function(t){var a=e.ractive.get(n.keypath),o=!1,s=!1;if(a){a.feature&&(o=!0,a=a.feature),a.quota&&(s=!0,a=a.quota);var l=a._original;l&&!t&&(r.each(e.clone(l),function(e,t){"undefined"!=typeof e&&(a[t]=e)}),o&&(a={feature:a}),s&&(a={quota:a}),e.ractive.set(n.keypath,a))}e.dropdown=null,i.$this.data("onClose",null)}),e.dropdown=i))},n.close=function(t,n){return e.data._loading?!1:void e.dropdown.close(!1)},n.showRemovePlanModal=function(e){var t=$(e.node),n=$("#removePlanConfirmation"),a=t.data("plan");n.find(".plan-name").text(a),n.off("click",".btn.submit").on("click",".btn.submit",function(){}),n.modal("show")},n.showInviteDeveloperModal=function(t){function n(t){var n,o=c.find(".scrollbox.invite"),r='<span class="fa fa-plus"></span>&nbsp;invite',s='<span class="btn-text">Loading</span><span class="loader-icon fa fa-spinner fa-spin"></span>',l='<span class="fa fa-check"></span>&nbsp;user invited',p='<div class="account-row"><div></div><div class="pull-left">No results found for <strong></strong></div></div>',h="<div>Nothing to show</div>",f=!1,m=function(t){t.preventDefault(),t.stopPropagation();var n=$(this),o=$('.btn[data-plan="'+d+'"]'),c="undefined"==typeof u,p=c?$(o.parents(".pricing.custom")[0]):$(o.parents("tr.plan")[0]);if(a=d,i=n.data("user-id"),n.attr("disabled"))return!0;n.html(s).addClass("loading");var h=Mashape.client.invitePlanDeveloper(e.api.owner,e.api.name,e.api.version,a,i);h.done(function(t){if(n.html(l).removeClass("loading").removeClass("btn-primary").addClass("btn-default").attr("disabled","disabled"),c)e.data.Plans[a].developers.push(t),e.save();else{var i=p.find(".count .amount"),o=parseInt(i.text(),10);i.text(o+1)}}),h.fail(function(e){n.removeClass("loading"),409===e.status?n.html("User already invited").removeClass("btn-primary").addClass("btn-default").attr("disabled","disabled"):n.html(r).attr("disabled",!1)})},g=function(e){var t=$(this);return t.attr("target")?void 0:(e.preventDefault(),t.attr("target","_blank"),void t.click())},v=function(){$("button.btn.invite").on("click.documentation",m),$(".account-row a.name").on("click.documentation",g),f=!0};n=$(p),n.find("strong").text(t),o=c.find(o),o.html('<div class="account-row"><div class="pull-left"><div></div></div></div>'),o.find(".pull-left div").addClass("span loader-icon fa fa-spinner fa-spin"),$.ajax({method:"GET",url:"/api/internal/invite/"+t}).done(function(e,t,a){var i=e.total;o.removeClass("span loader-icon fa fa-spinner fa-spin"),0===i||e===h?o.html(n):(o.html(e),f||v())}).fail(function(e,t,a){o.find(".pull-left div").removeClass("span loader-icon fa fa-spinner fa-spin"),$(".scrollbox.invite").html(n)})}var a,i,o=$(t.node),s=$("#requirementModal"),l=s.find(".editButton"),c=$("#inviteDevelopers"),p=$(".developer-box"),u=o.data("id"),d=o.data("plan"),h=!0;return"undefined"==typeof u?(a=e.data.Plans[d],r.each(a.versions,function(e){e.published||(h=!1)})):(a=e.data.plans[u],a.version&&"PRIVATE"!==a.version.visibility||(h=!1)),h?(c.modal("show"),c.on("hidden.bs.modal",function(){$("button.btn.invite").off("click.documentation"),$(".account-row a.name").off("click.documentation"),$("input.search").off("keypress.documentation"),$(document).off(".modal-search"),c.find(".scrollbox.invite").empty(),c.find("input.search").val("")}),$(document).on("keypress.modal-search","input.search",function(e){var a;return e=e||t,a=e.keyCode?e.keyCode:e.charCode,13===a?n(c.find("input").val()):void 0}),void $(document).on("click.modal-search",".search-btn",function(e){var t;return e.stopPropagation(),e.preventDefault(),t=c.find("input").val(),t=t?t.toLowerCase():"",n(t)})):(s.modal("show"),void("undefined"!==u?(p.length?l.hide():l.show(),l.on("click.documentation",function(){s.modal("hide"),e.setupPrivatePlan(d)}),s.on("hidden.bs.modal",function(){l.off("click.documentation")})):l.hide()))},n.removeDeveloper=function(t){var n='<span class="btn-text">Loading</span><span class="loader-icon fa fa-spinner fa-spin"></span>',a="Remove",i=$(t.node),o=i.data("id"),r=i.data("plan"),s=parseInt(i.data("index"),10),l=Mashape.client.removePlanDeveloper(e.api.owner,e.api.name,e.api.version,r,o);return i.attr("disabled")?!0:(i.html(n).addClass("loading"),l.done(function(t){e.data.Plans[r].developers.splice(s,1),e.save()}),void l.fail(function(t){i.removeClass("loading"),404===t.status?i.html("User not found...").removeClass("btn-primary").addClass("btn-default").attr("disabled","disabled"):(e.log("error removing developer",t),i.html(a).attr("disabled",!1))}))},n.loadPlan=function(t,n){e.setupPrivatePlan(t.context.name)},n.setRecommended=i(function(t,n){var a=t.index.key,i=e.getPlan(a),s=!!i.recommended;r.each(e.getPlans(),function(e,t){t!==a&&(e.recommended=!1)}),o.plan.update({plan:a},{recommended:s}).done(function(t,n,a){i.recommended=s,e.save()})}),n.publish=i(function(t){var n=t.index.key,a=e.getVersionByName(n,t.context.name),i=$(t.node);e.data._loading=!0,i.addClass("loading"),e.managePlan(n,function(t,r){function s(t,o,r){e.setVersionPublished(n,a.name),e.setVersionCurrent(n,a.name),a=e.updateState(a),e.data._loading=!1,i.removeClass("loading"),e.save()}function l(){var t=o.version.create({plan:n},{name:a.name,published:!0,current:!0});t.done(s),t.fail(function(t){e.log("Message recieved",t),e.data._loading=!1,i.removeClass("loading"),e.alert("Unable to publish plan, please try again.")})}function c(t){var r=o.version.update({plan:n,planVersion:a.name},t);r.done(s),r.fail(function(t){return 404===t.status?(e.log("retrying version creation."),l()):(e.log("Message recieved",t),e.data._loading=!1,i.removeClass("loading"),void e.alert("Unable to publish plan, please try again."))})}return t?e.alert("Unable to publish plan, please try again."):void c({published:!0,current:!0})})}),n.plan=i(function(t,n){function a(t){r.hidden_loading=!0,e.save();var n=o.plan.update({plan:i},{hidden:t});n.done(function(n,a,i){r.hidden_loading=!1,r.hidden=t,e.save()}),n.fail(function(n,a,i){e.alert("Unable to "+(t?"disable":"enable")+" plan: "+n.responseJSON.message)}),n.always(function(t,n,a){r.hidden_loading=!1,e.save()})}var i=t.index.key,r=e.getPlan(i),s=e.getVersionByName(i,t.context.name);return{add:function(t,n){s.create=!1,s.cancelable=!0,s=e.updateState(s),e.save()},remove:function(t,n){s.create=!0,s.cancelable=!1,s=e.updateState(s),e.save()},show:function(e,t){a(!1)},hide:function(e,t){a(!0)}}}),n.add=i(function(t,n){return{privatePlan:function(){function n(t){o.plan.create({},{name:"CUSTOM-"+t,published:!1}).done(function(t){e.data.plans.push(t),$("#addPrivatePlan").modal("hide")}).fail(function(a){return 400===a.status&&"number"==typeof t?n(t+1):(e.alert("Error creating plan: "+a.responseJSON.name),void e.log("an error occurred, server error.",a))}).always(function(){r.removeClass("loading")})}var a=t.context.privatePlanName,i=e.data.plans?e.data.plans.length+1:1,r=$(t.node);""===a&&(a=i),r.addClass("loading"),n(a)},quota:function(){function n(){e.autoIncrementPlansVersion(null,function(n,a){return n?(e.log("problem occurred when adding quota",n),e.setLoading(t.node,!1),!1):void e.forEachPlanVersion(function(t,n){function a(n,a){t.quotas[s.name]=o.planQuota({id:n,name:a}),e.updateState(t)}return t.quotas[s.name]?n():t.cancelable||t.create?(a(null,s.name),e.updateState(t),n()):e.requestLimits(t.links.limits.href,function(i){var o=i.data,l=r.first(o,{object:{name:s.name}})[0];return l?(a(l.id,l.object.name),e.updateState(t),n()):(a(null,s.name),e.updateState(t),n())})},function(){e.save(),e.setLoading(t.node,!1),e.dropdown.close(!0)})}),e.data.Quotas.push(o.quota(s,e.data.Endpoints)),e.data.NewQuota=o.quota({},e.data.Endpoints),e.save()}function a(n){e.setLoading(t.node,!1),e.alert(n.message)}var i,s=t.context;return""===s.name.trim()?void e.alert("Please provide a name for this quota"):(e.setLoading(t.node,!0),i=o.quota.create({},s),i.done(function(e,i,l){function c(n){var a=t.context.endpoints[n];return function(i){o.quotaEndpoint.create({object:e.name},{endpoint:n,bulk:a.bulk}).done(function(e,t,n){return a.id=e.id,i(null,e)}).fail(function(){return t.context.endpoints[n].enabled=!1,i({on:"create-endpoint",message:l.responseJSON||l.responseText,xhr:l})})}}function p(n){var a=t.context.endpoints[n];return function(t){o.quotaEndpoint.update({object:e.name,endpoint:a.id},{bulk:!0}).done(function(e){return t(null,e)}).fail(function(e){return t({on:"update-endpoint",message:e.responseJSON||e.responseText,xhr:e})})}}var u=[];s.id=e.id,r.each(s.endpoints,function(e,t){e.enabled&&u.push(e.id?p(t):c(t))}),async.series(u,function(e,t){return e?a(e):void n()})}),void i.fail(function(n,a){e.setLoading(t.node,!1),e.log("Message recieved",n),e.alert("Error adding quota, "+(n&&n.responseJSON?n.responseJSON.message:"try again."))}))},feature:function(){var n,a=t.context;return""===a.name.trim()?(e.alert("Please provide a name for this feature."),!1):(e.setLoading(t.node,!0),n=o.feature.create({},a),n.done(function(n,i,r){e.autoIncrementPlansVersion(function(){e.getLatestVersions(function(t,n){n.features[a.name]=o.planFeature({id:null,name:a.name,enabled:"false"}),e.updateState(n),e.save()})},function(n,a){n&&e.log("potential error: "+n),e.setLoading(t.node,!1),e.dropdown.close(!0)}),a.id=n.id,e.data.Features.push(o.feature(a)),e.data.NewFeature=o.feature(),e.save()}),void n.fail(function(n){e.setLoading(t.node,!1),409===n.status?e.alert("Could not add feature, "+n.responseJSON.name):e.alert("Could not add feature, please try again")}))}}}),n.updateEntity=i(function(t,n){return{quota:function(){function n(){e.updateState(t.context),e.ractive.set(t.keypath.path,t.context),e.setLoading(t.node,!1),e.dropdown.close(!0)}function a(n){e.setLoading(t.node,!1),e.log("Message recieved:",n),e.alert("Could not update quota, please try again.")}if(""===t.context._name.trim())return e.alert("Please provide a name for this quota."),!1;e.setLoading(t.node,!0);var i=o.quota.update({object:t.context.name},{name:t.context._name,description:t.context.description});i.done(function(i,s,l){function c(e){var n=t.context.endpoints[e];return function(a){o.quotaEndpoint.create({object:i.name},{endpoint:e,bulk:n.bulk}).done(function(e,t,i){return n.id=e.id,a(null,e)}).fail(function(n){return n&&409===n.status?p(e)(a):(t.context.endpoints[e].enabled=!1,a({on:"create-endpoint",message:n.responseJSON||n.responseText,xhr:n}))})}}function p(e){var n=t.context.endpoints[e];return function(e){o.quotaEndpoint.update({object:i.name,endpoint:n.id},{bulk:!0}).done(function(t){return e(null,t)}).fail(function(t){return e({on:"update-endpoint",message:t.responseJSON||t.responseText,xhr:t})})}}function u(e){var n=t.context.endpoints[e];return function(e){o.quotaEndpoint.remove({object:i.name,endpoint:n.id}).done(function(t){return n.id=void 0,e(null,t)}).fail(function(t){return n.enabled=!0,e({on:"remove-endpoint",message:t.responseJSON||t.responseText,xhr:t})})}}var d=[];return t.context._name!==t.context.name&&(e.getLatestVersions(function(n,a){a.quotas[t.context._name]=e.clone(a.quotas[t.context.name]),delete a.quotas[t.context.name]}),t.context.name=t.context._name),t.context.endpoints&&t.context._original&&t.context._original.endpoints&&r.each(t.context.endpoints,function(e,n){r.each(t.context._original.endpoints,function(t,a){e.name===t.name&&(t.enabled&&!e.enabled&&d.push(u(n)),!t.enabled&&e.enabled&&d.push(c(n)),t.enabled&&e.enabled&&e.bulk&&d.push(p(n)))})}),d.length?async.series(d,function(e,t){return e?a(e):void n()}):n()}),i.fail(a)},feature:function(){if(""===t.context._name.trim())return e.alert("Please provide a name for this feature."),!1;e.setLoading(t.node,!0);var n=o.feature.update({feature:t.context.name},{name:t.context._name,description:t.context.description});n.done(function(n,a,i){t.context._name!==t.context.name&&e.getLatestVersions(function(n,a){a.features[t.context._name]=e.clone(a.features[t.context.name]),delete a.features[t.context.name]}),t.context.name=t.context._name,e.updateState(t.context),e.ractive.set(t.keypath.path,t.context),e.setLoading(t.node,!1),e.dropdown.close(!0)}),n.fail(function(n,a){e.setLoading(t.node,!1),e.log("Response message:",n.responseJSON),e.alert("Could not update feature, please try again.")})},price:function(){function n(){e.managePlanVersioning(a,function(n,r){if(n||!r)return e.setLoading(t.node,!1),e.alert("An error has occurred, please refresh page and try again."),!1;e.log(" ... updating plan",a,"pricing to",t.context.price);var s=o.version.update({plan:a,planVersion:r.name},{price:t.context.price});s.always(function(){e.setLoading(t.node,!1)}),s.done(function(t,n,a){e.log("    updated price"),e.dropdown.close(!0)}),s.fail(function(t,n){e.log("    error updating price",t.responseJSON),e.rollback(i),e.alert("Error saving plan pricing, please try again.")})})}var a=t.index.key,i=e.getVersionByName(a,t.context.name);e.setLoading(t.node,!0),e.showVersionCreationModal(i,n)},planQuota:function(){function n(){e.managePlanVersioning(i,function(n,r){var c;return n||r?n?(e.log("error during version cloning: ",n),e.setLoading(t.node,!1),e.alert("object"==typeof n&&n.amount?n.amount:"Error saving plan quota, must be between 0 and "+Mashape.CONSTANTS.BILLING_PLAN_LIMITS_MAXIMUM)):(s=e.getVersionIndexByName(i,r.name),c=e.getVersionByName(i,r.name).quotas[l.name],e.log(" ... updating plan quota",c,l,t),a=o.planQuota.update({plan:i,planVersion:r.name,limit:c.id},l),a.always(function(){e.setLoading(t.node,!1)}),a.done(function(t,n,a){e.log("    updated plan quota"),e.dropdown.close(!0)}),void a.fail(function(t,n){e.rollback(c),e.log("    error updating plan quota",t.responseJSON),e.alert("Error saving plan quota, "+(t.responseJSON&&t.responseJSON.amount?t.responseJSON.amount:"try again."))})):(e.dropdown.close(!0),void e.setLoading(t.node,!1))})}var a,i=t.index.key,r=e.getLatestVersion(i),s=e.getVersionIndexByName(i,r.name),l=t.context.quota;e.setLoading(t.node,!0),e.setVersionQuota(i,s,l.name,l),e.showVersionCreationModal(r,n)},planFeature:function(){function n(){var e=$(t.node),n=e.find(".fa-spinner"),a=e.find(".featureIcon");a.hide(),n.show(),t.context.feature._loading=!0}function a(){var e=$(t.node),n=e.find(".fa-spinner"),a=e.find(".featureIcon");a.show(),n.hide(),s&&(s._loading=null)}function i(){c="false"===t.context.feature.enabled?"true":"false",e.managePlanVersioning(p,function(n,i){return n||i?n?(a(),e.log("    error ",n),e.alert("Error saving plan feature, try again. #2")):(d=e.getVersionIndexByName(p,i.name),r=e.getFeatureByName(t.context.feature.name),s=e.getVersionByName(p,i.name).features[t.context.feature.name],"false"===c&&(l=o.planFeature.remove({plan:p,planVersion:i.name,feature:s.id},{})),"true"===c&&(l=o.planFeature.create({plan:p,planVersion:i.name},{feature:r.id})),void(l?(l.done(function(n,i,o){"true"===c?s.id=n.id:s.id=null,s.enabled=c,e.log("    updated plan feature",s),e.setVersionFeature(p,d,t.context.feature.name,s),a()}),l.fail(function(t,n){a(),e.rollback(s),e.alert("Error saving plan feature, try again.")})):(e.log("Unknown error area, reason missing request:",l,s,p),a()))):(e.log("  :: hiding spinner due to no action required"),void a())})}var r,s,l,c,p=t.index.key,u=e.getLatestVersion(p),d=e.getVersionIndexByName(p,u.name);t.context.feature._loading||(n(),e.showVersionCreationModal(u,i))}}}),n.remove=i(function(t,n){return{feature:function(){function n(n,a,i){e.getLatestVersions(function(t,n,a){delete n.features[r.name],e.updateState(n),e.save(),a()},function(){var n=_.findIndex(e.data.Features,{name:r.name});e.data.Features.splice(n,1),e.save(),e.setLoading(t.node,!1),e.dropdown.close(!0)})}function a(n,a){e.setLoading(t.node,!1),e.alert("Could not remove feature: "+n.responseJSON.error||n.responseJSON.message)}var i,r=t.context;e.setLoading(t.node,!0),i=o.feature.remove({feature:r.id}),i.done(n),i.fail(a)},quota:function(){function n(){e.getLatestVersions(function(t,n,a){delete n.quotas[r.name],e.updateState(n),e.save(),a()},function(){var n=_.findIndex(e.data.Quotas,{name:r.name});e.data.Quotas.splice(n,1),e.save(),e.setLoading(t.node,!1),e.dropdown.close(!0)})}function a(n,a){e.setLoading(t.node,!1),e.alert("Could not remove quota: "+n.responseJSON.error||n.responseJSON.message)}var i,r=t.context;e.setLoading(t.node,!0),i=o.quota.remove({object:r.id}),i.done(n),i.fail(a)},version:function(){var n=$(t.node),a=$("#undoCurrentChanges"),i=n.data("plan"),r=n.data("version"),s=n.data("version-index");0>s-1||(a.find(".plan-name").text(i),a.off("click",".btn.submit").on("click",".btn.submit",function(){var t=o.version.remove({plan:i,version:r});t.done(function(t,n,a){e.data.Plans[i].versions.splice(s,1),e.save()}),t.fail(function(t){e.alert("Could not remove version: "+t.responseJSON.error||t.responseJSON.message)})}),a.modal("show"))}}}),this.ractive.on(n),this},s.prototype.clone=function(e){return JSON.parse(JSON.stringify(e))},s.prototype.update=function(e,t,n){return n.type=t,Mashape.client.updateVersion(e,this.api.owner,this.api.name,this.api.version,n)},s.prototype.setLoading=function(e,t){var n=$(e),a=$(n.parents(".pricing-dropdown")[0]).find(".btn[data-loading-text]");t?(a.addClass("loading"),this.data._loading=!0):(a.removeClass("loading"),this.data._loading=!1)},s.prototype.save=function(){return this.ractive.reset(this.data),this},s.prototype.getQuotas=function(){return this.data.Quotas},s.prototype.getQuota=function(e){return this.data.Quotas[e]},s.prototype.setQuota=function(e,t){"undefined"!=typeof e&&""!==e&&(this.data.Quotas[e]=t)},s.prototype.setVersionQuota=function(e,t,n,a){this.updateState(a),this.ractive.set(["Plans",e,"versions",t,"quotas",n].join("."),a)},s.prototype.getFeatures=function(){return this.data.Features},s.prototype.getFeature=function(e){return this.data.Features[e]},s.prototype.getFeatureByName=function(e){return r.find(this.data.Features,{name:e})},s.prototype.setFeature=function(e,t){"undefined"!=typeof e&&""!==e&&(this.data.Features[e]=t)},s.prototype.setVersionFeature=function(e,t,n,a){this.updateState(a),this.ractive.set(["Plans",e,"versions",t,"features",n].join("."),a)},s.prototype.getPlans=function(){return this.data.Plans},s.prototype.getPlan=function(e){return this.getPlans()[e]},s.prototype.setPlan=function(e,t){return this.data.Plans(e,t),this},s.prototype.getVersions=function(e){return this.getPlan(e).versions},s.prototype.getVersionByName=function(e,t){return r.find(this.getVersions(e),{name:t})},s.prototype.getVersionByIndex=function(e,t){return this.getVersions(e)[t]},s.prototype.getVersionIndexByName=function(e,t){return r.findIndex(this.getVersions(e),{name:t})},s.prototype.getCurrentVersion=function(e){return r.find(this.getVersions(e),"current")},s.prototype.getLatestVersion=function(e){return r.last(this.getVersions(e))},s.prototype.setPlanVersion=function(e,t,n){return this.data.Plans[e].versions[t]=n,this},s.prototype.getLatestVersions=function(e,t){var n=this,a=Object.keys(this.getPlans()),i=_.after(a.length,function(){"function"==typeof t&&t()});return Mashape.utils.each(a,function(t){var a=n.getLatestVersion(t);return e(t,a,i)}),this},s.prototype.setVersionSelected=function(e,t){return this.data.Plans[e].selected=t,this},s.prototype.setVersionCurrent=function(e,t){return r.each(this.getVersions(e),function(e){e.current=e.name===t}),this},s.prototype.setVersionPublished=function(e,t){var n=r.find(this.getVersions(e),{name:t});return n&&(n.published=!0),this},s.prototype.rollback=function(e){return e._original&&r.each(this.clone(e._original),function(t,n){"undefined"!=typeof t&&(e[n]=t)}),e},s.prototype.updateState=function(e){return e._original&&delete e._original,e._original=this.clone(e),e},s.prototype.createPlan=function(e,t){var n=this.getPlan(e);return n.links?t():o.plan.create({},{name:e,published:!0}).done(function(e){return t(null,e)}).fail(function(e,n){return t(e)}),this},s.prototype.managePlan=function(e,t){var n=this,a=this.getPlan(e),i=this.getLatestVersion(e);return i.cancelable?this.createPlan(e,function(e,o){function s(e){Mashape.api.get({url:o.links.versions.href+i.name+"?include=limits&include=limits.object&include=features"}).success(e).fail(function(t){return n.log("    error fetching plan version",t.responseJSON),e("Error fetching plan version "+a.name)})}return e||!o?t(e||"Unable to create plan"):void s(function(e,s,l){return i.links=e.links,e.limits&&e.limits.data.length&&r.each(e.limits.data,function(e,t){var n=i.quotas[e.object.name];n||(n={}),n.id=e.id}),a.links=o.links,a.selected=i.name,i.cancelable=!1,n.save(),t(null,i)})}):t(),this},s.prototype.incrementVersion=function(e,t){function n(){i=l.length?l[l.length-1]:0,i="object"==typeof i?i.name:0,i="string"==typeof i&&-1!==i.indexOf("old")?i.split("-")[1]:i,i=parseInt(i,10),i="number"!=typeof i||isNaN(i)?1:i+1,a=s.clone(c),a.name=i,a.current=!1,a.published=!1,a.recommended=!1,c=c._original,s.updateState(c),s.log(" ... creating version",a.name,"on",e);var n=o.version.create({plan:e},a);n.done(function(n,i,l){function u(e){Mashape.api.get({url:n.links.limits.href+"?include=object"}).always(e)}function d(t,n){return function(i){s.log(" ... updating quota",t);var r=o.planQuota.update({plan:e,planVersion:a.name,limit:n},t);r.done(function(e){return s.log("   quota updated"),a.quotas[t.name].id=e.id,s.updateState(a.quotas[t.name]),i()}),r.fail(function(e){return s.log("    error updating quota",t.name,e.responseJSON),new Mashape.Alert("body",{type:"danger",message:"Could not update quota: "+t.name}).show(),i()})}}function h(t,n){return function(i){function r(e){return s.log(" ... updating cloned feature",t.name,"with new id",e),a.features[t.name].id=e,a.features[t.name].name=t.name,a.features[t.name].enabled=e?"true":"false",s.updateState(a.features[t.name]),s.log("    updated cloned feature",t),i()}if("true"!==t.enabled)return r();s.log(" ... creating feature",t);var l=o.planFeature.create({plan:e,planVersion:a.name},{feature:n});l.done(function(e){return s.log("    created feature",t.name),r(e.id)}),l.fail(function(e){return s.log("    error creating feature",t.name,e.responseJSON),new Mashape.Alert("body",{type:"danger",message:"Could not create feature: "+t.name}).show(),r()})}}function f(e){return function(t){s.log(" ... adding feature",e);try{a.features[e].id=null,a.features[e].name=e,a.features[e].enabled="false",s.updateState(a.features[e]),s.log("    added feature",e.name)}catch(n){s.log("    error adding feature",n)}return t()}}s.log("     version created",n),u(function(i,o){function l(){s.log(" ... updating state");try{a=s.updateState(a),a.links=n.links,s.getVersions(e).push(a),s.getVersions(e)[p]=c,s.setVersionSelected(e,a.name),s.save(),s.log("    updated state")}catch(i){s.log("    error updating state",i)}return t(null,a)}function u(){if(s.log(" :: invoking feature handling,",g.length,"to call"),!g.length)return l();var e=r.after(g.length,l);r.each(g,function(t){return t(e)})}function m(){if(s.log(" :: invoking quotas handling,",v.length,"to call"),!v.length)return u();var e=r.after(v.length,u);r.each(v,function(t){return t(e)})}var g=[],v=[];return"success"===o&&r.each(a.quotas,function(e,t){r.each(i.data,function(n,a){n.object&&t===n.object.name&&v.push(d(e,n.id))})}),r.each(s.data.Features,function(e,t){r.each(a.features,function(t,n){n===e.name&&g.push(t.enabled?h(t,e.id):f(n))})}),m()})}),n.fail(function(n){return t({message:"Failed to create new draft version on plan "+e})})}var a,i,s=this,l=this.getVersions(e),c=this.getLatestVersion(e),p=this.getVersionIndexByName(e,c.name);return c.published?(n(),this):t(null,c)},s.prototype.managePlanVersioning=function(e,t){var n=this;return n.managePlan(e,function(a,i){return a||i?t(a,i):void n.incrementVersion(e,function(e,a){return n.log("version incremented",e,a),e?t(e):t(null,a)})}),this},s.prototype.isCreatingPlanVersion=function(){var e=this,t=Object.keys(this.getPlans()),n=!1;return r.each(t,function(t){var a=e.getLatestVersion(t);a&&a.published&&(n=!0)}),n},s.prototype.autoIncrementPlansVersion=function(e,t){function n(e,n){"function"==typeof t&&(t(e,n),t=null)}function a(t){s.log("Managing Plan Versioning",t),s.managePlanVersioning(t,function(t,n){t&&c.push(t),n&&p.push(n),"function"==typeof e&&(s.log(" - calling callback",t,n),e(t,n)),o()})}function i(){l.length?(o=r.after(l.length,function(){n(c.length?c:null,p)}),r.each(l,a)):n(null,[])}var o,s=this,l=Object.keys(s.getPlans()),c=[],p=[];return s.showVersionCreationModal(s.isCreatingPlanVersion(),i),this},s.prototype.forEachPlanVersion=function(e,t){function n(e,n){"function"==typeof t&&(t(e,n),t=null)}function a(t,n){var a=i.getVersions(t),o=r.after(a.length,n);r.each(a,function(t){e(t,o)})}var i=this,o=Object.keys(i.getPlans()),s=[],l=[];if(o.length){var c=_.after(o.length,function(){n(s.length?s:null,l)});r.each(o,function(e){a(e,c)})}else n();return this},s.prototype.loadPrivatePlanList=function(e,t){var n=this,a=Mashape.client.fetchVersionPrivatePlans(this.api.owner,this.api.name,this.api.version,e);a.success(function(e,t,a){n.data.plans=e.data,n.data.previous=e.previous,n.data.next=e.next,n.data.loading=!1,n.data.editing=!1,n.setupStructures(),n.save()}),a.fail(function(e,t){n.data.error="There was a problem loading plan listing.",n.data.loading=!1,n.save()})},s.prototype.loadPrivatePlan=function(e,t){var n=Mashape.client.fetchVersionPrivatePlan(this.api.owner,this.api.name,this.api.version,e);n.done(function(e,n,a){t(null,e)}),n.fail(function(e){t(e)})},s.prototype.setupPrivatePlan=function(e){var t=this;this.data.Plans={},this.data.Quotas={},this.data.Features={},this.data.Endpoints={},this.data.loading=e,this.save(),this.loadPrivatePlan(e,function(n,a){return t.log(n,a),t.data.loading=!1,n?(t.log("Unable to load private plan",n),t.data.error=n,void t.save()):(t.data.plan=e,t.data.editing=!0,t.data.Endpoints=a.Endpoints,t.data.Quotas=a.Quotas,t.data.Features=a.Features,t.data.Plans[e]=a.Plans[e],t.setupStructures(),void t.save())})},s.prototype.showVersionCreationModal=function(e,t){var n=$("#createVersionModal");"boolean"==typeof e&&e||e.published?(n.modal("show"),n.find(".btn-primary.submit").off("click").on("click",function(){n.modal("hide"),t()})):t()},s.prototype.requestLimits=function(e,t){Mashape.api.get({url:e+"?include=object"}).always(t)},s.prototype.requestFeatures=function(e,t){Mashape.api.get({url:e+"?include=features"}).always(t)},s.prototype.alert=function(e,t){"undefined"==typeof t&&(t=e,e="danger"),new Mashape.Alert("body",{type:e,message:t}).show()},s.prototype.log=function(){if(window.console&&Mashape.Mode===Mashape.CONSTANTS.DEBUG_MODE){var e=console.log.bind(console);return e.apply(null,arguments)}},Mashape.Billing.Editor=s}.call(this),function(){function e(e,t){var n="[object Object]"===Object.prototype.toString.call(e)?e.keypath:e,a=n.split("."),i={groups:1,models:1,group:2,model:2,authentication:2,endpoints:3,endpoint:4,payloadOrResponse:5,parameters:6,parameter:7,"response.headers":8,"response.header":9};return i[t]?a.slice(0,i[t]).join("."):"number"==typeof t?a.slice(0,t).join("."):void console.warn('Type "'+t+'" is not defined.')}function t(t,n,a,i){function o(e){e?(p.removeClass(V),t.keypath=s,C.last={event:t,type:n}):p.addClass(V),"undefined"!=typeof r&&C.eventHandlers.scrollTo("#"+r)}var r,s=e(t,n),l=[s,O].join("."),c=[s,j].join("."),p=$(C.elements.backgroundSelector);if("payloadOrResponse"===n){var u=x.get(t.keypath),d=e(t,"payloadOrResponse"),h=[d,R].join(".");return a?(r="add-model",x.set(h,[u])):x.set(h,[]),x.update(d),o(a)}if("undefined"==typeof i&&(i=!0),a){var f=$.extend(!0,{},x.get(s));f[j]=!1,x.set(l,f),~["endpoint","parameter"].indexOf(n)&&(x.set([s,"id"].join("."),f.id),r=f.slugifiedPrimary)}else i&&x.set(s,x.get(l));x.set(c,a),o(a)}function n(n,a,i,o){if(!$(n.node).hasClass("disabled")||i){o="undefined"!=typeof o?o:!0;var r,s,l,c,p,u,m,g={authentication:function(){s=[R,"authentication"].join("."),r="authentication"},endpoint:function(){var e,t;s=[R,"endpoint"].join("."),e=x.get(s)[0].group,p=_.find(x.get("groups"),function(n,a){return t=a,n.id===e}),p||(p=_.find(x.get("groups"),function(e,n){return t=n,e.id===W})),r=["groups",t,"endpoints"].join(".")},parameter:function(){var t=x.get(e(n,"endpoint"));~n.keypath.indexOf("authentication")?(s=e(n,4),m="authentication",r=["authentication","0","parameters"].join(".")):(s=e(n,6),m=s.split(".").pop(),r=s.replace(R,"parameters"),x.set([s,"0","_endpointSlug"].join("."),t.slugifiedPrimary||t.id))},"response.header":function(){r=n.keypath,s=[r,R,"header"].join("."),r=[r,"headers"].join(".")}};if(g[a])return g[a](),l=[s,"0",F].join("."),x.set(l,!0),c=i?i:x.get(s)[0],C.transport.create(a+("undefined"!=typeof m?"."+m:""),c).always(function(){x.set(l,!1)}).done(function(e){c[j]=!1,e?(c.id=e.id,c.slugifiedPrimary=e.slugifiedPrimary,c.name=e.name,c.links=e.links):h(c),"endpoint"===a&&(c.host=x.get("production_test_console")?"https://"+x.get("publicURL"):x.get("proxyURL"),c.parameters.header.push({name:Mashape.CONSTANTS.MASHAPE_AUTH_HEADER,value:x.get(Mashape.CONSTANTS.MASHAPE_AUTH_HEADER)}),c.group=p.id),u=x.get(r)||[],u.push(c),x.set(r,u),x.set(s,[]),$(C.elements.backgroundSelector).addClass(V),o&&C.eventHandlers.scrollTo("#"+c.slugifiedPrimary),"endpoint"===a?(x.update("endpointsCount"),C._updateScrollSpy(),C._udpateUIElementsForEndpoint(c.slugifiedPrimary,!0),r+="."+(u.length-1),f(e.links.routeparameters.href,r)):"authentication"===a&&(C._preprocessOAuth(c),x.update())}).fail(function(){console.warn('Network error on creating type "'+a+'".')});if("payload"===a||"response"===a){var v=e(n,"endpoint"),y=x.get(v),b=[v,a,"model","0"].join(".");s=b.replace("model.0",R);var M=i?i:x.get(s)[0];M._endpointSlug=y.slugifiedPrimary,M.property=a+"Model";var k={},S=$.Deferred();return S.promise(k),async.waterfall([function(e){C.transport.create("model",M).done(function(e){M.id=e.id}).always(Mashape.utils.asyncAlways(e))},function(e,t){var n={};n.id=y.id,n[a]=M.id,C.transport.update("endpoint",n).fail(function(e){return t(e)}).done(function(){return t(null,e)})}],function(e,i){return e?(console.error("error in create model flow:",e),S.reject(e)):(E.formatModel(M),x.set(b,M),x.push("models",M),x.set(s,[]),x.set([v,a,"modelId"].join("."),M.id),t(n,"payloadOrResponse",!1,!1),C._udpateUIElementsForEndpoint(M._endpointSlug,!0),d(v),void S.resolve(i))}),k}if("group"===a){r="groups";var T=$("#create-group"),A=T.find('input[name="name"]');T.find(".submit").addClass("disabled");var P=_.max(_.map(x.get(r),function(e){return e.index||0}));return c=$.extend(!0,{},w.group),c.name=A.val(),c.index=P,C.transport.create(a+("undefined"!=typeof m?"."+m:""),c,x.data).always(function(){T.find(".submit").removeClass("disabled")}).done(function(e){e?(c.id=e.id,c.slugifiedPrimary=e.slugifiedPrimary):h(c),groups=x.get(r)||[];var t;_.find(groups,function(e,n){return t=n,e.id===W}),groups[t].index=c.index+1,x.push(r,c),C._updateScrollSpy(),A.val(""),T.modal("hide"),C.eventHandlers.scrollTo("#"+c.slugifiedPrimary)}).fail(function(){console.warn('Network error on creating type "'+a+'".')})}console.warn('Create failed for type "'+a+'".')}}function a(t,n,a){function i(){s=n.split(".").pop(),o=[e(t,"endpoint"),R,s].join("."),r=w.parameter[s]}var o,r,s,l={authentication:function(){o=[R,n].join("."),r=w.authentication},endpoint:function(){o=[R,n].join("."),r=w.endpoint},"parameter.header":i,"parameter.route":i,"parameter.query":i,"parameter.form":i,"parameter.authentication":function(){o=["authentication","0",R,"parameters"].join("."),r=w.parameter.authentication},payloadOrResponse:function(){o=t.keypath,r=a?a:w.model},"response.header":function(){o=[t.keypath,R,"header"].join("."),r=w.parameter.header}};l[n]?(l[n](),x.set(o,[$.extend(!0,{},r)]),t.keypath=[o,"0"].join("."),C.last={event:t,type:n},$(C.elements.backgroundSelector).removeClass(V),$(C.elements.editBox).find('input:not([type="hidden"])').first().focus()):console.warn('Failed to add entity for type "'+n+'".'),C.eventHandlers.scrollTo(C.elements.editBox,{hash:!1})}function i(n,a){if(!$(n.node).hasClass("disabled")){var i,o,r,s={
authentication:function(){i=e(n,"authentication")},endpoint:function(){i=e(n,"endpoint")},parameter:function(){if(~n.keypath.indexOf("authentication"))i=e(n,4),r="authentication";else{var t=x.get(e(n,"endpoint"));i=e(n,"parameter"),r=e(n,"parameters").split(".").pop(),"headers"===r?r="header":x.set([i,"_endpointSlug"].join("."),t.slugifiedPrimary)}},"response.header":function(){i=e(n,"response.header")}};if(s[a])return s[a](),o=[i,F].join("."),x.set(o,!0),C.transport.update(a+("undefined"!=typeof r?"."+r:""),x.get(i)).always(function(){x.set(o,!1)}).done(function(o){if(t(n,a,!1,!1),"endpoint"===a){var s=x.get(i),l=x.get(e(n,"group"));if("GET"===s.method||"DELETE"===s.method){var c=s.parameters.form.slice(0);_.each(c,function(e){C.transport["delete"]("parameter.form",e)}),s.payload.model.length&&C.transport.update("payload",{_endpointSlug:s.slugifiedPrimary,id:""}),s.payload.model=[],s.parameters.form=[],x.set(i,s)}if(s.group!==l.id){var p=0,u=_.find(x.get("groups"),function(e,t){return p=t,e.id===s.group});u||(u=_.find(x.get("groups"),function(e,t){return p=t,e.id===W}));var h=["groups",p,"endpoints"].join("."),m=e(n,"endpoints"),g=x.get(h);g.push(s),x.set(h,g),g=x.get(m),g.splice(_.parseInt(i.split(".").pop(),10),1),x.set(m,g),C._updateScrollSpy()}d(i),"undefined"!=typeof x.get(i)&&f(o.links.routeparameters.href,i)}if("authentication"===a&&(_.each(x.get([i,"parameters"].join(".")),function(e){"undefined"!=typeof e.id&&C.transport["delete"]("parameter.authentication",e)}),x.set([i,"parameters"].join("."),[])),"route"===r){var v=e(n,"endpoint"),s=x.get(v);C.transport.get({url:s.links.self.href}).done(function(e){x.set([v,"route"].join("."),e.route),x.set([v,"name"].join("."),e.name)})}}).fail(function(){console.warn('Network error on updating type "'+a+'".')});if("payload"===a||"response"===a){var l=e(n,"endpoint"),c=[l,a,R].join("."),p=x.get(l),u=x.get(c)[0];i=[l,a,"model","0"].join("."),async.parallel({endpoint:function(e){var t={};t.id=p.id,t.code=p.code,t[a]=u.id,C.transport.update("endpoint",t).always(Mashape.utils.asyncAlways(e))},model:function(e){C.transport.update("model",u).always(Mashape.utils.asyncAlways(e))}},function(e,o){e&&console.error("error in update model flow:",e),x.set(c,[]);var r=I.serializeModel(o.model,o.endpoint);r.property=a+"Model",x.set(i,r),x.set([l,"code"].join("."),o.endpoint.code),t(n,"payloadOrResponse",!1,!1),d(l),C._udpateUIElementsForEndpoint(p.slugifiedPrimary,!0)})}else if("group"===a){var h=$("#edit-group");h.find(".submit").addClass("disabled");var m=h.find('input[name="name"]').val();i=h.data("keypath");var g=$.extend(!0,{},x.get(i));g.name=m,C.transport.update(a+("undefined"!=typeof r?"."+r:""),g).always(function(){h.find(".submit").removeClass("disabled")}).done(function(){x.set([i,"name"].join("."),m),h.modal("hide")}).fail(function(){console.warn('Network error on updating type "'+a+'".')})}else console.warn('Update failed for type "'+a+'".')}}function o(n,a){if(!x.get(n.keypath)[F]){var i,o,r=[],s=!1,l={authentication:function(){i=R,r=["authentication"]},endpoint:function(){i=R,r=["endpoint"]},payloadOrResponse:function(){var t=e(n,"payloadOrResponse").split(".").pop();i=[e(n,"endpoint"),t].join("."),r=[R]},"response.header":function(){i=[e(n,"payloadOrResponse"),R].join("."),r=["header"]},parameter:function(){~n.keypath.indexOf("authentication")?(i=["authentication","0",R].join("."),r=["parameters"]):(i=[e(n,"endpoint"),R].join("."),r=["header","route","query","form"])}};l[a]?(l[a](),_.each(r,function(e){o=[i,e].join("."),x.get(o)&&x.get(o).length&&(x.set(o,[]),s=!0)}),s?$(C.elements.backgroundSelector).addClass(V):t(n,a,!1)):console.warn('Cancel failed for type "'+a+'".')}}function r(t,n){if(!$(t.node).hasClass("disabled")){var a,i,o,r,s,l,p={authentication:function(){o="authentication",r=o+".0"},endpoint:function(){o=e(t,"endpoints"),r=e(t,"endpoint")},group:function(){o=e(t,"groups"),r=e(t,"group")},parameter:function(){if(~t.keypath.indexOf("authentication"))o=e(t,3),r=e(t,4),s="authentication";else{var n=x.get(e(t,"endpoint"));o=e(t,"parameters"),r=e(t,"parameter"),s=o.split(".").pop(),"headers"===s?s="header":x.set([r,"_endpointSlug"].join("."),n.slugifiedPrimary)}},"response.header":function(){o=e(t,"response.headers"),r=e(t,"response.header")},model:function(){o=e(t,"models"),r=e(t,"model")}};if(p[n])return p[n](),l=r.split("."),l=l[l.length-1],a=x.get(o),i=a[l],C.transport["delete"](n+("undefined"!=typeof s?"."+s:""),i).done(function(){if(x.splice(o,l,1),"group"===n){var i=a.length;_.forEachRight(a,function(e){e.index=i,i--,e.id!==W&&C.transport.update(n,e)})}else"endpoint"===n&&x.update("endpointsCount");if("route"===s){var r=e(t,"endpoint"),p=x.get(r);C.transport.get({url:p.links.self.href}).done(function(e){x.set([r,"route"].join("."),e.route),x.set([r,"name"].join("."),e.name)})}c()}).fail(function(){console.warn('Network error on deleting type "'+n+'".')});if("payload"===n||"response"===n){var u=e(t,"endpoint"),h=x.get(u);o=[u,n,"model"].join(".");var f={};f.id=h.id,f[n]="",C.transport.update("endpoint",f).done(function(e){x.set([u,n,"modelId"].join("."),""),x.splice(o,0),d(u)})}else console.warn('Delete failed for type "'+n+'".')}}function s(){var e=$(".edit-dropdown.open");return e.removeClass("open"),e}function l(e,t){var n,a;if("undefined"==typeof t&&(t={hash:!0}),"object"==typeof e&&"undefined"!=typeof e.original?(e.original.preventDefault(),e.original.stopPropagation(),n=$(e.node),n.hasClass("group-link")?(a=n.next("ul.nav").find("li a").first().attr("href"),"undefined"==typeof a&&(a=n.attr("href"))):a=n.attr("href")||n.attr("data-scroll")):a=e,a&&$(a).length){var i=1e3*parseFloat($(a).css("transition-duration"),10);setTimeout(function(){var e=$(a);if(e.length){var n=e.offset().top,i=$(".header").outerHeight(),o=$(".switch-context").outerHeight(),r=t.rightPanel?$(".language-selector").outerHeight():0;$.scrollTo({top:n-i-i-o-r+1,left:0},300),window.location.hash=t.hash?a:""}},i||0)}}function c(){_.each(x.data.groups,function(e,t){_.each(e.endpoints,function(e,n){d(["groups",t,"endpoints",n].join("."))})})}function p(e){var t={javascript:"nodejs",ruby:"ruby",php:"php",java:"java",cs:"net",objectivec:"objective-c",python:"python"};return"undefined"==typeof t[e]?!1:' <a href="http://unirest.io/'+t[e]+'" target="_blank">http://unirest.io/'+t[e]+"</a>"}function u(e){if(p(e)){var t={ruby:"#",python:"#"};return("undefined"!=typeof t[e]?t[e]:"//")+" These code snippets use an open-source library."}}function d(e){var t=x.get(e),n=_.keys(x.get(U))[0],a=u(n),i=(a?a+"\n":"")+N.snippetForEndpoint(n,t,x.data),o=$($.parseHTML('<div class="highlighted">'+E.highlightCode(i,n,!0)+"</div>"));o.find(".hljs-comment").append(p(n)),x.set([e,"snippet","raw"].join("."),i),x.set([e,"snippet","highlighted"].join("."),o.html()),"undefined"!=typeof C.clipboards[t.slugifiedPrimary]&&C.clipboards[t.slugifiedPrimary].destroy();var r=$('section.endpoint[id="'+t.slugifiedPrimary+'"]').find(".response .code .fa-copy"),s=new ZeroClipboard(r);s.on("aftercopy",function(){r.find(".copied").show().delay(1e3).fadeOut()}),C.clipboards[t.slugifiedPrimary]=s}function h(e,t){return t=t||"id",e[t]=Math.floor(Math.random()*Math.pow(2,32)).toString(16),e}function f(e,t){C.transport.get({url:e,query:{include:"endpoint"}}).done(function(e){var n=_.filter(e.data,function(e){return"undefined"==typeof e.querystring}),a=_.filter(e.data,{querystring:!0});x.set([t,"parameters","route"].join("."),n),x.set([t,"parameters","query"].join("."),a),e.data.length&&"undefined"!=typeof e.data[0].endpoint&&(x.set([t,"route"].join("."),e.data[0].endpoint.route),x.set([t,"name"].join("."),e.data[0].endpoint.name))})}function m(){return C.storage.get()}function g(e){C.storage.set($.extend(!0,C.storage.get(),e))}function v(e){return!!~["oauth1","oauth2"].indexOf(e.toLowerCase())}function y(e,t){if(4===e.readyState){var n="";try{var a=JSON.parse(e.responseText);_.each(a,function(e,t){n+=e})}catch(i){n=e.responseText||"An unexpected error has occurred."}new Mashape.Alert("body",{type:"danger",position:"top-right",message:n}).show()}}function b(e,t){var n=$.extend(!0,{},e,t);return"undefined"!=typeof n._editing&&(n._editing=!1),n}Mashape.DocumentationComponents={},window.saveAs||(window.saveAs=(window.navigator.msSaveBlob?function(e,t){return window.navigator.msSaveBlob(e,t)}:!1)||window.webkitSaveAs||window.mozSaveAs||window.msSaveAs||function(){return window.URL||(window.URL=window.webkitURL),window.URL?function(e,t){var n=URL.createObjectURL(e);if("download"in document.createElement("a")){var a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",t);var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,0,event.screenX,event.screenY,event.clientX,event.clientY,event.ctrlKey,event.altKey,event.shiftKey,event.metaKey,0,null),a.dispatchEvent(i)}else window.open(n,"_blank","")}:!1}());var w={};window.structures=w,w.authentication={_adding:{parameters:[]},_editing:!1,_syncing:!1,type:"",description:"",legs:"3",authorization_url:"",access_token_url:"",request_token_url:"",grant_type:"CLIENT_CREDENTIALS",signature:"HMAC-SHA1",scope_separator:"COMMA",oauth_token:"default",parameters:[],oauth_headers:[]},w.group={name:"",endpoints:[]},w.model={_adding:{header:[]},_editing:!1,_syncing:!1,name:"",description:"",body:null,headers:[],format:"JSON",displayedBody:{value:"",formatted:""}},w.consoleResponse={show:!0,status:"",headers:"",formatted:"",toCopy:null,percent:null,blobURL:null,aborted:!1,done:!1,backarrow:!1,errors:{serverError:!1,clientError:!1,oversized:!1,needSubscription:!1,needAppKey:!1}},w.endpoint={_adding:{header:[],route:[],form:[],payload:[],response:[]},_preview:{show:!1},_editing:!0,_syncing:!1,method:"GET",code:200,name:"",host:"",route:"",description:"",group:"",parameters:{header:[],route:[],query:[],form:[]},payload:{_adding:[],model:[],modelId:""},response:{_adding:[],model:[],modelId:""}},w.parameter={route:{_editing:!0,_syncing:!1,description:"",condition:"REQUIRED",name:"",type:"STRING",value:""},query:{_editing:!0,_syncing:!1,description:"",condition:"OPTIONAL",name:"",type:"STRING",value:""},header:{_editing:!0,_syncing:!1,description:"",condition:"OPTIONAL",name:"",type:"STRING",value:""},form:{_editing:!0,_syncing:!1,description:"",condition:"OPTIONAL",name:"",type:"STRING",value:"",canBinary:!0},authentication:{_editing:!0,_syncing:!1,name:"",description:"",value:""}},Mashape.DocumentationComponents.Structures=w,function(e){function t(e,t,n){this.endpoint=this.clone(e),this.data=t,this.publicURL=t.publicURL,this.auth=this.clone(t.authentication),this.consoleReq=n,this.parameterPlaceholder=this.consoleReq?"":"<required>"}function n(e){return encodeURIComponent(e).replace(/%20/g,"+")}function a(e){return"string"==typeof e?e.trim():e}e.Builder=t,t.prototype.determineContentType=function(){var e=this.canHavePayload()?"undefined"!=typeof this.payload().format?this.payload().format:"FORM":void 0;return"FORM"===e&&this.forEachFormParameter(function(t){"BINARY"===t.type.toUpperCase()&&(e="MULTIPART")}),e},t.prototype.determineMimeType=function(e){e=e||"";var t;switch(e.toUpperCase()){case"FORM":t="application/x-www-form-urlencoded";break;case"MULTIPART":t="multipart/form-data";break;case"XML":t="application/xml";break;case"JSON":t="application/json";break;case"TEXT":t="text/plain";break;default:t=!1}return t},t.prototype.determineAcceptType=function(){return this.endpoint.response.model.length?this.endpoint.response.model[0].format:!1},t.prototype.determineResponseType=function(){return this.determineAcceptType()||"JSON"},t.prototype.isMultipart=function(){return"MULTIPART"===this.determineContentType()},t.prototype.method=function(e){return e?this.endpoint.method.toLowerCase():this.endpoint.method.toUpperCase()},t.prototype.forEachClone=function(e,t){var n=[];_.each(this.clone(e),function(e){if("undefined"==typeof e.value||""===e.value){if("OPTIONAL"===e.condition)return;"REQUIRED"===e.condition&&("BINARY"!==e.type?e.value=this.parameterPlaceholder:e.value="<file goes here>")}e.type&&"BOOLEAN"===e.type?e.value="true"===e.value:e.value=a(e.value),n.push(e)}.bind(this)),_.each(n,t)},t.prototype.forEachRouteParameter=function(e){_.each(this.clone(this.endpoint.parameters.route),function(t){return"undefined"!=typeof t.value&&""!==t.value?t.value=encodeURIComponent(a(t.value)):t.value="{"+t.name+"}",e(t)})},t.prototype.forEachQueryParameter=function(e){return this.forEachClone(this.endpoint.parameters.query,function(t){return t.value!==this.parameterPlaceholder&&(t.value=n(t.value)),e(t)}.bind(this))},t.prototype.forEachHeader=function(e){var t=this.clone(this.endpoint.parameters.header);this.hasHeader("Authorization")||this.auth.length&&"basic"===this.auth[0].type.toLowerCase()&&t.unshift({name:"Authorization",condition:"REQUIRED",value:this.auth[0].parameters.length?this.auth[0].parameters[0].value:""}),this.data.production_test_console||t.unshift({name:"X-Mashape-Host",value:this.publicURL,condition:"REQUIRED"}),this.auth.length&&("header"===this.auth[0].type.toLowerCase()?_.each(this.auth[0].parameters,function(e){t.push({name:e.name,value:e.value,condition:"REQUIRED"})}):"1"===this.auth[0].type.slice(-1)?_.each(this.auth[0].oauth_headers,function(e){t.push({name:e.name,value:e.value,condition:"REQUIRED"})}):"2"===this.auth[0].type.slice(-1)&&_.each(this.auth[0].oauth_headers,function(e){var n="";("undefined"!=typeof e.token_type&&""!==e.token_type||"undefined"!=typeof e.value&&""!==e.value)&&(n=[a(e.token_type),a(e.value)].join(" ")),t.unshift({name:e.name,value:n,condition:"REQUIRED"})}));var n={"Content-Type":this.determineMimeType(this.determineContentType()),Accept:this.determineMimeType(this.determineAcceptType())};_.each(n,function(e,n){this.hasHeader(n)||this.isMultipart()||!e||t.push({name:n,value:e})}.bind(this)),this.forEachClone(t,e)},t.prototype.forEachFormParameter=function(e){this.forEachClone(this.endpoint.parameters.form,e)},t.prototype.url=function(){var e=this.endpoint.route,t=this.data.proxyURL,n="";return this.forEachRouteParameter(function(t){var n=new RegExp("{"+t.name.toLowerCase()+"}","gi");e=e.replace(n,t.value)}),this.auth.length&&"query"===this.auth[0].type.toLowerCase()&&this.forEachClone(this.auth[0].parameters,function(e){n+=(n.length?"&":"?")+e.name+"="+a(e.value)}),this.forEachQueryParameter(function(e){n+=(n.length?"&":"?")+e.name+"="+e.value}),this.data.production_test_console&&(t="https://"+this.publicURL),t+e+n},t.prototype.canHavePayload=function(){return"GET"!==this.method()&&"DELETE"!==this.method()},t.prototype.payload=function(){return this.canHavePayload()&&this.endpoint.payload.model&&this.endpoint.payload.model.length?this.endpoint.payload.model[0]:!1},t.prototype.forPayload=function(e){var t=this.payload();t&&e(t)},t.prototype.hasHeader=function(e){var t=_.find(this.endpoint.parameters.header,function(t){return"undefined"!=typeof t.name?t.name.toLowerCase()===e.toLowerCase():!1});return"undefined"!=typeof t},t.prototype.clone=function(e){var t;try{t=JSON.parse(JSON.stringify(e))}catch(n){}return t}}("undefined"!=typeof Mashape?Mashape.DocumentationComponents:module.exports);var M;M="undefined"!=typeof Mashape?Mashape.DocumentationComponents.Builder:require("./builder").Builder,function(e){var t={escapePayload:function(e,t){var n="";if("undefined"!=typeof e.displayedBody&&"undefined"!=typeof e.displayedBody.value&&""!==e.displayedBody.value?n=e.displayedBody.value:e.body&&"undefined"!=typeof e.body&&(n=e.body),"JSON"===e.format)try{var a=JSON.parse(n);n=JSON.stringify(a,null,0)}catch(i){}return t||(n=n.replace(/"/g,'\\"')),n.replace(/\n/g,"")},camelCase:function(e){return e}},n={bash:function(e){var n=[];return"GET"===e.method()?n.push("curl --get --include '"+e.url()+"'"):n.push("curl -X "+e.method()+" --include '"+e.url()+"'"),e.forEachHeader(function(e){n.push("  -H '"+e.name+": "+e.value+"'")}),e.forEachFormParameter(function(t){e.isMultipart()?"BINARY"===t.type?n.push("  -F '"+t.name+"=@"+t.value+"'"):n.push("  -F '"+t.name+"="+t.value+"'"):n.push("  -d '"+t.name+"="+t.value+"'")}),e.forPayload(function(e){n.push("  --data-binary '"+t.escapePayload(e,!0)+"'")}),n.join(" \\\n")},php:function(e){function n(e){l[e]=l[e].slice(0,-1)}function a(e){l[e]+=",",r=!0}function i(){s||(a(l.length-1),l.push("  array("),s=!0)}function o(){n(l.length-1),l.push("  )"),s=null}var r=!1,s=!1,l=[];return l.push("$response = Unirest\\Request::"+e.method(!0)+'("'+e.url()+'"'),e.forEachHeader(function(e){i(),l.push('    "'+e.name+'" => "'+e.value+'",')}),s&&o(),e.forEachFormParameter(function(e){switch(i(),e.type){case"BINARY":l.push('    "'+e.name+'" => Unirest\\file::add("'+e.value+'"),');break;case"NUMBER":case"BOOLEAN":l.push('    "'+e.name+'" => '+e.value+",");break;case"STRING":l.push('    "'+e.name+'" => "'+e.value+'",')}}),s&&o(),e.forPayload(function(e){l.push('  "'+t.escapePayload(e)+'"')}),r?(l.push(");"),l=l.join("\n")):(l[l.length-1]+=");",l=l.join("")),l},java:function(e){var n=[],a={JSON:{type:"JsonNode",invoker:"asJson"},BINARY:{type:"InputStream",invoker:"asBinary"},STRING:{type:"String",invoker:"asString"},XML:{type:"String",invoker:"asString"},TEXT:{type:"String",invoker:"asString"}},i=a[e.determineResponseType()];return n.push("HttpResponse<"+i.type+"> response = Unirest."+e.method(!0)+'("'+e.url()+'")'),e.forEachHeader(function(e){n.push('.header("'+e.name+'", "'+e.value+'")')}),e.forEachFormParameter(function(e){switch(e.type){case"BINARY":n.push('.field("'+e.name+'", new File("'+e.value+'"))');break;case"NUMBER":case"BOOLEAN":n.push('.field("'+e.name+'", '+e.value+")");break;case"STRING":n.push('.field("'+e.name+'", "'+e.value+'")')}}),e.forPayload(function(e){n.push('.body("'+t.escapePayload(e)+'")')}),n.push("."+i.invoker+"();"),n.join("\n")},javascript:function(e){var n=[];return n.push("unirest."+e.method(!0)+'("'+e.url()+'")'),e.forEachHeader(function(e){n.push('.header("'+e.name+'", "'+e.value+'")')}),e.isMultipart()?e.forEachFormParameter(function(e){switch(e.type){case"BINARY":n.push('.attach("'+e.name+'", fs.createReadStream("'+e.value+'"))');break;case"NUMBER":case"BOOLEAN":n.push('.field("'+e.name+'", '+e.value+")");break;case"STRING":n.push('.field("'+e.name+'", "'+e.value+'")')}}):e.forEachFormParameter(function(e){n.push('.send("'+e.name+"="+e.value+'")')}),e.forPayload(function(e){"JSON"===e.format?n.push(".send("+t.escapePayload(e,!0)+")"):n.push('.send("'+t.escapePayload(e)+'")')}),n.push(".end(function (result) {"),n.push("  console.log(result.status, result.headers, result.body);"),n.push("});"),n.join("\n")},python:function(e){function n(e){a[e]+=","}var a=[],i=[],o=[];return e.forEachHeader(function(e){i.push('    "'+e.name+'": "'+e.value+'"')}),e.forEachFormParameter(function(e){switch(e.type){case"BINARY":o.push('    "'+e.name+'": open("'+e.value+'", mode="r")');break;case"NUMBER":case"BOOLEAN":o.push('    "'+e.name+'": '+e.value);break;case"STRING":o.push('    "'+e.name+'": "'+e.value+'"')}}),a.push("response = unirest."+e.method(!0)+'("'+e.url()+'"'),i.length&&(n(a.length-1),a.push("  headers={\n"+i.join(",\n")+"\n  }")),o.length&&(n(a.length-1),a.push("  params={\n"+o.join(",\n")+"\n  }")),e.forPayload(function(e){n(a.length-1),a.push('  params=("'+t.escapePayload(e)+'")')}),a.push(")"),a.join("\n")},objectivec:function(e){var n={JSON:"Json",BINARY:"Binary",STRING:"String",XML:"String"},a=[],i=[],o=[],r=n[e.determineResponseType()];return e.forEachHeader(function(e){i.push('@"'+e.name+'": @"'+e.value+'"')}),e.forEachFormParameter(function(e){var n=t.camelCase(e.name);switch(e.type){case"BINARY":a.push("NSURL *url"+n+' = [NSURL URLWithString:@"'+e.value+'"]'),o.push('@"'+e.name+'": url'+n);break;case"NUMBER":o.push('@"'+e.name+'": @('+e.value+")");break;case"BOOLEAN":o.push('@"'+e.name+'": @('+(e.value?"YES":"NO")+")");break;case"STRING":o.push('@"'+e.name+'": @"'+e.value+'"')}}),i.length&&a.push("NSDictionary *headers = @{"+i.join(", ")+"};"),o.length&&a.push("NSDictionary *parameters = @{"+o.join(", ")+"};"),a.push("UNIUrlConnection *asyncConnection = [[UNIRest "+e.method(!0)+":^(UNISimpleRequest *request) {"),a.push('  [request setUrl:@"'+e.url()+'"];'),i.length&&a.push("  [request setHeaders:headers];"),o.length&&a.push("  [request setParameters:parameters];"),e.forPayload(function(e){a.push('  [request setBody:@"'+t.escapePayload(e)+'"];')}),a.push("}] as"+r+"Async:^(UNIHTTP"+r+"Response *response, NSError *error) {"),a.push("  NSInteger code = response.code;"),a.push("  NSDictionary *responseHeaders = response.headers;"),a.push("  UNIJsonNode *body = response.body;"),a.push("  NSData *rawBody = response.rawBody;"),a.push("}];"),a.join("\n")},ruby:function(e){function n(e){a[e]+=",",r=!0}var a=[],i=[],o=[],r=!1;return e.forEachHeader(function(e){i.push('    "'+e.name+'" => "'+e.value+'"')}),e.forEachFormParameter(function(e){switch(e.type){case"BINARY":o.push('    "'+e.name+'" => File.new("'+e.value+'")');break;case"BOOLEAN":case"NUMBER":o.push('    "'+e.name+'" => '+e.value);break;case"STRING":o.push('    "'+e.name+'" => "'+e.value+'"')}}),a.push("response = Unirest."+e.method(!0)+' "'+e.url()+'"'),i.length&&(n(a.length-1),a.push("  headers:{\n"+i.join(",\n")+"\n  }")),o.length&&(n(a.length-1),a.push("  parameters:{\n"+o.join(",\n")+"\n  }")),e.forPayload(function(e){a.push('  "'+t.escapePayload(e)+'"')}),a.join("\n")},cs:function(e){var n=[],a={JSON:{type:"JsonNode",invoker:"asJson"},BINARY:{type:"InputStream",invoker:"asBinary"},STRING:{type:"String",invoker:"asString"},XML:{type:"String",invoker:"asString"},TEXT:{type:"String",invoker:"asString"}},i=a[e.determineResponseType()];return n.push("Task<HttpResponse<MyClass>> response = Unirest."+e.method(!0)+'("'+e.url()+'")'),e.forEachHeader(function(e){n.push('.header("'+e.name+'", "'+e.value+'")')}),e.forEachFormParameter(function(e){switch(e.type){case"BINARY":n.push('.field("'+e.name+'", File.ReadAllBytes(@"'+e.value+'"))');break;case"NUMBER":case"BOOLEAN":n.push('.field("'+e.name+'", '+e.value+")");break;case"STRING":n.push('.field("'+e.name+'", "'+e.value+'")')}}),e.forPayload(function(e){n.push('.body("'+t.escapePayload(e)+'")')}),n.push("."+i.invoker+"();"),n.join("\n")}},a={languages:function(){return _.keys(n)},snippetForEndpoint:function(e,t,a){if(-1===this.languages().indexOf(e))throw new Error('Language "'+e+'" not supported.');return n[e](new M(t,a))}};e.SnippetBuilder=a,e.SnippetBuilderHelpers=t}("undefined"!=typeof Mashape?Mashape.DocumentationComponents:module.exports);var k=function(e,t,n){var a=hljs.highlight(t,e).value;return a},S=function(e,t){if("undefined"!=typeof e){var n={spaces:2,lang:void 0,lines:!0};t=$.extend(n,t||{});var a,i=e;if("json"===t.lang)try{"[object String]"===Object.prototype.toString.call(e)?a=JSON.parse(e):"[object Object]"===Object.prototype.toString.call(e)&&(a=e),i=JSON.stringify(a,null,t.spaces)}catch(o){i=e}return"undefined"!=typeof t.lang&&(i=k(i,t.lang,t.lines)),i}},T=function(e){~["JSON","XML"].indexOf(e.format)&&e.body&&""!==e.body&&(e.displayedBody.value=S(e.body),e.displayedBody.formatted=S(e.body,{lang:e.format.toLowerCase()}))};Mashape.DocumentationComponents.formatCode=S,Mashape.DocumentationComponents.formatModel=T,Mashape.DocumentationComponents.highlightCode=k;var x,C,A=$(window),P=$(document),E=Mashape.DocumentationComponents,w=E.Structures,I=E.Serializer,N=E.SnippetBuilder,O="_clone",R="_adding",F="_syncing",D="_editingMode",j="_editing",L="_isOwner",U="_language",q="_owner",H="_user",B="_api",G="_preview",z="_isMac",V="invisible",W="__ungrouped__",J={wheelSpeed:10,wheelPropagation:!0},Q=function(){this._init.apply(this,arguments)};Q.prototype={container:null,clipboards:{},transport:null,last:null,storage:null,offset:0,elements:Mashape.Elements({scrollspy:"body",tooltips:'[data-toggle="tooltip"]',editBox:".edit-box",backgroundSelector:".edit-background",offset:{header:".header",switcher:".switch-context",tabs:".tabs"},modals:{createApplication:"#create-app",appCreated:"#application-created",addAuthModalSelector:"#add-authentication"},perfectScroll:function(){return $(".endpoints-list-container, .preview pre, .model-preview")},footer:".special-api-footer"}),_init:function(e,t,n){C=window.instance=this,C.transport=n,C.transport.config.agent=t.proxyURL,this.storage=Mashape.Store("documentation."+e.api.id,{cache:4320}),window.container=this.container=x=new Ractive({el:e.el,template:e.template,data:this._preprocessData.apply(this,arguments),computed:{endpointsCount:function(){return _.reduce(x.get("groups"),function(e,t){return e+=t.endpoints.length},0)}}}),A.trigger("scroll"),this.elements.grabElements();for(var a in this.elements.offset)"$"===a[0]&&(this.offset+=this.elements.offset[a].outerHeight());this.elements.$scrollspy.scrollspy({target:"ul.endpoints",offset:C.offset}),Mashape.ApplicationForm.on("success",function(e,t,n,a){Mashape.utils.setupHeaderAppsDropdown(),a.button.enable(),C.elements.grabElements("modals"),C.elements.modals.$createApplication.modal("hide"),C.elements.modals.$appCreated.find(".bottom p").html("You just created the <b>"+e.name+"</b> application!"),C.elements.modals.$appCreated.find(".bottom a.btn").click(function(e){e.preventDefault(),e.stopPropagation(),C.elements.modals.$appCreated.modal("hide")}),C.elements.modals.$appCreated.modal("show");var i=x.get("applications").slice(0);i.push(e),x.set("applications",i),x.set("application",e.name)}),this._setupEventHandlers(),new I(x.data,C.transport).on("endpoint",function(e){C._udpateUIElementsForEndpoint(e.slugifiedPrimary)}).on("complete",function(){x.update("endpointsCount"),c(),C._setupObservers(),C.elements.perfectScroll().perfectScrollbar(J),C.elements.$tooltips.tooltip(),"undefined"==typeof e.user&&C._noUser(),setTimeout(function(){C._updateScrollSpy(),x.set("_loaded",!0),window.location.hash&&C.eventHandlers.scrollTo(window.location.hash),A.trigger("scroll"),A.trigger("resize"),x.set(z,"MacIntel"===navigator.platform),function(){for(var e=function(e){var t=function(){paw.open({a:e.target})};"undefined"==typeof paw?!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://d3prvxvd1wsnnz.cloudfront.net/js/paw.api.js",e.onload=t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}():t(),e.preventDefault()},t=document.getElementsByTagName("A"),n=0,a=t.length;a>n;n++){var i=t[n].href;i&&0===i.indexOf("paw://")&&t[n].addEventListener("click",e)}}()},0)}).fetchDocumentation()},_preprocessData:function(e,t){var n=e.isOwner?"undefined"!=typeof m()?m().editing:!0:!1;if(g({editing:n}),e.oauth&&"undefined"!=typeof e.oauth){var a={};_.each(e.oauth,function(t,n){"Product Hunt"===e.api.name&&"token_type"===n&&(t="Bearer"),~["access_token","token_type","access_secret"].indexOf(n)&&(a[n]=t)}),g({oauth:a})}return t.authentication.length&&v(t.authentication[0].type)&&this._preprocessOAuth(t.authentication[0]),t[H]=e.user,t[q]=e.owner,t[B]=e.api,t[D]=n,t[L]=e.isOwner,t[U]={bash:!0},t[R]={endpoint:[],authentication:[]},t._isUserInput=function(e){return-1!==["basic","header","oauth1","oauth2"].indexOf(e.toLowerCase())},t._isOAUTH=v,t._parameterNameForAuthentication=function(e){return{BASIC:"parameter",QUERY:"parameter",HEADER:"header",OAUTH1:"scope",OAUTH2:"scope"}[e]},t},_preprocessOAuth:function(e){var t=m().oauth;if(e.oauth_headers=[],"2"===e.type.slice(-1))e.oauth_headers.push({display_name:"Access Token",saving_name:"access_token",name:"Authorization",value:"undefined"!=typeof t?t.access_token:"",token_type:"undefined"!=typeof t?t.token_type:""});else{var n=[{display_name:"Consumer Key",name:"X-Mashape-OAuth-ConsumerKey",saving_name:"consumer_key"},{display_name:"Consumer Secret",name:"X-Mashape-OAuth-ConsumerSecret",saving_name:"consumer_secret"},{display_name:"Access Token",name:"X-Mashape-OAuth-AccessToken",saving_name:"access_token"},{display_name:"Access Secret",name:"X-Mashape-OAuth-AccessSecret",saving_name:"access_secret"}];_.each(n,function(n){e.oauth_headers.push({display_name:n.display_name,saving_name:n.saving_name,name:n.name,value:"undefined"!=typeof t?t[n.saving_name]:""})})}},_udpateUIElementsForEndpoint:function(e,t){var n=$('section.endpoint[id="'+e+'"]'),a=n.find(".response pre.route-container");a.find(C.elements.tooltips).tooltip({trigger:"manual"}),a.off("mouseenter mouseleave"),a.on("mouseenter",function(){x.get(D)&&$(this).find("div").tooltip("show")}),a.on("mouseleave",function(){$(this).find("div").tooltip("hide")}),t&&n.find(".preview pre, .model-preview").perfectScrollbar(J)},_updateScrollSpy:function(){var e=$(C.elements.scrollspy);e.data("bs.scrollspy").options.offset=C.offset,e.scrollspy("refresh")},_noUser:function(){P.on("focus",".documentation input",function(e){e.preventDefault(),x.fire("promptRegister",null)})},_setupObservers:function(){function t(e,t){return function(n,a,i){if("undefined"!=typeof n&&"undefined"!=typeof a&&n!==e){var o=i.replace(/[^.]*$/,t);x.set(o,n),x.set(i,e)}}}x.observe("application",function(e,t,n){"create-application"===e?(C.elements.grabElements("modals"),C.elements.modals.$createApplication.modal("show"),C.elements.modals.$createApplication.on("hidden.bs.modal",function(){"create-application"===x.get("application")&&x.set(n,t)})):"undefined"!=typeof e&&C._updateEnvironment(e)}),x.observe("authentication.0",function(e){if("undefined"!=typeof e&&"BASIC"===e.type){if(e.parameters.length)return;e.parameters=[{name:"Authorization",value:""}],x.set("authentication.0",e)}}),x.observe("groups.*.endpoints.*.parameters.* groups.*.endpoints.*.payload.model.*.displayedBody.value",function(t,n,a){"undefined"!=typeof n&&d(e(a,"endpoint"))}),x.observe("authentication.0.parameters.*",function(e,t){"undefined"!=typeof t&&c()}),x.observe("authentication.0.oauth_headers.*",function(e,t){if("undefined"!=typeof t){c();var n={};n[e.saving_name]=e.value,g({oauth:n})}}),x.observe("groups.*.endpoints.*.response.selectedModelId groups.*.endpoints.*.payload.selectedModelId",t("add-model","modelId")),x.observe("groups.*.endpoints.*.response.modelId groups.*.endpoints.*.payload.modelId",function(t,n,i){if("undefined"!=typeof n&&"undefined"!=typeof t&&""!==t){var o,r=e(i,"payloadOrResponse").split(".").pop(),s=e(i,"endpoint"),l=[s,r,R].join(".");x.get([s,r,F].join("."))||(o="new-model"===t?$.extend(!0,{},w.model):$.extend(!0,{},_.find(x.get("models"),{id:t})),a({keypath:l},"payloadOrResponse",o))}}),P.on("change",'.parameter input[type="file"]',function(e){var t=$(e.target),n=t.prop("files");if(n.length){var a,i=t.parents(".endpoint").attr("id"),o=t.attr("id");_.each(x.get("groups"),function(e,t){_.each(e.endpoints,function(e,n){e.slugifiedPrimary===i&&(a=["groups",t,"endpoints",n].join("."))})}),_.each(x.get(a).parameters.form,function(e){e.slugifiedPrimary===o&&(e.value=n.item(0).name,e.inputSlug=o)}),d(a)}})},_updateEnvironment:function(e){var t=_.find(x.get("applications"),{name:e});if("undefined"!=typeof t){var n=_.find(t.environments.data,{name:Mashape.CONSTANTS.MASHAPE_AUTH_HEADER_DEFAULT_ENVIRONMENT}).key;x.set(Mashape.CONSTANTS.MASHAPE_AUTH_HEADER,n),_(x.get("groups")).each(function(e){_(e.endpoints).each(function(e){var t=_.find(e.parameters.header,{name:Mashape.CONSTANTS.MASHAPE_AUTH_HEADER});t?t.value=n:e.parameters.header.push({name:Mashape.CONSTANTS.MASHAPE_AUTH_HEADER,value:n})})}),c()}},_setupEventHandlers:function(){var e=this.eventHandlers;_.each(e,function(e,t){"object"==typeof e?x.on(t,function(t,n){"function"==typeof e[n]?e[n].apply(x,arguments):console.warn("Event was called, but no handler was found.")}):"function"==typeof e&&x.on(t,e)}),A.on("click.editor",s),$("#create-group, #edit-group, #add-authentication").on("shown.bs.modal",function(){$(this).find("input").first().focus()})},eventHandlers:{promptRegister:function(){var e=x.get(B),t=e.pricing===Mashape.CONSTANTS.PRICE_PAID?"<strong>Join</strong> for access to this API":"<strong>Consume this API</strong> for free";Mashape.utils.registerPrompt({title:t,subtitle:e.name+" API"})},promptAuthorize:function(e){
return"undefined"==typeof x.get(H)?x.fire("promptRegister",e):void $(C.elements.modals.addAuthModalSelector).modal().show()},setLanguage:function(e,t){var n={};n[t]=!0,x.set(U,n),c()},scrollTo:l,setupAuthentication:function(e){e.original.preventDefault(),e.original.stopPropagation();var t=$(C.elements.modals.addAuthModalSelector),n=x.get("authentication.0");if("BASIC"===n.type){var a=t.find('input[name="username"]').val(),i=t.find('input[name="password"]').val(),o=window.btoa(a+":"+i);x.set("authentication.0.parameters.0.value","Basic "+o)}else{if(x.data._isOAUTH(n.type)){var r={};t.find("input[type=text]").each(function(e,t){r[t.name]=t.value}),g({oauth:r});var s=[];t.find("input[type=checkbox]").each(function(e,t){this.checked&&s.push(t.value)}),r.scope=s.join(n.scope_separator),r.callback=window.location.href;var l=x.data.production_test_console?"https://"+x.data.publicURL:x.data.proxyURL,p={};return p[Mashape.CONSTANTS.MASHAPE_HOST_HEADER]=x.data.publicURL,p[Mashape.CONSTANTS.MASHAPE_AUTH_HEADER]=x.data[Mashape.CONSTANTS.MASHAPE_AUTH_HEADER],C.transport.create("oauth",r,{url:l,headers:p}).done(function(e){window.location=e.url})}t.find("input[type=text]").each(function(e,t){x.set("authentication.0.parameters."+e+".value",t.value)}),c()}t.modal("hide")},generate:function(t){var a=e(t,"endpoint"),i=x.get(a);i[F]||(x.set([a,F].join("."),!0),async.waterfall([function(e){(new E.TestConsole).request(i,x.data).on("aborted",function(){var t=Mashape.Store("api").get();return analytics.track("api_not_responding",{group:"ajax",category:"ajax",api_name:t.name,api_visibility:t.visibility,api_link:window.location.pathname}),e(new Error("Aborted test request"))}).on("done",function(t,n,a,o,r){var s=$.extend(!0,{},w.model);return s.name=i.name+" model","BINARY"!==r&&(s.body=o.asRaw),s.format=r,s.displayedBody.formatted=o.asFormatted,e(null,s,a)})},function(e,t,n){C.transport.get("model",{query:{name:e.name}}).fail(function(e){return n(e)}).done(function(a,i,o){var r;if(a.data.length){var s=0;return _.each(x.get("models"),function(e){e.id===a.data[0].id&&(r=s),s++}),n(null,e,t,r)}return n(null,e,t,r)})},function(e,t,n,a){return"undefined"==typeof n?a(null,e,t):void r({keypath:["models",n].join(".")},"model").fail(function(e){return a(e)}).done(function(){return a(null,e,t)})},function(e,a,i){n(t,"response",e).fail(function(e){return i(e)}).done(function(e){async.each(a.asArray,function(a,i){var o=$.extend(!0,{},w.parameter.header);o._modelId=e.id,o.name=a.name,o.value=a.value,n($.extend(!0,{},t,{keypath:[t.keypath,"model","0"].join(".")}),"response.header",o,!1).always(Mashape.utils.asyncAlways(i))},i)})}],function(e,t){x.set([a,F].join("."),!1),e&&console.error("error in generate response flow:",e)}))},test:function(t,n){if("undefined"==typeof x.get(H))return x.fire("promptRegister",t);x.set("groups.*.endpoints.*."+G,{});var a=e(t,"endpoint"),i=[a,G].join("."),o=x.get(a),r=$.extend(!0,{},w.consoleResponse);if(!o[F]){if(x.set([i,"show"].join("."),!0),C.eventHandlers.scrollTo(".preview.in",{rightPanel:!0,hash:!1}),$(t.node).parents(".endpoint").find(".preview .reopen").hide(),"undefined"==typeof x.get(Mashape.CONSTANTS.MASHAPE_AUTH_HEADER))return r.errors.needAppKey=!0,r.done=!0,void x.set(i,r);x.set([a,F].join("."),!0),analytics.track("Test console",{group:"ajax",category:"ajax",label:window.location.pathname,section:"body",page:"api",subpage:"documentation",authenticate:!0}),(new E.TestConsole).request(o,x.data,n).on("progress",function(e,t){x.set([i,"percent"].join("."),(t?"Uploading":"Downloading")+": "+e.toFixed()+"%")}).on("aborted",function(e){var t=Mashape.Store("api").get();analytics.track("api_not_responding",{group:"ajax",category:"ajax",api_name:t.name,api_visibility:t.visibility,api_link:window.location.pathname}),r.aborted=!0,r.errors.oversized=e}).on("done",function(e,t,a,i,o,s){n&&window.saveAs(t,"response"),r.errors.needSubscription=402===e.status,r.errors.clientError=e.status>=400&&e.status<500&&"true"!==a.asObject["X-Mashape-Proxy-Response"],r.errors.serverError=e.status>=500&&"true"!==a.asObject["X-Mashape-Proxy-Response"];var l="HTTP/1.1 "+e.status.toString()+" "+e.statusText;r.status=E.highlightCode(l,"http"),r.headers=E.highlightCode(a.asString,"http"),r.formatted=i.asFormatted,r.toCopy="BINARY"!==o?i.asRaw:null,r.blobURL=s}).on("always",function(){r.done=!0,x.set([a,F].join("."),!1),x.set(i,r);var e=$(".preview.in span.fa-copy"),t=$(".preview.in .copied"),n=t.css("color"),o=new ZeroClipboard(e);o.on("aftercopy",function(){e.css("color","green"),t.show(),setTimeout(function(){e.css("color",n),t.hide()},2e3)})})}},download:function(e){x.fire("test",e,!0)},add:{endpoint:function(e){a(e,"endpoint")},authentication:function(e){a(e,"authentication")},group:function(){},"response.header":function(e){a(e,"response.header")},"parameter.header":function(e){a(e,"parameter.header")},"parameter.route":function(e){a(e,"parameter.route")},"parameter.query":function(e){a(e,"parameter.query")},"parameter.form":function(e){a(e,"parameter.form")},"parameter.authentication":function(e){a(e,"parameter.authentication")}},cancel:{authentication:function(e){o(e,"authentication")},endpoint:function(e){o(e,"endpoint")},parameter:function(e){o(e,"parameter")},payloadOrResponse:function(t){o(t,"payloadOrResponse"),x.set([e(t,"payloadOrResponse"),"selectedModelId"].join("."),"")},"response.header":function(e){o(e,"response.header")},last:function(){"undefined"!=typeof C.last&&o(C.last.event,C.last.type.split(".")[0])}},edit:{authentication:function(e){t(e,"authentication",!0)},endpoint:function(e){t(e,"endpoint",!0)},payloadOrResponse:function(e){t(e,"payloadOrResponse",!0)},body:function(e){if(!x.get(D)&&"responseModel"!==e.context.property){var t=[e.keypath,j].join(".");x.toggle(t),x.get(t)||x.set([e.keypath,"displayedBody.value"].join("."),x.get([e.keypath,"body"].join(".")))}},parameter:function(e){x.get(D)&&t(e,"parameter",!0)},"response.header":function(e){t(e,"response.header",!0)},group:function(e){var t=x.get([e.keypath,"name"].join("."));x.set([e.keypath,"_name"].join("."),t),$("#edit-group").data("keypath",e.keypath).find('input[name="name"]').val(t)}},toggle:{dropdown:function(e){var t=$(e.node).parent(),n="open",a=s();t.addClass(n),a.hasClass(n)&&a.removeClass(n),e.original.stopPropagation()},context:function(e){x.toggle(D),x.set(["groups.*.endpoints.*.payload.model.*",j].join("."),!1),g({editing:x.get(D)}),C._updateScrollSpy()},preview:function(t){var n=[e(t,"endpoint"),G].join("."),a=x.get(n);$("body").css("overflow",""),x.set([n,"fullscreen"].join("."),!1),x.set([n,"show"].join("."),!a.show);var i=$(t.node).parents(".preview"),o=i.find(".reopen");if(a.show)x.toggle([n,"backarrow"].join(".")),o.hide();else{var r=1e3*parseFloat(i.css("transition-duration"),10);setTimeout(function(){o.show(),setTimeout(function(){x.toggle([n,"backarrow"].join("."))},50)},r)}},fullscreen:function(e){var t=[e.keypath,G,"fullscreen"].join("."),n=!x.get(t);x.set(t,n),$("body").css("overflow",n?"hidden":""),n||C.eventHandlers.scrollTo(".preview.in",{rightPanel:!0,hash:!1})}},create:{authentication:function(e){n(e,"authentication")},endpoint:function(e){n(e,"endpoint")},parameter:function(e){n(e,"parameter")},"response.header":function(e){n(e,"response.header")},group:function(e){n(e,"group")}},updateEntity:{authentication:function(e){i(e,"authentication")},endpoint:function(e){i(e,"endpoint")},parameter:function(e){i(e,"parameter")},"response.header":function(e){i(e,"response.header")},group:function(e){i(e,"group")}},put:{payloadOrResponse:function(t){var a=e(t,"payloadOrResponse").split(".").pop(),o=x.get([e(t,"payloadOrResponse"),R,"0"].join("."));"undefined"==typeof o.id?n(t,a):i(t,a)}},"delete":{authentication:function(e){r(e,"authentication")},endpoint:function(e){r(e,"endpoint")},payloadOrResponse:function(t){var n=e(t,"payloadOrResponse").split(".").pop();r(t,n)},group:function(e){r(e,"group")},parameter:function(e){r(e,"parameter")},"response.header":function(e){r(e,"response.header")}}}},E.UI=Q;var Y=function(){this._init.apply(this,arguments)};Y.prototype={config:{prefix:"/api/internal",backend:"/api/middleware",owner:{},api:{}},_init:function(e){this.config.owner=e.owner,this.config.api=e.api},get:function(e,t){arguments.length<2&&(t=e),t=t||{};var n=this.config,a={type:"get",dataType:"json",xhrFields:{withCredentials:!0},url:t.url||"",error:y},i={documentation:function(){a.url=[n.prefix,n.owner.slug,"apis",n.api.id,"current"].join("/")},documentation_template:function(){a.url="/templates/Documentation/documentation_template",a.dataType="text"},model:function(){a.url=[n.backend,"accounts",n.owner.slug,"apis",n.api.id,"versions","current","models",""].join("/")}};return"function"==typeof i[e]?i[e]():2===arguments.length&&console.warn("There is no resource of type: "+e.toString()),t.query&&(a.url+=query.build(t.query)),$.ajax(a)},create:function(e,t,n){t=t||{},n=n||{};var a=this.config,i={type:"post",headers:n.headers||null,dataType:"json",data:{},xhrFields:{withCredentials:!0},url:n.url||[a.backend,"accounts",a.owner.slug,"apis",a.api.id,"versions","current"].join("/"),error:y},o={},r={authentication:function(){var e=["type","description"],n=t.type.toLowerCase(),a=["oauth1","oauth2"];~a.indexOf(n)&&(e.push("legs","authorization_url","access_token_url","scope_separator"),n===a[0]&&e.push("request_token_url","signature","oauth_token"),n===a[1]&&e.push("grant_type"));for(var r in t)~e.indexOf(r)&&(o[r]=t[r]);i.url+="/authentication",i.data=o},endpoint:function(){var e=["name","route","code","method","group","description"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);"__ungrouped__"===t.group&&(o.group=null),i.url+="/endpoints/",i.data=o},group:function(){var e=["name","index"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+="/groups/",i.data=o},model:function(){var e=["name","body","description","format"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+="/models/",i.data=o},"response.header":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+=["","models",t._modelId,"headers",""].join("/"),i.data=o},"parameter.header":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+=["","endpoints",t._endpointSlug,"headers",""].join("/"),i.data=o},"parameter.route":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+=["","endpoints",t._endpointSlug,"routeparameters",""].join("/"),i.data=o},"parameter.query":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);o.querystring=!0,i.url+=["","endpoints",t._endpointSlug,"routeparameters",""].join("/"),i.data=o},"parameter.form":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+=["","endpoints",t._endpointSlug,"parameters",""].join("/"),i.data=o},"parameter.authentication":function(){var e=["name","description"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+="/authentication/parameters/",i.data=o},oauth:function(){var e=["scope","client_id","client_secret","consumer_key","consumer_secret","callback"];for(var n in t)~e.indexOf(n)&&(o[n]=t[n]);i.url+="/oauth_url",i.data=o}};return"function"==typeof r[e]?r[e]():console.warn("There is no resource of type: "+e.toString()),$.ajax(i)},update:function(e,t){t=t||{};var n=this.config,a={type:"patch",dataType:"json",data:{},xhrFields:{withCredentials:!0},url:[n.backend,"accounts",n.owner.slug,"apis",n.api.id,"versions","current"].join("/"),error:y},i={},o={authentication:function(){var e=["type","description"],n=t.type.toLowerCase(),o=["oauth1","oauth2"];~o.indexOf(n)&&(e.push("legs","signature","authorization_url","access_token_url"),n===o[0]&&e.push("request_token_url"),n===o[1]&&e.push("access_token_name","grant_type"));for(var r in t)~e.indexOf(r)&&(i[r]=t[r]);a.url+="/authentication",a.data=i},endpoint:function(){var e=["name","route","code","method","group","description","payload","response"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);"__ungrouped__"===t.group&&(i.group=null),a.url+="/endpoints/"+encodeURIComponent(t.id),a.data=i},group:function(){var e=["name","index"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+="/groups/"+encodeURIComponent(t.id),a.data=i},model:function(){var e=["name","body","description","format"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+="/models/"+encodeURIComponent(t.id),a.data=i},"response.header":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+=["","models",encodeURIComponent(t._modelId),"headers",encodeURIComponent(t.id)].join("/"),a.data=i},"parameter.header":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+=["","endpoints",encodeURIComponent(t._endpointSlug),"headers",encodeURIComponent(t.id)].join("/"),a.data=i},"parameter.route":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+=["","endpoints",encodeURIComponent(t._endpointSlug),"routeparameters",encodeURIComponent(t.id)].join("/"),a.data=i},"parameter.query":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+=["","endpoints",encodeURIComponent(t._endpointSlug),"routeparameters",encodeURIComponent(t.id)].join("/"),a.data=i},"parameter.form":function(){var e=["name","description","type","value","condition"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+=["","endpoints",encodeURIComponent(t._endpointSlug),"parameters",encodeURIComponent(t.id)].join("/"),a.data=i},"parameter.authentication":function(){var e=["name","description"];for(var n in t)~e.indexOf(n)&&(i[n]=t[n]);a.url+="/authentication/parameters/"+encodeURIComponent(t.id),a.data=i}};return"function"==typeof o[e]?o[e]():console.warn("There is no resource of type: "+e.toString()),$.ajax(a)},"delete":function(e,t){t=t||{};var n=this.config,a={type:"delete",xhrFields:{withCredentials:!0},url:[n.backend,"accounts",n.owner.slug,"apis",n.api.id,"versions","current"].join("/"),error:y},i={authentication:function(){a.url+="/authentication"},endpoint:function(){a.url+="/endpoints/"+encodeURIComponent(t.id)},group:function(){a.url+="/groups/"+encodeURIComponent(t.id)},model:function(){a.url+="/models/"+encodeURIComponent(t.id||encodeURIComponent(t.name))},"response.header":function(){a.url+="/models/"+encodeURIComponent(t._modelId)+"/headers/"+encodeURIComponent(t.id)},"parameter.header":function(){a.url+=["","endpoints",encodeURIComponent(t._endpointSlug),"headers",encodeURIComponent(t.id)].join("/")},"parameter.route":function(){a.url+="/endpoints/"+encodeURIComponent(t._endpointSlug)+"/routeparameters/"+encodeURIComponent(t.id)},"parameter.query":function(){a.url+="/endpoints/"+encodeURIComponent(t._endpointSlug)+"/routeparameters/"+encodeURIComponent(t.id)},"parameter.form":function(){a.url+="/endpoints/"+encodeURIComponent(t._endpointSlug)+"/parameters/"+encodeURIComponent(t.id)},"parameter.authentication":function(){a.url+="/authentication/parameters/"+encodeURIComponent(t.id)}};return"function"==typeof i[e]?i[e]():console.warn("There is no resource of type: "+e.toString()),$.ajax(a)}},Mashape.DocumentationComponents.Transport=Y,Mashape.DocumentationComponents.TestConsole=function(){var e=Mashape.DocumentationComponents,t=["access-control-allow-origin","access-control-expose-headers","access-control-allow-credentials"],n=function(e){var t="";if(e)for(var n=e.split("-"),a=0;a<n.length;a++){var i=n[a];t+=i.substring(0,1).toUpperCase(),t+=i.substring(1).toLowerCase(),a<n.length-1&&(t+="-")}return t},a=function(){return this.events={progress:function(){},aborted:function(){},done:function(){},always:function(){}},this};return a.prototype.on=function(e,t){return this.events[e]=t,this},a.prototype.request=function(t,n,a){var i=this,o=new e.Builder(t,n,!0),r=o.isMultipart()?new FormData:"";o.forPayload(function(e){r=e.displayedBody.value}),o.forEachFormParameter(function(e){if(o.isMultipart())if("BINARY"===e.type){var t=$('input[id="'+e.inputSlug+'"]');if(!t.length)return;var n=t.prop("files");r.append(e.name,n.item(0))}else r.append(e.name,e.value);else r+=(r.length?"&":"")+e.name+"="+e.value});var s=new XMLHttpRequest;s.open(o.method(),o.url()),o.forEachHeader(function(e){s.setRequestHeader(e.name,e.value)}),o.isMultipart()&&(s.upload.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;i.events.progress(t,!0)}}),s.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;i.events.progress(t,!1)}};var l=!1;return s.timeout=3e4,s.ontimeout=function(){l=!0,i.events.aborted(),i.events.always()},s.onreadystatechange=function(){2===s.readyState&&!a&&s.getResponseHeader("content-length")>Mashape.CONSTANTS.CONSOLE_MAX_CONTENT_LENGTH&&(l=!0,i.events.aborted(!0),s.abort()),4===s.readyState&&(0!==s.status||l||(i.events.aborted(),i.events.always()))},s.onload=function(){var e=this.response.slice(0,this.response.size,this.response.type);i.formatResponse(e,function(t,n,a){i.events.done(s,e,i.formatHeaders(s),t,a.toUpperCase(),n),i.events.always()})},s.responseType="blob",s.send(o.canHavePayload()?r:null),this},a.prototype.formatResponse=function(t,n){function a(e){var t=["json","xml","html","javascript"];return-1!==e.indexOf("plain")?"plain":(i=e.match(new RegExp(t.join("|"))),i&&i.length?"formatting":void 0)}if(!t)return n();var i,o=URL.createObjectURL(t);switch(a(t.type)){case"plain":this.blobToString(t,function(e){n({asRaw:e,asFormatted:e},o,"text")});break;case"formatting":this.blobToString(t,function(t){n({asRaw:t,asFormatted:e.formatCode(t,{lang:i[0],lines:!1})},o,~["json","xml"].indexOf(i[0])?i[0]:"text")});break;default:n({asRaw:t,asFormatted:'<object data="'+o+'" type="'+t.type+'"></object>'},o,"binary")}},a.prototype.formatHeaders=function(e){var a=e.getAllResponseHeaders().trim().split("\n"),i={},o="",r="";_.each(a,function(e){var t=e.split(/:(.+)/),a=n(t[0]);i[a]=t[1].trim()});var s=_(i).keys().sort().reduce(function(e,n){return o+=[n,i[n]].join(": ")+"\n",-1===t.indexOf(n.toLowerCase())&&(r+=[n,i[n]].join(": ")+"\n",e.push({name:n,value:i[n]})),e},[]);return{asArray:s,asObject:i,asString:r,asStringComplete:o}},a.prototype.blobToString=function(e,t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsText(e)},a}();var K=function(){this._init.apply(this,arguments)};K.prototype._defaults={el:".documentation-container",template:""},K.prototype._init=function(e){var t=this;e="object"==typeof e?e:{};for(var n in this._defaults)e[n]||(e[n]=this._defaults[n]);this.options=e,this.transport=new Mashape.DocumentationComponents.Transport(e);var a=Mashape.Store("extras").get(),i=Mashape.DocumentationComponents.Serializer.serializeRoot(a),o=(new Date).getTime();this.transport.get("documentation_template").then(function(e){i.timers.template=((new Date).getTime()-o)/1e3,t.options.template=e.replace(/\n/g,""),t.UI=new Mashape.DocumentationComponents.UI(t.options,i,t.transport)})},K.prototype.destroy=function(){this.UI.container&&this.UI.container.teardown(),$(window).off(".editor")},Mashape.DocumentationProfile=K;var E=Mashape.DocumentationComponents,w=E.Structures,X=null,Z="__ungrouped__",ee="endpoints",te=["status","visibility","creationDate","updateDate","took"],I=function(e,t){X=this,this.events={endpoint:function(){},complete:function(){}},this.data=e,this.transport=t,this.versionURL=[t.config.backend,"accounts",t.config.user,"apis",t.config.api.id,"versions","current"].join("/")};I.serializeModel=function(e,t){var n=["headers"],a="undefined"!=typeof e.headers?e.headers.data:[];e=_.omit(e,n.concat(te));var i=b(w.model,e);return E.formatModel(i),_.each(a,function(e){e._modelId=i.id,i.headers.push(_.omit(e,te))}),i},I.prototype.on=function(e,t){return this.events[e]=t,this},I.serializeRoot=function(e){var t=e||{};return t.groups=[],t.applications=[],t.authentication=I.serializeAuthentication(t.authentication),t},I.serializeAuthentication=function(e){if("undefined"==typeof e)return[];var t=["parameters"],n=e.parameters?e.parameters.data:[],a=_.omit(e,t.concat(te));return a.parameters=[],_.each(n,function(e){a.parameters.push(_.omit(e,te))}),[a]},I.prototype.fetchDocumentation=function(){var e=(new Date).getTime(),t=X.data;return X.transport.get("documentation").then(function(n){if(X.data.timers.doc_request=((new Date).getTime()-e)/1e3,e=(new Date).getTime(),t.models=[],_.each(n.models.data,function(e){t.models.push(I.serializeModel(e))}),_.each(n.applications,function(e){t.applications.push(_.omit(e,te))}),t.applications&&t.applications.length){var a=_.find(t.applications,{name:"Default Application"}),i="undefined"!=typeof a?a:t.applications[0];t.application=i.name;var o=_.find(i.environments.data,{name:Mashape.CONSTANTS.MASHAPE_AUTH_HEADER_DEFAULT_ENVIRONMENT}).key;X[Mashape.CONSTANTS.MASHAPE_AUTH_HEADER]=o}else t.application="default";var r=_.groupBy(n.endpoints.data,function(e){return e.group?e.group.id:Z});_.each(_.sortBy(n.groups.data,"index"),function(e){e.endpoints=[],X.data.groups.push(_.omit(e,te))});var s=_.max(n.groups.data,function(e){return e.index||0}),l={id:Z,slugifiedPrimary:ee,name:"Endpoints",index:s.index+1,endpoints:[]};t.groups.push(_.omit(l,te)),_.each(t.groups,function(e){_.each(_.sortBy(r[e.id],"routeindex"),function(t){var n=X.serializeEndpoint(t);e.endpoints.push(n),X.events.endpoint(n)})}),X.data.timers.serialization=((new Date).getTime()-e)/1e3,X.events.complete()}),this},I.prototype.serializeEndpoint=function(e){function t(e,t){var n=b(w.parameter[e],t);return _.omit(n,te)}var n=["headers","routeparameters","parameters","payload","response"],a=e.parameters.data||[],i=e.headers.data||[],o=e.routeparameters.data||[],r=e.payload,s=e.response;e=_.omit(e,n.concat(te));var l=b(w.endpoint,e);return l.group=e.group?e.group.id:Z,l.host=X.data.production_test_console?"https://"+X.data.publicURL:X.data.proxyURL,l.parameters.header.push({name:Mashape.CONSTANTS.MASHAPE_AUTH_HEADER,value:X.data[Mashape.CONSTANTS.MASHAPE_AUTH_HEADER],condition:"REQUIRED"}),_.each(i,function(n){n._endpointSlug=e.slugifiedPrimary,l.parameters.header.push(t("header",n))}),_.each(o,function(n){n._endpointSlug=e.slugifiedPrimary,n.querystring?l.parameters.query.push(t("query",n)):l.parameters.route.push(t("route",n))}),_.each(a,function(n){n._endpointSlug=e.slugifiedPrimary,l.parameters.form.push(t("form",n))}),l.payload={modelId:"",model:[],_adding:{}},"undefined"!=typeof r&&(l.payload.modelId=r.id,l.payload.model=[I.serializeModel(r,e)],l.payload.model[0].property="payloadModel"),l.response={modelId:"",model:[],_adding:{}},"undefined"!=typeof s&&(l.response.modelId=s.id,l.response.model=[I.serializeModel(s,e)],l.response.model[0].property="responseModel"),l},Mashape.DocumentationComponents.Serializer=I}.call(this),function(){var e=$(document),t=$(window),n={minWidth:500,minHeight:250,maxWidth:3e3,maxHeight:3e3,minSize:0,maxSize:5120,types:["image/png","image/jpeg","image/jpg","image/gif"]},a=Mashape.Section({namespace:".documentation",scrollViews:{},elements:Mashape.Elements({logo:".profile .head .image img",topSignupBar:".profile.api .head .popover",pricing:{editor:".pricing.editor",container:".pricing-container",editorContainer:".pricing-editor",subscribeButton:".btn.subscribe",contactButton:".pricing-contact .btn"},unsubscribe:{form:"form.form-unsubscribe",inputUnsubscribe:"form.form-unsubscribe input",buttonUnsubscribe:'form.form-unsubscribe button[type="submit"]'}}),routing:function(e){this.priority(this.priority.low).scope("/:account/:api",function(){this.base(e(void 0,{notFoundView:"api-not-found"}),a.profile),this.get("/pricing",e(),a.pricing),this.get("/pricing/custom",e(),a.customPricing),this.get("/pricing/custom/:plan",e(),a.customPricingPlan),this.get("/unsubscribe",e(),a.unsubscribe),this.get("/:page",e())})},teardown:function(t){e.off(a.namespace),this.editor&&this.editor.destroy(),this.subscriptionFlow&&this.subscriptionFlow.destroy();for(var n in a.scrollViews)a.scrollViews[n].teardown()},profile:function(e){a.setupEvents(),a.setupAutofix();var t=query.parse(),n=Mashape.user?Mashape.user:void 0,i=$(".documentation-container"),o=$("#account-register"),r={name:i.data("owner-name").toString().trim(),slug:i.data("owner-slug").toString().trim()},s={id:i.data("api-id").trim(),slug:i.data("api-slug").toString().trim(),name:i.data("api-name").toString().trim(),pricing:i.data("api-pricing").toString().trim(),visibility:i.data("api-visibility").toString().trim()};this.editor=new Mashape.DocumentationProfile({isOwner:(n?n.slug:"")===r.slug,user:n,owner:r,api:s,oauth:"undefined"!=typeof t?t:null}),window.history.replaceState&&window.history.replaceState(null,null,window.location.href.split("?")[0]),$("#account-login").find(".login-redirect").val(window.location.href),o.find(".register-redirect").val(window.location.href),n||a.elements.$topSignupBar.on("click",function(){var e=s.pricing===Mashape.CONSTANTS.PRICE_PAID?"<strong>Join</strong> for access to this API":"<strong>Consume this API</strong> for free";o.find("form.register").append('<input type="hidden" name="fromAPIProfile" value="true" />'),Mashape.utils.registerPrompt({title:e,subtitle:s.name+" API"}),$(this).hide()})},pricing:function(t){var n,i;if(Mashape.Documentation.setupEvents(),n=Mashape.user,i=a.elements.pricing.$container.data(),a.elements.pricing.$subscribeButton.attr("disabled",!0),e.on("click"+a.namespace,a.elements.pricing.contactButton,function(e){e.stopPropagation(),e.preventDefault();var t="/"+i.owner+"/"+i.name+"/support/new?type=private",a=$("#account-register");n?window.location=t:(a.find(".register-redirect").val(t),a.modal("show"))}),i.editing){var o=Mashape.client.fetchVersionPricing(i.owner,i.name,i.version);e.on("click"+a.namespace,".dropdown-menu input, .dropdown-menu label",function(e){e.stopPropagation()}),o.done(function(e,o,r){var s=$.get(t.fullPath+"?template=true");s.done(function(t){a.Editor=new Mashape.Billing.Editor({element:a.elements.pricing.editorContainer,elements:a.elements,template:t,data:e,api:i,user:n})})}),o.fail(function(e,t){"abort"!==e.statusText.toLowerCase()&&console.error("Unable to fetch pricing information.")})}else this.subscriptionFlow=new Mashape.Subscribe({user:n,api:i}).on("ready",function(){a.elements.pricing.$subscribeButton.attr("disabled",!1)}),$('[data-toggle="tooltip"]').tooltip()},customPricing:function(e){var t=Mashape.user,n=a.elements.pricing.$container.data();if(n.editing){var i=Mashape.client.fetchVersionPrivatePlans(n.owner,n.name,n.version);i.success(function(i,o,r){var s=$.get(e.fullPath+"?template=true");s.done(function(e){a.Editor=new Mashape.Billing.Editor({custom:!0,element:a.elements.pricing.editorContainer,elements:a.elements,template:e,data:{plans:i.data,next:i.next,previous:i.previous},api:n,user:t})})}),i.fail(function(e,t){"abort"!==e.statusText.toLowerCase()&&console.error("Unable to fetch pricing information.")})}},customPricingPlan:function(e){var t=Mashape.user,n=a.elements.pricing.$container.data();this.subscriptionFlow=new Mashape.Subscribe({user:t,api:n}).on("ready",function(){a.elements.pricing.$subscribeButton.attr("disabled",!1)})},unsubscribe:function(e){a.elements.grabElements("unsubscribe"),a.elements.unsubscribe.$inputUnsubscribe.keyup(function(e){a.elements.unsubscribe.$buttonUnsubscribe.attr("disabled","unsubscribe"!==this.value.toLowerCase())}),new Mashape.FormComponent(a.elements.unsubscribe.form,{handleButtonState:!1}).on("submit",function(t,n){t.button.disable(),Mashape.client.unsubscribeFromApi(e.params.account,e.params.api,"current").always(n)}).on("error",function(e,t,n){n.button.enable()}).on("success",function(t){window.location=["",e.params.account,e.params.api,"questionnaire"].join("/")})}});a.setupPricingAutofix=function(){var e,n,i,o,r,s=$(".profile .tabs"),l=$(".header"),c=$(".profile .head"),p=$(".pricing-container .action-bar");t.on("scroll"+a.namespace,function(){p.is(":visible")||(p=$(".pricing-container .action-bar")),o=s.outerHeight(),n=c.outerHeight()+o,e=t.scrollTop(),r=p.outerHeight(),e>=n?(i=l.outerHeight(),p.css("position","fixed").css("top",i),c.css("marginBottom",i-o)):(p.css("position","relative").css("top",0),c.css("marginBottom",0))})},a.setupAutofix=function(){function e(){f.css("height",t.height()-i-r-o)}function n(){if(t.width()<l)if(p.hasClass(s)){var e=Math.max(t.width()-l+t.scrollLeft(),-(l-t.width()));e>0&&(e=0),g.css("right",e),g.css("width",520)}else g.css("right",0);else g.css("right",0),g.css("width",t.width()-v.outerWidth()-h.outerWidth())}var i,o,r,s="fixed",l=parseInt($(".page").css("min-width")),c=$(".header"),p=$(".profile"),u=$(".profile .head"),d=$(".profile .tabs"),h=$(".profile .side"),f=$(".profile .side .endpoints-list-container"),m=$(".switch-context"),g=$(".language-selector"),v=$(".documentation-background");t.on("scroll"+a.namespace,function(n){h.is(":visible")||(h=$(".profile .side")),m.is(":visible")||(m=$(".switch-context")),g.is(":visible")||(g=$(".language-selector")),f.is(":visible")||(f=$(".profile .side .endpoints-list-container")),i=c.outerHeight(),o=d.outerHeight(),r=m.outerHeight(),t.scrollTop()>=u.outerHeight()?(p.addClass(s),h.add(g).css("top",0+i+r+o),u.css("marginBottom",i),e()):t.scrollTop()<u.outerHeight()&&(p.removeClass(s),h.add(g).css("top",0+r),u.css("marginBottom",0),e())}).trigger("scroll"),t.on("resize"+a.namespace,function(){n(),e()})},a.setupEvents=function(){var t={owner:$(".api .details .owner").text().trim(),name:$(".api .details .name").text().trim()};new Mashape.ApiTerms(Mashape.Store("api.version").get()),Mashape.invite.init(),e.on("click"+a.namespace,".btn-report-broken-api",function(){var e=$(this),t=Mashape.Store("api").get(),n="/"+t.owner.slugifiedPrimary+"/"+t.slugifiedPrimary;e.addClass("loading"),analytics.track("api_not_responding",{group:"ajax",category:"ajax",api_name:t.name,api_provider:t.owner.name,api_link:n,api_visibility:t.visibility},function(){e.removeClass("loading").text("Reported").attr("disabled",!0),Davis.redirect(n+"/support/new")})}),$(".description").tldrModal({id:"profile-description",name:$(".api .details .name").text().trim()+" Description",length:260,"data-analytics":"profile-description-modal",more:"... Read more"}),Mashape.utils.each(["developers","followers"],function(n){var i=$(".modal-body > ."+n),o=$("#"+n);a.scrollViews[n]=new Mashape.Infinity({namespace:a.namespace,endpoint:"/api/internal/"+t.owner+"/apis/"+t.name+"/"+n,parent:i,currentPage:0,html:!0,prompt:"  "}).data(function(e,t){return e&&"string"==typeof e?void i.append(e):!0}),e.on("click",".modal-body > ."+n+" a.name",function(e){o.modal("hide")})}),Mashape.handleFollowForm({account:!0,action:"follow-account",element:".follow.account",settings:{namespace:".documentation"}}),Mashape.handleFollowForm({api:!0,action:"follow-api",element:".follow.api",settings:{namespace:".documentation"}}),a.data={account:new Mashape.User,api:Mashape.Store("api").get(),version:Mashape.Store("api.version").get(),logo:{form:".upload-logo form",none:".logo-wrapper .upload-icon",image:".logo-wrapper .image-upload",input:'.upload-logo form input[name="logo"]',submit:'.upload-logo form button[type="submit"]'}},$(a.data.logo.input).on("change",function(){if(this.files.length){var e=this.files[0],t=~~(e.size/1024),i=new FileReader,o=new Image,r=$(this),s=function l(e){return r.next(".help-block")[e?"text":"empty"](e).closest(".form-group")[e?"addClass":"removeClass"]("has-error"),$(a.data.logo.submit).attr("disabled",!!e),l}();if(-1===n.types.indexOf(e.type))return s("Wrong logo file type.");if(t<n.minSize)return s("Logo size is too small.");if(t>n.maxSize)return s("Logo size is too large.");i.readAsDataURL(e),i.onload=function(t){o.src=t.target.result,o.onload=function(){return this.width<n.minWidth||this.height<n.minHeight?s("Logo dimensions are too small."):this.width>n.maxWidth||this.height>n.maxHeight?s("Logo dimensions are too large."):void 0;
},o.onerror=function(){s("Invalid file type: "+e.type)}}}}),Mashape.initializeLogoUpload(a.data.logo.form,{namespace:a.namespace,onPatch:function(){return Mashape.api.patch({url:a.data.version.links.self.href,data:{haslogo:!0}})},onSuccess:function(e){a.data.version.haslogo=!0,$(a.elements.logo).attr("src",e.results.medium[0].ssl_url)}})},Mashape.Documentation=a}.call(this),function(){var e=$(document),t=$(window),n=".side-container",a=null,i=Mashape.Section({routing:function(e){this.scope("/:account/:api/overview",function(){this.base(e(),i.init())})},template:"Documentation/overview_template",headlineTemplate:"Documentation/headline",elements:Mashape.Elements({sidebarPageContainer:".side-container",sidebarScrollableArea:".perfectscroll-container",sidebarList:".side-overview",mainList:".overview-list",mainListWrapper:".overview-wrapper",bottomFooter:".bottom-footer",scrollSpy:'[data-spy="scroll"]',faCog:".side-overview .fa.fa-cog",noItems:".no-items",newForm:".new-headline",editHeadlineForm:function(e){return"#form-edit-"+e}}),init:function(e){return e=e||"AllHeadlines",function(e){return Mashape.Documentation.setupEvents(),i.helpers.autofix.call(i),i.data={baseURL:[e.params.account,e.params.api,"overview"].join("/"),request:e,user:Mashape.user,owner:e.params.account,headlines:Mashape.Store("headlines").get(),api:Mashape.Store("api").get(),version:Mashape.Store("api.version").get()},_.each(i.data.headlines,function(e,t){("undefined"==typeof e.index||""===e.index)&&(e.index=t+1)}),Mashape.template(i.template,function(){i.helpers.initAllOverview.call(i,e)})}},teardown:function(t){e.off(".documentation")},ractiveHelpers:{markdown:function(e){return marked(e)}},helpers:{autofix:function(){function e(){var e=this.elements.$bottomFooter.height();this.elements.$sidebarPageContainer.height(t.height()-this.elements.$sidebarPageContainer.offset().top-e)}this.elements.grabElements(),this.elements.$sidebarScrollableArea.perfectScrollbar({wheelSpeed:10}),this.elements.$scrollSpy.scrollspy("refresh"),this.helpers.initPopovers.call(i),e.call(this),t.load(e.bind(this)),t.resize(e.bind(this))},initPopovers:function(){var e=this;this.elements.$faCog.each(function(e,t){var n=$(t).attr("data-index");$(t).popover("destroy"),$(t).popover({html:!0,content:'<div class="popover-box" data-index="'+n+'"><h6 class="edit-popover-title">EDIT ORDER</h6><i class="fa fa-times"></i><select class="select-order"></select></div>',placement:"right",container:"body"})}),this.elements.$faCog.off(),this.elements.$faCog.click(function(t){t.preventDefault(),t.stopPropagation();var n=$(this),o=n.attr("data-index");e.elements.$faCog.not(this).popover("hide"),n.popover("show");var r=$('.popover-box[data-index="'+o+'"]');r.find(".fa.fa-times").click(function(e){n.popover("hide")});var s=r.find("select");_.each(a.get("headlines"),function(e){s.append('<option value="'+e.index+'">'+e.index+"</option>")}),Mashape.selector({element:s,selected:o,width:75,on:{change:function(){var t=a.get("headlines."+(o-1));e.helpers.updateIndexes.call(i,t,this.value)}}})}),this.elements.$sidebarList.scroll(this.helpers.hidePopovers.bind(i))},hidePopovers:function(){this.elements.$faCog.popover("hide")},initAllOverview:function(e){var t=this;window.wikis=a=new Ractive({el:n,template:Mashape.template(i.template),data:{helpers:i.ractiveHelpers,headlines:i.data.headlines,api:i.data.api,_new:!1,_owner:i.data.api.isOwner}}),this.helpers.autofix.call(i),a.on({"new":function(){t.helpers.closeEditForms.call(i),this.toggle("_new"),this.get("_new")?(t.elements.$noItems.hide(),t.helpers.autofix.call(i),t.elements.$mainListWrapper.scrollTo(t.elements.$mainList.prop("scrollHeight")),$(t.elements.newForm).find("input").first().focus(),new Mashape.FormComponent(t.elements.newForm).on("submit",function(e,t){Mashape.api.post({url:i.data.version.links.wikis.href,data:{title:e.serialized.title,text:e.serialized.text,index:i.helpers.maxHeadlinesIndex()+1}}).always(t)}).on("success",function(e){a.push("headlines",e),a.set("_new",!1),t.helpers.autofix.call(i)})):t.elements.$noItems.show()},edit:function(e){function n(){a.splice("headlines",o,1).then(function(){var e=1;async.each(a.get("headlines"),function(t,n){Mashape.api.patch({url:t.links.self.href,data:{index:e}}).done(function(e){a.set(["headlines",e.index-1,"index"].join("."),e.index)}).always(Mashape.utils.asyncAlways(n)),e++},function(e){return e?console.error(e):void t.helpers.autofix.call(i)})})}this.set("_new",!1),t.helpers.closeEditForms.call(i),t.helpers.autofix.call(i);var o=e.index.i;this.set("headlines."+o+".editing",!0),new Mashape.FormComponent(t.elements.editHeadlineForm(o)).on("submit",function(t,i){"delete"===t.original.currentTarget.name?Mashape.api["delete"]({url:e.context.links.self.href}).done(n).always(i):Mashape.api.patch({url:e.context.links.self.href,data:t.serialized}).done(function(t){a.set("headlines."+o+".editing",!1),a.set(e.keypath,t)}).always(i)})},cancel:function(e){t.helpers.autofix.call(i),this.set("headlines."+e.index.i+".editing",!1)}})},closeEditForms:function(){a.set("headlines.*.editing",!1)},maxHeadlinesIndex:function(){var e=_.max(a.get("headlines"),"index");return"undefined"!=typeof e.index?e.index:0},updateIndexes:function(e,t){var n=this,o=a.get("headlines"),r=$.extend(!0,{},o),s=o[t-1];this.helpers.hidePopovers.call(i),o[t-1]=e,o[e.index-1]=s,s.index=e.index,e.index=t,async.each([e,s],function(e,t){Mashape.api.patch({url:e.links.self.href,data:{index:e.index}}).always(Mashape.utils.asyncAlways(t))},function(e){e&&(console.error(e),a.set("headlines",r)),a.set("headlines",o),n.helpers.autofix.call(i)})}}});Mashape.Overview=i}.call(this),function(){Mashape.SubscribeComponents={};var e=function(){this._init.apply(this,arguments)};e.prototype={ractive:null,transport:null,elements:Mashape.Elements({modal:"#subscribe-api",successModal:"#subscribe-api-success",modalBtns:".btn.subscribe",cardForm:{form:"form.new-credit-card"},subscribeForm:{form:"form.subscribe-form",btnSubmit:'form.subscribe-form .btn[type="submit"]'}}),_init:function(e,t){this.data=t,this.data.plan={},this.ractive=new Ractive({el:e.el,template:e.template,data:this.data}),this.elements.grabElements(),this._setupEventHandlers()},_setupEventHandlers:function(){var e=this;_.each(this.eventHandlers,function(t,n){"function"==typeof t&&e.ractive.on(n,t.bind(e))}),this.elements.$modalBtns.click(function(t){t.preventDefault(),t.stopPropagation(),e.ractive.set("plan",$(this).data()),e.ractive.set("action",$(this).data("action")),e.elements.$modal.modal("show")}),this.elements.$modal.on("shown.bs.modal",function(){e.setupBinders(),$(this).find("input").first().focus()})},setupBinders:function(){this.bindNewCardForm(),this.bindSubscribeForm()},bindNewCardForm:function(){var e=this;$(this.elements.cardForm.form).length&&(this.newCreditCardForm=new Mashape.CardForm(this.elements.cardForm.form).on("success",function(t){e.ractive.set("card",t),e.ractive.set("hasCard",!0),e.setupBinders(),$(e.elements.subscribeForm.btnSubmit).click()}))},bindSubscribeForm:function(){var e=this;if($(this.elements.subscribeForm.form).length)var t=new Mashape.FormComponent(this.elements.subscribeForm.form,{handleButtonState:!1}).on("submit",function(t,n){t.button.disable(),e.transport.post("subscribe",{plan:e.ractive.get("plan").name}).always(n)}).on("error",function(n,a,i){400===a.status&&n.account?(e.eventHandlers.changeCard.call(e),e.newCreditCardForm.handleError(n.account)):(i.button.enable(),t.handleErrors(n,a,null))}).on("success",function(t){e.elements.$modal.modal("hide"),e.elements.$successModal.modal({backdrop:"static"},"show");var n=query.build({flashPlan:e.ractive.get("plan").name,flashSubscribe:e.ractive.get("action")===Mashape.CONSTANTS.ACTION_SUBSCRIBE?"true":null});window.location=["",e.ractive.get("api").owner,e.ractive.get("api").slug].join("/")+n})},eventHandlers:{changeCard:function(e){this.ractive.toggle("hasCard"),this.setupBinders()}}},Mashape.SubscribeComponents.UI=e;var t=function(){this._init.apply(this,arguments)};t.prototype={config:{prefix:"/api/internal",backend:"/api/middleware",user:"",api:{}},_init:function(e){this.config.user=e.user?e.user.slug:null,this.config.api=e.api},get:function(e,t){t=t||{};var n=this.config,a={type:"GET",dataType:"json",url:""},i={subscribe_template:function(){a.url="/templates/Modals/subscribe_template",a.dataType="text"},user_billing:function(){a.url=[n.prefix,n.user,"billing"].join("/")}};return"function"==typeof i[e]?i[e]():console.warn("There is no resource of type: "+e.toString()),$.ajax(a)},post:function(e,t){t=t||{};var n=this.config,a={type:"POST",dataType:"json",data:t,xhrFields:{withCredentials:!0},url:[n.prefix,n.api.owner,"apis",n.api.slug].join("/")},i={subscribe:function(){a.url+="/current/subscribe"}};return"function"==typeof i[e]?i[e]():console.warn("There is no resource of type: "+e.toString()),$.ajax(a)},patch:function(e,t){t=t||{};var n=this.config,a={type:"PATCH",dataType:"json",data:t,xhrFields:{withCredentials:!0},url:[n.prefix,n.api.owner,"apis",n.api.slug].join("/")},i={updateSubscribe:function(){a.url+="/current/subscribe"}};return"function"==typeof i[e]?i[e]():console.warn("There is no resource of type: "+e.toString()),$.ajax(a)}},Mashape.SubscribeComponents.Transport=t,Mashape.Subscribe=function(){var e=function(){this._init.apply(this,arguments)};return e.prototype._init=function(e){var t=this;this.events={ready:function(){}},this.options={el:".subscribe-container",template:""},this.options=Mashape.utils.merge(this.options,e),this.transport=new Mashape.SubscribeComponents.Transport(this.options),this.options.user?this.transport.get("subscribe_template").then(function(e){return t.options.template=e,t.transport.get("user_billing")}).always(function(e){t.initUI(404!==e.status?e:null),t.events.ready.call(t)}):this.transport.get("subscribe_template").then(function(e){t.options.template=e,t.initUI(null),t.events.ready.call(t)})},e.prototype.initUI=function(e){this.UI=new Mashape.SubscribeComponents.UI(this.options,{user:this.options.user,api:this.options.api,hasCard:null!==e,card:e}),this.UI.transport=this.transport},e.prototype.on=function(e,t){return this.events[e]=t,this},e.prototype.destroy=function(){"undefined"!=typeof this.UI&&this.UI.ractive&&this.UI.ractive.teardown(),$(window).off(".subscribe-container")},e}()}.call(this),function(){function e(e){return e.closed=e.closed?e.closed:"true"===e.closed,e.editing=!1,e.newComment={id:i.NEW_ID,text:"",editing:!0,account:c.data.user},_.omit(e,["took","status"])}function t(e){var t=Mashape.utils.ajax(e);return s&&(s.set("loading",!0),t.always(function(){s.set("loading",!1)})),t}function n(e){console.error(e),new Mashape.Alert("body",{type:"danger",message:e}).show()}function a(){var e=0;s&&(e=s.get("counters.open.total")),document.title=document.title.replace(/\d+$/,e),r.text(e)}var i={TICKETS_PAGE_SIZE:20,NEW_ID:"__new__",PRIVATE:"PRIVATE",PUBLIC:"PUBLIC",MAX_PAGINATION_BUTTONS:5},o=$(document),r=$(".feeds span:contains(API Support) + span"),s=null,l={arrayCount:"true",sort:"-index",include:"account",closed:"false",size:i.TICKETS_PAGE_SIZE},c=Mashape.Section({routing:function(e){this.scope("/:account/:api/support",function(){this.base(e(),c.init()),this.get("/new",e(),c.init({"new":!0})),this.get("/:ticket",e(),c.init())})},init:function(e){return function(t){Mashape.Documentation.setupEvents(),c.data={user:Mashape.user||{},api:Mashape.Store("api").get(),version:Mashape.Store("api.version").get(),baseURL:["",t.params.account,t.params.api,"support"].join("/")},c.data.user.slugifiedPrimary=c.data.user.slug,async.parallel({template:function(e){Mashape.utils.ajax({method:"GET",url:"/templates/Documentation/support_template",dataType:"text"}).always(Mashape.utils.asyncAlways(e))},data:function(e){async.parallel({tickets:function(e){c.transport.fetchTickets(c.data.version,e)},currentTicket:function(e){return"undefined"==typeof t.params.ticket?e():void c.transport.fetchTicket(t.params.ticket).fail(function(t){return e(t)}).done(function(t){return e(null,t)})}},e)}},function(t,a){return t?n(t):void c.initRactive({results:a,"new":"undefined"!=typeof e?e["new"]:!1})})}},initRactive:function(e){var t=e.results.data.currentTicket;s=new Ractive({el:"div.support",template:e.results.template,data:{CONSTANTS:i,helpers:c.ractiveHelpers,user:c.data.user,api:c.data.api,tickets:e.results.data.tickets.tickets.data,searchResults:[],currentTicket:t,detail:"undefined"!=typeof t,counters:e.results.data.tickets.counters,loading:!1},complete:function(){if(c.paginate(e.results.data.tickets.tickets),c.uiAutofix(),c.setupRactive(),e["new"]){var t=Mashape.utils.query.parse();s.fire("writeTicket",null,{visibility:t.type})}}})},setupRactive:function(){_.each(c.eventHandlers,function(e,t){"object"==typeof e?s.on(t,function(t,n){"function"==typeof e[n]?e[n].apply(s,arguments):console.warn("Event was called, but no handler was found.")}):"function"==typeof e&&s.on(t,e)})},uiAutofix:function(){$('[data-toggle="tooltip"]').tooltip(),o.on("click","#ticket-visibility li a",function(){var e=$(this).data("visibility");s.set("currentTicket.visibility",e)})},paginate:function(e){if(s){var t=l.page||1,n=i.TICKETS_PAGE_SIZE,a=i.MAX_PAGINATION_BUTTONS,o=e.total,r=Math.ceil(o/n),c=t-a>0?t-a:0,p=r>t+a?t+a:r;p=2*a>p&&r>2*a?2*a:p;var u=_.range(c+1,p+1);s.set("currentPage",t),s.set("lastPage",r),s.set("pages",u)}},eventHandlers:{toggle:{editing:function(e){var t=[e.keypath,"editing"].join("."),n=[e.keypath,"original"].join(".");s.get(t)?s.set(e.keypath,s.get(n)):(s.set(n,_.clone(e.context,!0)),s.toggle(t))},followTicket:function(e){if("undefined"==typeof c.data.user.id)return Mashape.utils.registerPrompt();var t=e.context.isFollowing?c.transport.unfollowTicket(e.keypath):c.transport.followTicket(e.keypath);$(e.node).addClass("loading"),t.always(function(){$(e.node).removeClass("loading")})}},fetchTickets:function(e,t){e.original.preventDefault(),c.transport.fetchTickets(c.data.version,t,function(e,a){return e?n(e):(s.set("tickets",a.tickets.data),void("undefined"!=typeof t.closed&&s.set("tab","true"===t.closed)))})},searchTickets:function(e){e.original.preventDefault(),e.original.stopPropagation(),c.transport.searchTickets(s.get("query")).fail(n).done(function(e){s.set("searchResults",e)})},clearSearch:function(){s.set("searchResults",[]),s.set("query","")},openTicket:function(e){var t=e.context;s.set("detail",!0),window.history.pushState({ticket:t.index},c.data.api.name+" API Support - Ticket "+t.index,[c.data.baseURL,t.index].join("/")),c.transport.fetchTicket(t).fail(function(e){return done(e)}).done(function(e){s.set("currentTicket",e),c.uiAutofix()})},closeCurrentTicket:function(){var e=s.get("currentTicket"),t=_.findIndex(s.get("tickets"),{id:e.id});-1!==t&&s.set(["tickets",t].join("."),e),s.set("detail",!1),s.set("currentTicket",void 0),window.history.pushState({ticket:"all"},c.data.api.name+" API Support",c.data.baseURL)},writeTicket:function(e,t){return"undefined"==typeof c.data.user.id?Mashape.utils.registerPrompt():(s.set("detail",!0),s.set("currentTicket",{account:c.data.user,visibility:t&&t.visibility&&t.visibility.toUpperCase()===i.PRIVATE?i.PRIVATE:i.PUBLIC,id:i.NEW_ID}),c.uiAutofix(),$(".ticket-form").find("input").first().focus(),void("undefined"!=typeof e&&window.history.pushState({ticket:"new"},c.data.api.name+" API Support - New Ticket",[c.data.baseURL,"new"].join("/"))))},postTicket:function(){new Mashape.FormComponent(".new-ticket",{handleButtonState:!1}).on("submit",function(e,t){e.button.disable(),c.transport.postTicket("currentTicket").always(t)}).on("always",function(e){e.button.enable()}).on("error",function(e,t){this.handleErrors(e,t)}).on("success",function(e){s.fire("openTicket",{context:e})})},postCommentAndOrUpdateTicketState:function(){new Mashape.FormComponent(".comment-form",{handleButtonState:!1}).on("submit",function(e){var t=this;e.button.disable(e.original.currentTarget.name);var n="regular"===e.original.currentTarget.name?"commentTicket":"commentAndUpdateTicketState";c.transport[n]("currentTicket",e.serialized.text,function(n,a){return e.button.enable(),n?t.handleErrors(a.getResponse(),a):void $(".comment-form").find('button[name="regular"]').prop("disabled",!0)})})},updateTicket:function(t){var n=t.context;new Mashape.FormComponent(".new-ticket",{handleButtonState:!1}).on("submit",function(e,a){e.button.disable(),c.transport.updateEntity(t.keypath,{title:n.title,text:n.text,visibility:n.visibility}).always(a)}).on("always",function(e){e.button.enable()}).on("error",function(e,t){this.handleErrors(e,t)}).on("success",function(a){s.set(t.keypath,e($.extend(!0,n,a)))})},updateComment:function(e){var t=e.context;new Mashape.FormComponent(".comment-form",{handleButtonState:!1}).on("submit",function(t,n){t.button.disable(),c.transport.updateEntity(e.keypath,t.serialized).always(n)}).on("always",function(e){e.button.enable()}).on("error",function(e,t){this.handleErrors(e,t)}).on("success",function(n){t=$.extend(!0,t,n),t.editing=!1,s.set(e.keypath,t)})},deleteTicket:function(e){Mashape.prompt("Delete this ticket?",function(t){t&&c.transport.deleteEntity(e.keypath).fail(n).done(function(e){var t=_.findIndex(s.get("tickets"),{id:e.id});-1!==t&&(s.get("tickets").splice(t,1),s.subtract("counters.open.total"),a()),s.fire("closeCurrentTicket")})})},deleteComment:function(e){Mashape.prompt("Delete this comment?",function(t){t&&c.transport.deleteEntity(e.keypath).fail(n).done(function(e){var t=_.findIndex(s.get("currentTicket.merged"),{id:e.id});-1!==t&&s.get("currentTicket.merged").splice(t,1)})})}},ractiveHelpers:{capitalize:function(e){return _.capitalize(e.toLowerCase())},relative:function(e){return moment(e).fromNow()},markdown:function(e,t){return!t||e&&""!==e?marked(e):"<p>Nothing to preview</p>"}},transport:{updateCounters:function(e){async.parallel({open:function(e){Mashape.api.get({url:c.data.version.links.issues.href,data:{size:1,closed:"false"}}).done(function(e){s&&(s.set("counters.open.total",e.total),a())}).always(Mashape.utils.asyncAlways(e))},closed:function(e){Mashape.api.get({url:c.data.version.links.issues.href,data:{size:1,closed:!0}}).done(function(e){s&&s.set("counters.closed.total",e.total)}).always(Mashape.utils.asyncAlways(e))}},e)},fetchTickets:function(n,a,i){"function"==typeof a&&(i=a,a={}),async.parallel({tickets:function(i){l=$.extend(l,a),t({method:"GET",url:n.links.issues.href,data:l}).done(c.paginate).done(function(t){_.each(t.data,e)}).always(Mashape.utils.asyncAlways(i))},counters:c.transport.updateCounters},i)},fetchTicket:function(t){var n="undefined"!=typeof t.links?t.links.self.href:c.data.version.links.issues.href+t,a={},i=$.Deferred();return i.promise(a),s&&s.set("loading",!0),async.waterfall([function(t){Mashape.api.get({url:n,data:{arrayCount:"true",include:["account","comments","states","comments.account","states.account"]}}).fail(function(e){return t(e)}).done(function(n){var a=n.comments.data.concat(n.states.data);return n.merged=_.sortBy(a,"creationDate"),n=e(n),t(null,n)})},function(e,t){return"undefined"==typeof c.data.user.id?t(null,e):void Mashape.api.get({url:e.links.followers.href,data:{follower:c.data.user.id}}).fail(function(e){return t(e)}).done(function(n){return e.follower=n.data.length?n.data[0]:void 0,e.isFollowing="undefined"!=typeof e.follower,t(null,e)})}],function(e,t){return s&&s.set("loading",!1),e?i.reject(e):void i.resolve(t)}),a},searchTickets:function(t){return s.set("loading",!0),Mashape.client.searchIssues(c.data.version.id,t).always(function(){s.set("loading",!1)}).done(function(t){_.each(t,e)})},postTicket:function(e){var t=s.get(e);return Mashape.api.post({url:c.data.version.links.issues.href,data:{title:t.title,text:t.text,visibility:t.visibility}}).done(function(e){e.account=c.data.user,e.links.comments.total=0,s.unshift("tickets",e),s.add("counters.open.total"),a()})},commentTicket:function(e,t,n){var a=s.get(e);Mashape.api.post({url:a.links.comments.href,data:{text:t}}).done(function(t){t.account=c.data.user,s.push([e,"merged"].join("."),t),s.add([e,"links.comments.total"].join(".")),s.set([e,"newComment.text"].join("."),"")}).always(Mashape.utils.asyncAlways(n))},updateTicketState:function(e,t,n){var i=s.get(e);arguments.length<3&&(n=t,t="undefined"!=typeof i.closed?!i.closed:!0),async.series({state:function(e){Mashape.api.post({url:i.links.states.href,data:{closed:t}}).always(Mashape.utils.asyncAlways(e))},ticket:function(e){Mashape.api.patch({url:i.links.self.href,data:{closed:t}}).always(Mashape.utils.asyncAlways(e))}},function(t,i){if(t)return n(t);var o=i.ticket,r=_.findIndex(s.get("tickets"),{id:o.id});return i.state.account=c.data.user,s.set([e,"closed"].join("."),i.ticket.closed),s.push([e,"merged"].join("."),i.state),s[o.closed?"subtract":"add"]("counters.open.total"),s[o.closed?"add":"subtract"]("counters.closed.total"),-1!==r&&s.splice("tickets",r,1),a(),n(null,i.state)})},commentAndUpdateTicketState:function(e,t,n){async.series({comment:function(n){return"undefined"==typeof t||""===t?n():void c.transport.commentTicket(e,t,n)},state:function(t){c.transport.updateTicketState(e,t)}},n)},followTicket:function(e){var t=s.get(e);return Mashape.api.post({url:t.links.followers.href,data:{follower:c.data.user.id}}).done(function(n){t.isFollowing=!0,t.follower=n,s.set(e,t)})},unfollowTicket:function(e){var t=s.get(e);return Mashape.api["delete"]({url:t.follower.links.self.href}).done(function(){t.isFollowing=!1,t.follower={},s.set(e,t)})},updateEntity:function(e,t){var n=s.get(e);return Mashape.api.patch({url:n.links.self.href,data:t})},deleteEntity:function(e){var t=s.get(e);return Mashape.api["delete"]({url:t.links.self.href})}}})}.call(this),function(){var e=$(document),t=$(window),n=Mashape.Section({namespace:".explore",baseurl:"/explore",url:"/api/internal/explore",defaultSort:"developers",storage:Mashape.Store("explore",{cache:"forever"}),routing:function(e){this.scope("/explore",function(){this.base(e({el:"body > .page"}),Mashape.Explore.init)})},init:function(t){n.noMoreResults=$(".no-more-results").html(),n.active=!0,n.search.params=query.parse({rebuild:!0})||{},n.search.previous=$.extend({},n.search.params),n.search.$input=$(".header.navbar .search input"),e.on("click"+n.namespace,".header.navbar a.active",function(e){e.preventDefault(),e.stopPropagation(),e.ctrlKey||e.metaKey?window.open(n.baseurl,"_blank"):window.location=n.baseurl}),n.setupGrid(),n.search.markTags(),n.display(),n.filters(),n.infiniteScroll(),n.load(),Mashape.handleFollowForm({api:!0,action:"follow-api",element:".follow.api",settings:{namespace:".explore"}})},teardown:function(){n.active=!1,e.off(n.namespace),e.off("scroll"),$(".header .nav .active").removeClass("active"),n.packery&&n.packery.teardown(),n.headroom&&n.headroom.destroy(),n.scrollView&&(n.scrollView.teardown(),n.scrollView=null)},search:{$input:null,params:{},previous:{},setTag:function(e){n.search.params.tags=e,n.search.$input.val("#"+e),n.search.markTags(),n.search.execute()},markTags:function(){var e=$("[data-category]"),t=n.search.params.tags;e.removeClass("active"),Mashape.utils.isArray(t)?Mashape.utils.each(t,function(t){e.filter('[data-category="'+t+'"]').addClass("active")}):"string"==typeof t&&e.filter('[data-category="'+t+'"]').addClass("active")},execute:function(){function e(){var e;e=$(".explore .apis"),e.find(".inner-grid").css("height",0),e.find(".inner-grid, .list-api-table").empty(),n.scrollView.reset(t.build())}var t=this;return n.scrollView?e():void(n._afterLoad=function(){e()})},build:function(){var e;return n.search.params=Mashape.utils.pick(n.search.params,function(e){return e}),e=$.extend({},n.search.params),n.search.previous=$.extend({},n.search.params),n.replaceQuery(n.search.params),delete e.page,query.build(e)}},replaceQuery:function(e){e=$.extend(n.search.params,e),window.history.replaceState({},{},window.location.href.split("?")[0]+query.build(e))},load:function(){Mashape.utils.getApisFollowed()},display:function(){var e=$(".blocks"),a="undefined"!=typeof n.search.params.query?"list":"grid";Mashape.selector.horizontal({selectors:".selectors .display a",selected:n.storage.get()||a,namespace:".explore",initialSelect:!1},function(a){n.display.view=a,"list"===a?(e.removeClass("grid").addClass("list"),t.trigger("scroll")):"grid"===a&&(e.removeClass("list").addClass("grid"),t.trigger("resize")),n.storage.set(a),n.scrollSpy.getOffsets()})},scrollSpy:{watch:function(){n.scrollSpy.getOffsets();var a,i;e.off(".mashape-scrollspy"),e.on("scroll.explore.mashape-scrollspy",Mashape.utils.bufferInput(function(){i=t.scrollTop()+60,Mashape.utils.each(n.scrollSpy.offsets,function(e,t){return"1"===t&&i<=e.bottom&&i<=e.top?a=t:void(i>=e.top&&i<=e.bottom&&(a=t))}),a!==n.currentPage&&(n.replaceQuery({page:a}),n.currentPage=a)}))},getOffsets:function(){var e="list"===n.display.view?"tbody":"div",t=$(e+"[data-scrollspy-page]"),a={};t.each(function(){var e=$(this).children();e.first().offset()&&(a[$(this).data("scrollspy-page")]={top:e.first().offset().top,bottom:e.last().offset().top})}),n.scrollSpy.offsets=a}},setupGrid:function(){n.packery=new Mashape.Packery({container:".explore .apis .inner-grid",item:".api-card",gutter:30,columnWidth:320,resize:!0}),setTimeout(function(){n.packery.pack(n.scrollSpy.watch)},100)},filters:function(){var t=$(".page-content"),a=$(Mashape.CONSTANTS.SIDEBAR_ID),i=n.search.$input.val();e.on("click.explore",".selectors .toggle-filters a",function(){var e="HIDE FILTERS",i="thin";t.attr("data-sidebar-left")&&(e="SHOW FILTERS",i=null),$(this).children("span.text").text(e),t.attr("data-sidebar-left",i),a.toggleClass("hidden"),n.packery.pack(),i=e=null}),e.on("click.explore","a[data-category]",function(){n.search.setTag($(this).data("category"))}),Mashape.selector({element:".selectors .price-range select",selected:n.search.params.price||"none",showTick:!0,width:120,on:{change:function(){n.search.previous.price!==this.value&&("none"===this.value&&(this.value=null),n.search.params.price=this.value,n.search.execute())}}}),Mashape.selector({element:".selectors .sorting select",selected:n.search.params.sort||(i&&i.length?"":"developers"),showTick:!0,width:120,on:{change:function(){if(n.search.previous.sort!==this.value){if(!Mashape.user&&"private"===this.value)return $(this).selectpicker("val","").selectpicker("render"),Mashape.utils.registerPrompt();"none"===this.value?delete n.search.params.sort:n.search.params.sort=this.value,n.search.execute()}}}})},withNewResults:function(e){if(n.active&&e&&"string"==typeof e){if(e=$(e),!$(e).find("[data-scrollspy-page]").length)return n.packery.pack(n.afterPacking),!0;$(".explore .apis").find("table").append(e.find("table tbody")),n.packery.pack(e.find("div[data-scrollspy-page]"),function(){n.scrollSpy.getOffsets(),n.afterPacking()})}},afterPacking:function(){n.load(),setTimeout(function(){t.scroll()},400)},infiniteScroll:function(){var e=Mashape.utils.query.parse().page||1;n.scrollView=new Mashape.Infinity({endpoint:n.url+n.search.build(),parent:$(".explore .apis"),windowScroll:!0,currentPage:e,html:!0,prompt:n.noMoreResults}).data(n.withNewResults),t.scroll(),"function"==typeof n._afterLoad&&(n._afterLoad(),n._afterLoad=null)}});Mashape.Explore=n,e.on("submit"+n.namespace,".search form",function(e){e.stopImmediatePropagation(),e.preventDefault()}),e.ready(function(){new Mashape.SearchInput({input:".header.navbar .search input",onEnter:!0},Mashape.utils.bufferInput(function(e){var t;if(analytics.track("Search marketplace",{group:"ajax",category:"ajax",authenticate:Mashape.user?!0:!1,query:t,page:"explore",source:location.pathname}),n.active)n.search.params.tags=e.tags&&e.tags.length?e.tags:null,e.query?n.search.params.query=e.query:delete n.search.params.query,n.search.execute();else{if(!e||e.query.length<1)window.location="/explore";else if(e&&e.query.length<3&&(!e.tags||!e.tags.length))return;t=$(".header.navbar .search input").val(),e=Mashape.utils.pick(e,function(e){return e}),window.location="/explore"+query.build(e)}},500))})}.call(this),function(){$(document).ready(function(){function e(e){var t=e.find(".perfectscroll-container");t.perfectScrollbar({wheelSpeed:10,suppressScrollX:!0})}function t(){function t(e){if(e&&e.length){var t=Mashape.utils.after(e.length,function(){r.text(e.length)});return Mashape.utils.each(e,function(e){var n=Mashape.utils.escapeHTML(e.name),a=$('<li class="app" data-name="'+n+'" data-id="'+e.id+'"><a href="'+Mashape.Cards.Application.link(e)+'">'+n+"</a></li>");o.append(a),t()})}r.text(0)}var n=".apps.dropdown",i=$(n),o=i.find(".list").empty(),r=i.find(".badge");e(i),Mashape.client.fetchApplications(a.name).done(function(e,n,a){return t(e.data)}),$(n).on("shown.bs.dropdown",function(){$(this).find("input.filter").focus()}),Mashape.Filters({filterables:n+" .app",searchInput:n+" input.filter"})}function n(){function t(e){if(e&&e.length){var t=Mashape.utils.after(e.length,function(){r.text(e.length)});return Mashape.utils.each(e,function(e){var n=e.visibility===Mashape.CONSTANTS.STATE_PUBLISHED?"fa-unlock":"fa-lock",a=Mashape.utils.escapeHTML(e.name),i=$('<li class="api" data-name="'+a+'"><a href="'+Mashape.Cards.Api.link(e,!0)+'"><i class="fa '+n+'"></i>'+a+'</a><a href="'+Mashape.Cards.Api.link(e,!0)+'/admin" title="Admin"><i class="fa fa-cog"></i></a></li>');o.append(i),t()})}r.text(0)}var n=".apis.dropdown",i=$(n),o=i.find(".list").empty(),r=i.find(".badge");e(i),Mashape.client.fetchApis(a.name).done(function(e,n,a){return t(e.data)}),$(n).on("shown.bs.dropdown",function(){$(this).find("input.filter").focus()}),Mashape.Filters({filterables:n+" .api",searchInput:n+" input.filter"})}var a=new Mashape.User;$("#account-register, #account-login").on("shown.bs.modal",function(e){$(this).find('input[name="name"]').focus()}),Mashape.flash&&new Mashape.Alert("body",{type:Mashape.flash.type,message:Mashape.flash.message}).show(),a.name&&(n(),t()),Mashape.utils.setupHeaderAppsDropdown=t,Mashape.utils.setupHeaderApisDropdown=n})}.call(this),function(){$(function(){query.parse({rebuild:!0,name:"intro"})&&$("#intro-modal").modal("show").on("hide.bs.modal")})}.call(this),function(){var e=Mashape.Section({routing:function(t){var n;this.scope("/",function(){for(var t in Mashape.CONSTANTS.STATIC_ROUTES)n=Mashape.CONSTANTS.STATIC_ROUTES[t],this.get(n,e.init(n))})},init:function(e){return function(t){t.isForPageLoad||("logout"===e&&(analytics.track("Logout",{group:"ajax",action:"logout",category:"ajax"}),Mashape.Store("apis").clear(),Mashape.Store("apps").clear()),window.location="/"+e)}}})}.call(this),function(){function e(e,t){return this.classes={icon:{success:"fa-check",error:"fa-cross"},loading:"loading",error:"error",success:"success"},this.element=$(e),this.bubble=this.element.find(".bubble"),this.message=this.element.find(".message .text"),this.messageIcon=this.element.find(".message .result-icon"),t?(this.originalMessage=t,this.setMessage(t)):this}e.prototype.setMessage=function(e){return this.message.html(e||""),this},e.prototype.loading=function(e){return this.clear(),e&&this.setMessage(e),this.bubble.addClass(this.classes.loading),this},e.prototype.error=function(e){return this.clear(),e&&this.setMessage(e),this.element.addClass(this.classes.error),this.messageIcon.show().addClass(this.classes.icon.error),this},e.prototype.success=function(e){return this.clear(),e&&this.setMessage(e),this.element.addClass(this.classes.success),this.messageIcon.show().addClass(this.classes.icon.success),this},e.prototype.clear=function(e){return this.originalMessage&&this.setMessage(this.originalMessage),this.element.removeClass(this.classes.error).removeClass(this.classes.success),this.bubble.removeClass(this.classes.loading),this.messageIcon.hide().removeClass(this.classes.icon.error).removeClass(this.classes.icon.success),this},Mashape.NetworkStep=e}.call(this),function(){var e='<div class="account-row"><div></div><div class="pull-left"><strong>Please enter a username</strong></div></div>',t='<div class="account-row"><div></div><div class="pull-left">No results found for <strong></strong></div></div>',n=$("#invite"),a=".scrollbox.invite",i=".search-btn",o=!1,r=function(){
$(document).on("click.documentation-admin","button.btn.invite",l.doInvite),$(document).on("click.documentation-admin",".account-row a.name",l.gotoProfile),o=!0},s=function(e){var n;n=$(t),n.find("strong").text(e),a=$(document).find(a),a.html('<div class="account-row"><div class="pull-left"><div></div></div></div>'),a.find(".pull-left div").addClass("span loader-icon fa fa-spinner fa-spin"),$.ajax({method:"GET",url:"/api/internal/invite/"+e}).done(function(e){a.removeClass("span loader-icon fa fa-spinner fa-spin"),0===e.total?a.html(n):(a.html(e),o||r())}).fail(function(){a.find(".pull-left div").removeClass("span loader-icon fa fa-spinner fa-spin"),$(".scrollbox.invite").html(n)})},l={init:function(){$(document).on("click.documentation-admin",i,function(){var t;n=$("#invite"),t=n.find("input.search").val(),t&&""!==t.trim()?s(n.find("input.search").val()):($(".scrollbox.invite").html(e),$(".invite-search-box input").focus())}),$(document).on("keypress.documentation-admin","input.search",function(e){e=e||event;var t=e.keyCode?e.keyCode:e.charCode,n=$(e.target||e.srcElement);13===t&&s(n.val())})},doInvite:function(e){var t='<span class="fa fa-plus"></span>&nbsp;invite',a='<span class="btn-text">Loading</span><span class="loader-icon fa fa-spinner fa-spin"></span>',i='<span class="fa fa-check"></span>&nbsp;user invited',o=$(e.currentTarget),r=n.find(".error").empty();if(o.attr("disabled"))return!0;var s=o.attr("data-user-id"),l=new Mashape.User;o.html(a).addClass("loading"),$.ajax({method:"POST",url:"/api/middleware/accounts/"+l.name+"/apis/"+Mashape.Store["api.version"].data.api.name+"/developers/",data:{developer:s,pendinginvitation:!0}}).done(function(){analytics.track("Invite api devs",{group:"ajax",category:"ajax",action:"POST",page:location.pathname,authenticate:!0}),o.html(i).removeClass("loading").removeClass("btn-primary").addClass("btn-default").attr("disabled","disabled")}).fail(function(e){o.removeClass("loading");var n=e.getResponse();409===e.status?o.html("User already invited").removeClass("btn-primary").addClass("btn-default").attr("disabled","disabled"):(400===e.status&&_.isObject(n)&&r.html(n.message),o.html(t).attr("disabled",!1))})},gotoProfile:function(){$("#invite").modal("hide")},doUninvite:function(){}};window.Mashape.invite=window.Mashape.invite||l}.call(this),Mashape.Router.System=new Davis(Mashape.Router.System),$(document).ready(function(){Mashape.Router.System.start()});
//# sourceMappingURL=../maps/mashape.min.js-c180e640.map
Error saving setting with name: consoleHistory, value length: 5595496. Error: Failed to set the 'consoleHistory' property on 'Storage': Setting the value of 'consoleHistory' exceeded the quota.
Ten largest settings: 
Setting: 'consoleHistory', size: 5213214
Setting: 'previouslyViewedFiles', size: 4289
Setting: 'savedURLs', size: 449
Setting: 'breakpoints', size: 227
Setting: 'domBreakpoints', size: 2
Setting: 'eventListenerBreakpoints', size: 2
Setting: 'experiments', size: 2
Setting: 'fileSystemMapping', size: 2
Setting: 'workspaceExcludedFolders', size: 2
Uncaught TypeError: Cannot read property 'exports' of undefined()

-
https://d1g84eaw0qjo7s.cloudfront.net/scripts/mashape.min-203b0763.js
